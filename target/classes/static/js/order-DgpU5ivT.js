var $=Object.defineProperty,U=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var O=(s,t,e)=>t in s?$(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,h=(s,t)=>{for(var e in t||(t={}))Y.call(t,e)&&O(s,e,t[e]);if(E)for(var e of E(t))X.call(t,e)&&O(s,e,t[e]);return s},g=(s,t)=>U(s,V(t));var T=(s,t,e)=>O(s,typeof t!="symbol"?t+"":t,e);var c=(s,t,e)=>new Promise((a,r)=>{var n=d=>{try{u(e.next(d))}catch(o){r(o)}},i=d=>{try{u(e.throw(d))}catch(o){r(o)}},u=d=>d.done?a(d.value):Promise.resolve(d.value).then(n,i);u((e=e.apply(s,t)).next())});const A=[{id:"1",serialNumber:"YX-EDU-001001",model:"YX-EDU-2024",type:"purchased",status:"active",activatedAt:"2024-01-15T08:00:00Z",lastOnlineAt:"2024-02-20T14:30:00Z",firmwareVersion:"2.1.0",healthScore:95,usageStats:{totalUsageHours:156,dailyAverageUsage:2.5,lastUsedAt:"2024-02-20T14:30:00Z",coursesCompleted:12,charactersWritten:2580,learningProgress:78},purchaseDate:"2024-01-10T00:00:00Z",warrantyEndDate:"2027-01-10T00:00:00Z"},{id:"2",serialNumber:"YX-EDU-001002",model:"YX-EDU-2024",type:"rental",status:"active",activatedAt:"2024-02-01T10:00:00Z",lastOnlineAt:"2024-02-20T16:45:00Z",firmwareVersion:"2.1.0",healthScore:88,usageStats:{totalUsageHours:45,dailyAverageUsage:2.2,lastUsedAt:"2024-02-20T16:45:00Z",coursesCompleted:3,charactersWritten:680,learningProgress:25},rentalStartDate:"2024-02-01T00:00:00Z",rentalEndDate:"2024-05-01T00:00:00Z"}],D=[{id:"1",orderNumber:"ORD-2024-001001",type:"purchase",status:"completed",totalAmount:2999,currency:"CNY",items:[{id:"1",productId:"1",productName:"教育版练字机器人",productModel:"YX-EDU-2024",quantity:1,unitPrice:2999,totalPrice:2999}],createdAt:"2024-01-10T08:00:00Z",updatedAt:"2024-01-15T10:00:00Z"},{id:"2",orderNumber:"ORD-2024-001002",type:"rental",status:"active",totalAmount:299,currency:"CNY",items:[{id:"2",productId:"1",productName:"教育版练字机器人",productModel:"YX-EDU-2024",quantity:1,unitPrice:299,totalPrice:299}],createdAt:"2024-02-01T08:00:00Z",updatedAt:"2024-02-01T10:00:00Z"}],z=[{id:"1",type:"consultation",title:"使用咨询",description:"客户咨询设备使用方法和课程设置",status:"completed",priority:"medium",assignedTo:"客服小王",createdAt:"2024-01-20T09:00:00Z",updatedAt:"2024-01-20T10:30:00Z",resolvedAt:"2024-01-20T10:30:00Z"},{id:"2",type:"maintenance",title:"设备维护",description:"定期维护检查，更新固件版本",status:"completed",priority:"low",assignedTo:"技术小李",createdAt:"2024-02-10T14:00:00Z",updatedAt:"2024-02-10T16:00:00Z",resolvedAt:"2024-02-10T16:00:00Z"}],F=[{id:"1",name:"张明华",email:"zhang.minghua@example.com",phone:"138****8888",address:{country:"中国",province:"北京市",city:"北京市",district:"朝阳区",detail:"建国路88号",zipCode:"100020"},level:"vip",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",devices:A,orders:D,serviceRecords:z,registeredAt:"2024-01-10T08:00:00Z",lastActiveAt:"2024-02-20T16:45:00Z",totalSpent:3298,deviceCount:{purchased:1,rental:1,total:2},customerValue:8.5,tags:["教育机构","长期客户","推荐客户"],notes:"北京某小学校长，对产品很满意，有推荐其他学校的潜力"},{id:"2",name:"李晓红",email:"li.xiaohong@example.com",phone:"139****6666",address:{country:"中国",province:"上海市",city:"上海市",district:"浦东新区",detail:"世纪大道1000号",zipCode:"200120"},level:"premium",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100&h=100&fit=crop&crop=face",devices:[g(h({},A[0]),{id:"3",serialNumber:"YX-EDU-002001",type:"purchased",purchaseDate:"2024-01-20T00:00:00Z"}),g(h({},A[0]),{id:"4",serialNumber:"YX-EDU-002002",type:"purchased",purchaseDate:"2024-01-20T00:00:00Z"}),g(h({},A[0]),{id:"5",serialNumber:"YX-EDU-002003",type:"purchased",purchaseDate:"2024-01-20T00:00:00Z"})],orders:[g(h({},D[0]),{id:"3",orderNumber:"ORD-2024-002001",totalAmount:8997,items:[g(h({},D[0].items[0]),{quantity:3,totalPrice:8997})]})],serviceRecords:[],registeredAt:"2024-01-20T08:00:00Z",lastActiveAt:"2024-02-19T20:15:00Z",totalSpent:8997,deviceCount:{purchased:3,rental:0,total:3},customerValue:9.2,tags:["培训机构","批量采购","VIP客户"],notes:"上海知名书法培训机构负责人，批量采购，服务要求较高"},{id:"3",name:"王建国",email:"wang.jianguo@example.com",phone:"137****5555",address:{country:"中国",province:"广东省",city:"深圳市",district:"南山区",detail:"科技园南路15号",zipCode:"518000"},level:"regular",devices:[g(h({},A[1]),{id:"6",serialNumber:"YX-HOME-003001",model:"YX-HOME-2024",type:"purchased"})],orders:[g(h({},D[0]),{id:"4",orderNumber:"ORD-2024-003001",totalAmount:1999,items:[g(h({},D[0].items[0]),{productName:"家庭版练字机器人",productModel:"YX-HOME-2024",unitPrice:1999,totalPrice:1999})]})],serviceRecords:[],registeredAt:"2024-02-05T10:00:00Z",lastActiveAt:"2024-02-18T19:30:00Z",totalSpent:1999,deviceCount:{purchased:1,rental:0,total:1},customerValue:6.8,tags:["家庭用户","新客户"],notes:"家庭用户，为孩子购买练字设备"}],H={total:156,regular:98,vip:42,premium:16,activeDevices:234,totalRevenue:486750,newThisMonth:23},w=(s=500)=>new Promise(t=>setTimeout(t,s)),p=(s,t=200,e="success")=>({code:t,message:e,data:s,timestamp:Date.now()});class v{static generateMoreCustomers(){const t=[],e=["陈志强","刘美丽","赵建华","孙小明","周雅琴","吴大伟","郑小红","马建国","朱丽娜","胡志明"],a=["北京市","上海市","广东省","浙江省","江苏省","山东省","河南省","湖北省","四川省","福建省"],r=["regular","vip","premium"],n=[["家庭用户","新客户"],["教育机构","长期客户"],["培训机构","VIP客户"],["个人用户","推荐客户"],["企业客户","批量采购"],["学校客户","教育优惠"],["社区中心","公益合作"]];for(let i=4;i<=50;i++){const u=r[Math.floor(Math.random()*r.length)],d=a[Math.floor(Math.random()*a.length)],o=Math.floor(Math.random()*5),m=Math.floor(Math.random()*3),y=o*2999+m*299*3,S=n[Math.floor(Math.random()*n.length)];t.push({id:i.toString(),name:e[Math.floor(Math.random()*e.length)],email:`customer${i}@example.com`,phone:`138****${String(Math.floor(Math.random()*1e4)).padStart(4,"0")}`,address:{country:"中国",province:d,city:d,district:"市中心区",detail:`街道${i}号`,zipCode:`${1e5+i}`},level:u,avatar:`https://images.unsplash.com/photo-${1472099645785+i}?w=100&h=100&fit=crop&crop=face`,devices:[],orders:[],serviceRecords:[],registeredAt:new Date(Date.now()-Math.random()*365*24*60*60*1e3).toISOString(),lastActiveAt:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),totalSpent:y,deviceCount:{purchased:o,rental:m,total:o+m},customerValue:Math.random()*10,tags:S,notes:`客户${i}的备注信息`})}return[...F,...t]}static applyFilters(t,e){let a=[...t];if(e.keyword){const r=e.keyword.toLowerCase();a=a.filter(n=>n.name.toLowerCase().includes(r)||n.email.toLowerCase().includes(r)||n.phone.includes(r)||n.address.province.includes(r)||n.tags.some(i=>i.includes(r)))}return e.level&&(a=a.filter(r=>r.level===e.level)),e.deviceType&&(e.deviceType==="purchased"?a=a.filter(r=>r.deviceCount.purchased>0&&r.deviceCount.rental===0):e.deviceType==="rental"?a=a.filter(r=>r.deviceCount.rental>0&&r.deviceCount.purchased===0):e.deviceType==="mixed"&&(a=a.filter(r=>r.deviceCount.purchased>0&&r.deviceCount.rental>0))),e.region&&(a=a.filter(r=>r.address.province===e.region)),a}static applySorting(t,e,a="desc"){return e?t.sort((r,n)=>{let i,u;switch(e){case"name":i=r.name,u=n.name;break;case"totalSpent":i=r.totalSpent,u=n.totalSpent;break;case"deviceCount":i=r.deviceCount.total,u=n.deviceCount.total;break;case"customerValue":i=r.customerValue,u=n.customerValue;break;case"registeredAt":i=new Date(r.registeredAt).getTime(),u=new Date(n.registeredAt).getTime();break;default:return 0}return a==="asc"?i>u?1:-1:i<u?1:-1}):t}}const B={getCustomers(){return c(this,arguments,function*(s={}){yield w();const t=v.generateMoreCustomers();let e=v.applyFilters(t,s);e=v.applySorting(e,s.sortBy,s.sortOrder);const a=s.page||1,r=s.pageSize||10,n=e.length,i=(a-1)*r,u=i+r,d=e.slice(i,u);return p({list:d,total:n,page:a,pageSize:r,totalPages:Math.ceil(n/r)})})},getCustomerById(s){return c(this,null,function*(){yield w();const e=v.generateMoreCustomers().find(a=>a.id===s);return e?p(e):p(null,404,"客户不存在")})},getCustomerDevices(s){return c(this,null,function*(){yield w();const e=v.generateMoreCustomers().find(a=>a.id===s);return e?p(e.devices||[]):p([],404,"客户不存在")})},getCustomerOrders(s){return c(this,null,function*(){yield w();const e=v.generateMoreCustomers().find(a=>a.id===s);return e?p(e.orders||[]):p([],404,"客户不存在")})},getCustomerServiceRecords(s){return c(this,null,function*(){yield w();const e=v.generateMoreCustomers().find(a=>a.id===s);return e?p(e.serviceRecords||[]):p([],404,"客户不存在")})},getCustomerStats(){return c(this,null,function*(){return yield w(),p(H)})},createCustomer(s){return c(this,null,function*(){yield w();const t=g(h({id:Date.now().toString()},s),{devices:[],orders:[],serviceRecords:[],registeredAt:new Date().toISOString(),lastActiveAt:new Date().toISOString(),totalSpent:0,deviceCount:{purchased:0,rental:0,total:0},customerValue:0,tags:s.tags||[],level:s.level||"regular"});return p(t)})},updateCustomer(s,t){return c(this,null,function*(){return yield w(),p(h({id:s},t))})},deleteCustomer(s){return c(this,null,function*(){return yield w(),p(null)})},addCustomerDevice(s){return c(this,null,function*(){yield w();const t=g(h({id:Date.now().toString()},s),{firmwareVersion:"2.1.0",healthScore:Math.floor(Math.random()*20)+80,usageStats:{totalUsageHours:0,dailyAverageUsage:0,lastUsedAt:new Date().toISOString(),coursesCompleted:0,charactersWritten:0},lastOnlineAt:s.status==="active"?new Date().toISOString():void 0});return p(t)})},removeCustomerDevice(s,t){return c(this,null,function*(){return yield w(),p(null)})},addCustomerServiceRecord(s){return c(this,null,function*(){yield w();const t=g(h({id:Date.now().toString()},s),{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});return p(t)})},updateCustomerServiceRecord(s,t,e){return c(this,null,function*(){yield w();const a=g(h({id:t,customerId:s},e),{updatedAt:new Date().toISOString()});return p(a)})}};class I{static generateOrderNumber(){const e=new Date().getTime().toString().slice(-8),a=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`ORD${e}${a}`}static generateOrderItem(){const t=[{id:"prod_001",name:"练字机器人 - 基础版",price:2999},{id:"prod_002",name:"练字机器人 - 专业版",price:4999},{id:"prod_003",name:"练字机器人 - 企业版",price:7999},{id:"prod_004",name:"智能写字板",price:599},{id:"prod_005",name:"专用墨水套装",price:199}],e=t[Math.floor(Math.random()*t.length)],a=Math.floor(Math.random()*5)+1;return{id:`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,productId:e.id,productName:e.name,quantity:a,unitPrice:e.price,totalPrice:e.price*a,notes:Math.random()>.7?"客户要求加急处理":""}}static generateOrder(){var N,b,Z,x;const t=[{name:"张三",phone:"13800138001",email:"zhangsan@example.com",address:"北京市朝阳区建国路1号"},{name:"李四",phone:"13800138002",email:"lisi@example.com",address:"上海市浦东新区陆家嘴路2号"},{name:"王五",phone:"13800138003",email:"wangwu@example.com",address:"广州市天河区珠江路3号"},{name:"赵六",phone:"13800138004",email:"zhaoliu@example.com",address:"深圳市南山区科技路4号"},{name:"钱七",phone:"13800138005",email:"qianqi@example.com",address:"杭州市西湖区文三路5号"}],e=["pending","confirmed","processing","shipped","delivered","completed","cancelled"],a=["sales","rental"],r=["pending","paid","failed","refunded"],n=["张经理","李经理","王经理","赵经理","钱经理"],i=t[Math.floor(Math.random()*t.length)],u=a[Math.floor(Math.random()*a.length)],d=e[Math.floor(Math.random()*e.length)],o=Math.floor(Math.random()*3)+1,m=Array.from({length:o},()=>this.generateOrderItem()),y=m.reduce((M,C)=>M+C.totalPrice,0),S=Math.floor(Math.random()*100)+50,P=Math.floor(Math.random()*200),R=y+S-P,f=new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),l={id:`order_${this.orderCounter++}`,orderNumber:this.generateOrderNumber(),type:u,status:d,customerId:`customer_${Math.floor(Math.random()*1e3)}`,customerName:i.name,customerPhone:i.phone,customerEmail:i.email,deliveryAddress:i.address,items:m,subtotal:y,shippingFee:S,discount:P,totalAmount:R,currency:"CNY",paymentStatus:r[Math.floor(Math.random()*r.length)],paymentMethod:Math.random()>.5?"微信支付":"支付宝",paymentTime:d!=="pending"?f:void 0,expectedDeliveryDate:new Date(Date.now()+Math.random()*7*24*60*60*1e3).toISOString().split("T")[0],salesPerson:n[Math.floor(Math.random()*n.length)],notes:Math.random()>.6?"客户要求尽快发货，联系方式已确认":"",createdAt:f,updatedAt:f,createdBy:"admin"};if(u==="rental"){const M=new Date(Date.now()+Math.random()*7*24*60*60*1e3),C=Math.floor(Math.random()*30)+7,_=new Date(M.getTime()+C*24*60*60*1e3);l.rentalStartDate=M.toISOString().split("T")[0],l.rentalEndDate=_.toISOString().split("T")[0],l.rentalDays=C,l.rentalNotes="租赁期间请妥善保管设备，如有损坏需要赔偿"}return["shipped","delivered","completed"].includes(d)&&(l.shippingInfo={company:Math.random()>.5?"顺丰快递":"京东物流",trackingNumber:`SF${Math.floor(Math.random()*1e12)}`,shippedAt:new Date(new Date(f).getTime()+1440*60*1e3).toISOString(),deliveredAt:d==="delivered"||d==="completed"?new Date(new Date(f).getTime()+4320*60*1e3).toISOString():void 0}),l.logs=[{id:"log_1",action:"创建订单",operator:l.salesPerson||"admin",notes:"订单创建成功",createdAt:l.createdAt}],d!=="pending"&&l.logs.push({id:"log_2",action:"确认订单",operator:l.salesPerson||"admin",notes:"订单已确认，准备处理",createdAt:new Date(new Date(f).getTime()+7200*1e3).toISOString()}),["shipped","delivered","completed"].includes(d)&&l.logs.push({id:"log_3",action:"发货",operator:"仓库管理员",notes:`已通过${(N=l.shippingInfo)==null?void 0:N.company}发货`,createdAt:((b=l.shippingInfo)==null?void 0:b.shippedAt)||f}),["delivered","completed"].includes(d)&&l.logs.push({id:"log_4",action:"送达",operator:"系统",notes:"订单已送达客户",createdAt:((Z=l.shippingInfo)==null?void 0:Z.deliveredAt)||f}),d==="completed"&&l.logs.push({id:"log_5",action:"完成",operator:l.salesPerson||"admin",notes:"订单已完成",createdAt:new Date(new Date(((x=l.shippingInfo)==null?void 0:x.deliveredAt)||f).getTime()+1440*60*1e3).toISOString()}),d==="cancelled"&&l.logs.push({id:"log_cancel",action:"取消",operator:l.salesPerson||"admin",notes:"订单已取消",createdAt:new Date(new Date(f).getTime()+1800*1e3).toISOString()}),l}static generateOrders(t=50){return Array.from({length:t},()=>this.generateOrder())}}T(I,"orderCounter",1e3);class k{static getOrders(){return c(this,arguments,function*(t={}){yield new Promise(o=>setTimeout(o,300));let e=[...this.orders];if(t.keyword){const o=t.keyword.toLowerCase();e=e.filter(m=>m.orderNumber.toLowerCase().includes(o)||m.customerName.toLowerCase().includes(o)||m.customerPhone.includes(o))}if(t.type&&(e=e.filter(o=>o.type===t.type)),t.status&&(e=e.filter(o=>o.status===t.status)),t.dateRange){const[o,m]=t.dateRange;e=e.filter(y=>{const S=y.createdAt.split("T")[0];return S>=o&&S<=m})}t.customerId&&(e=e.filter(o=>o.customerId===t.customerId)),t.salesPerson&&(e=e.filter(o=>o.salesPerson===t.salesPerson)),e.sort((o,m)=>new Date(m.createdAt).getTime()-new Date(o.createdAt).getTime());const a=t.page||1,r=t.pageSize||10,n=(a-1)*r,i=n+r,u=e.slice(n,i),d={total:this.orders.length,pending:this.orders.filter(o=>o.status==="pending").length,processing:this.orders.filter(o=>["confirmed","processing","shipped"].includes(o.status)).length,completed:this.orders.filter(o=>o.status==="completed").length,cancelled:this.orders.filter(o=>o.status==="cancelled").length,totalRevenue:this.orders.filter(o=>o.status==="completed").reduce((o,m)=>o+m.totalAmount,0),averageOrderValue:this.orders.length>0?this.orders.reduce((o,m)=>o+m.totalAmount,0)/this.orders.length:0,salesOrders:this.orders.filter(o=>o.type==="sales").length,rentalOrders:this.orders.filter(o=>o.type==="rental").length};return{data:{list:u,total:e.length,stats:d}}})}static getOrderById(t){return c(this,null,function*(){yield new Promise(a=>setTimeout(a,200));const e=this.orders.find(a=>a.id===t);if(!e)throw new Error("订单不存在");return{data:e}})}static createOrder(t){return c(this,null,function*(){var a;yield new Promise(r=>setTimeout(r,500));const e={id:`order_${Date.now()}`,orderNumber:t.orderNumber||I.generateOrderNumber(),type:t.type||"sales",status:"pending",customerId:t.customerId||`customer_${Date.now()}`,customerName:t.customerName||"",customerPhone:t.customerPhone||"",customerEmail:t.customerEmail,deliveryAddress:t.deliveryAddress||"",items:t.items||[],subtotal:((a=t.items)==null?void 0:a.reduce((r,n)=>r+(n.totalPrice||0),0))||0,shippingFee:t.shippingFee||0,discount:t.discount||0,totalAmount:t.totalAmount||0,currency:"CNY",paymentStatus:"pending",expectedDeliveryDate:t.expectedDeliveryDate,salesPerson:t.salesPerson,notes:t.notes,rentalStartDate:t.rentalStartDate,rentalEndDate:t.rentalEndDate,rentalDays:t.rentalDays,rentalNotes:t.rentalNotes,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"admin",logs:[{id:"log_1",action:"创建订单",operator:t.salesPerson||"admin",notes:"订单创建成功",createdAt:new Date().toISOString()}]};return this.orders.unshift(e),{data:e}})}static updateOrder(t,e){return c(this,null,function*(){yield new Promise(n=>setTimeout(n,500));const a=this.orders.findIndex(n=>n.id===t);if(a===-1)throw new Error("订单不存在");const r=g(h(h({},this.orders[a]),e),{updatedAt:new Date().toISOString()});return r.logs||(r.logs=[]),r.logs.push({id:`log_${Date.now()}`,action:"更新订单",operator:"admin",notes:"订单信息已更新",createdAt:new Date().toISOString()}),this.orders[a]=r,{data:r}})}static updateOrderStatus(t,e){return c(this,null,function*(){yield new Promise(i=>setTimeout(i,300));const a=this.orders.findIndex(i=>i.id===t);if(a===-1)throw new Error("订单不存在");const r=this.orders[a];r.status=e,r.updatedAt=new Date().toISOString(),r.logs||(r.logs=[]);const n={pending:"待确认",confirmed:"已确认",processing:"处理中",shipped:"已发货",delivered:"已送达",completed:"已完成",cancelled:"已取消"};return r.logs.push({id:`log_${Date.now()}`,action:n[e],operator:"admin",notes:`订单状态更新为：${n[e]}`,createdAt:new Date().toISOString()}),e==="shipped"&&!r.shippingInfo&&(r.shippingInfo={company:"顺丰快递",trackingNumber:`SF${Math.floor(Math.random()*1e12)}`,shippedAt:new Date().toISOString()}),e==="delivered"&&r.shippingInfo&&(r.shippingInfo.deliveredAt=new Date().toISOString()),e==="completed"&&(r.paymentStatus="paid",r.paymentTime||(r.paymentTime=new Date().toISOString())),{data:r}})}static batchUpdateOrderStatus(t,e){return c(this,null,function*(){yield new Promise(r=>setTimeout(r,500));const a=[];for(const r of t){const n=yield this.updateOrderStatus(r,e);a.push(n.data)}return{data:a}})}static deleteOrder(t){return c(this,null,function*(){yield new Promise(a=>setTimeout(a,300));const e=this.orders.findIndex(a=>a.id===t);if(e===-1)throw new Error("订单不存在");return this.orders.splice(e,1),{data:!0}})}static batchDeleteOrders(t){return c(this,null,function*(){return yield new Promise(e=>setTimeout(e,500)),this.orders=this.orders.filter(e=>!t.includes(e.id)),{data:!0}})}static exportOrders(){return c(this,arguments,function*(t={}){return yield new Promise(e=>setTimeout(e,1e3)),console.log("导出订单:",t),{data:!0}})}}T(k,"orders",I.generateOrders(100));const W=k;export{W as a,B as m};
