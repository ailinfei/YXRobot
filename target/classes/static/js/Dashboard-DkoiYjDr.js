var T=(i,n,c)=>new Promise((m,l)=>{var s=o=>{try{v(c.next(o))}catch(x){l(x)}},u=o=>{try{v(c.throw(o))}catch(x){l(x)}},v=o=>o.done?m(o.value):Promise.resolve(o.value).then(s,u);v((c=c.apply(i,n)).next())});import{r as de,b as ae,o as X,p as se}from"./element-plus-B_LAMX2W.js";/* empty css                                                                     */import{C as Y}from"./CountUp-DhNxH7hh.js";/* empty css                                                                  *//* empty css                                                                  */import{i as Q}from"./charts-4xgvsrqt.js";/* empty css                                                                       *//* empty css                                                                         */import{x as le,r as M,c as j,j as ue,h as re,n as q,S as ee,al as N,ar as ve,y as S,z as D,A as e,Q as p,I as B,u as L,J as me,K as Z,O as z,aB as oe,P as he,a6 as fe,D as ne}from"./vue-C2NPAEWw.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./order-DgpU5ivT.js";const pe={class:"dashboard-map-visualization"},ge={class:"chart-header"},_e={class:"header-right"},be={class:"chart-content"},ye=le({__name:"DashboardMapVisualization",setup(i,{expose:n}){const c=M(!1),m=M(),l=M("sales"),s=M("world");let u=null;const v=()=>{const d={world:{sales:[{name:"中国",value:15e6,coordinates:[104.195,35.86]},{name:"美国",value:12e6,coordinates:[-95.7,37.1]},{name:"日本",value:8e6,coordinates:[138.25,36.2]},{name:"德国",value:6e6,coordinates:[10.4,51.1]},{name:"英国",value:5e6,coordinates:[-.1,51.5]},{name:"法国",value:45e5,coordinates:[2.3,46.2]},{name:"韩国",value:35e5,coordinates:[127.8,35.9]},{name:"加拿大",value:3e6,coordinates:[-106.3,56.1]},{name:"澳大利亚",value:28e5,coordinates:[133.8,-25.3]},{name:"巴西",value:25e5,coordinates:[-47.9,-15.8]},{name:"印度",value:22e5,coordinates:[78.9,20.6]},{name:"俄罗斯",value:2e6,coordinates:[105.3,61.5]}],customers:[{name:"中国",value:5e4,coordinates:[104.195,35.86]},{name:"美国",value:35e3,coordinates:[-95.7,37.1]},{name:"日本",value:28e3,coordinates:[138.25,36.2]},{name:"德国",value:22e3,coordinates:[10.4,51.1]},{name:"英国",value:18e3,coordinates:[-.1,51.5]},{name:"法国",value:15e3,coordinates:[2.3,46.2]},{name:"韩国",value:12e3,coordinates:[127.8,35.9]},{name:"加拿大",value:1e4,coordinates:[-106.3,56.1]},{name:"澳大利亚",value:8500,coordinates:[133.8,-25.3]},{name:"巴西",value:7200,coordinates:[-47.9,-15.8]}],devices:[{name:"中国",value:8500,coordinates:[104.195,35.86]},{name:"美国",value:6200,coordinates:[-95.7,37.1]},{name:"日本",value:4800,coordinates:[138.25,36.2]},{name:"德国",value:3600,coordinates:[10.4,51.1]},{name:"英国",value:2900,coordinates:[-.1,51.5]},{name:"法国",value:2400,coordinates:[2.3,46.2]},{name:"韩国",value:2100,coordinates:[127.8,35.9]},{name:"加拿大",value:1800,coordinates:[-106.3,56.1]}],rentals:[{name:"中国",value:85e5,coordinates:[104.195,35.86]},{name:"美国",value:68e5,coordinates:[-95.7,37.1]},{name:"日本",value:42e5,coordinates:[138.25,36.2]},{name:"德国",value:31e5,coordinates:[10.4,51.1]},{name:"英国",value:26e5,coordinates:[-.1,51.5]},{name:"法国",value:22e5,coordinates:[2.3,46.2]},{name:"韩国",value:18e5,coordinates:[127.8,35.9]},{name:"加拿大",value:15e5,coordinates:[-106.3,56.1]}]},china:{sales:[{name:"北京",value:15e6,coordinates:[116.4,39.9]},{name:"上海",value:12e6,coordinates:[121.5,31.2]},{name:"广东",value:1e7,coordinates:[113.3,23.1]},{name:"江苏",value:8e6,coordinates:[118.8,32]},{name:"浙江",value:7e6,coordinates:[120.2,30.3]},{name:"山东",value:6e6,coordinates:[117,36.7]},{name:"河南",value:5e6,coordinates:[113.6,34.8]},{name:"四川",value:45e5,coordinates:[104.1,30.7]},{name:"湖北",value:4e6,coordinates:[114.3,30.6]},{name:"湖南",value:38e5,coordinates:[113,28.2]},{name:"河北",value:35e5,coordinates:[114.5,38]},{name:"福建",value:32e5,coordinates:[119.3,26.1]}],customers:[{name:"北京",value:45e3,coordinates:[116.4,39.9]},{name:"上海",value:38e3,coordinates:[121.5,31.2]},{name:"广东",value:32e3,coordinates:[113.3,23.1]},{name:"江苏",value:28e3,coordinates:[118.8,32]},{name:"浙江",value:25e3,coordinates:[120.2,30.3]},{name:"山东",value:22e3,coordinates:[117,36.7]},{name:"河南",value:18e3,coordinates:[113.6,34.8]},{name:"四川",value:16e3,coordinates:[104.1,30.7]},{name:"湖北",value:14e3,coordinates:[114.3,30.6]},{name:"湖南",value:12e3,coordinates:[113,28.2]}],devices:[{name:"北京",value:7500,coordinates:[116.4,39.9]},{name:"上海",value:6200,coordinates:[121.5,31.2]},{name:"广东",value:5800,coordinates:[113.3,23.1]},{name:"江苏",value:4900,coordinates:[118.8,32]},{name:"浙江",value:4200,coordinates:[120.2,30.3]},{name:"山东",value:3800,coordinates:[117,36.7]},{name:"河南",value:3200,coordinates:[113.6,34.8]},{name:"四川",value:2800,coordinates:[104.1,30.7]},{name:"湖北",value:2500,coordinates:[114.3,30.6]},{name:"湖南",value:2200,coordinates:[113,28.2]}],rentals:[{name:"北京",value:85e5,coordinates:[116.4,39.9]},{name:"上海",value:72e5,coordinates:[121.5,31.2]},{name:"广东",value:68e5,coordinates:[113.3,23.1]},{name:"江苏",value:55e5,coordinates:[118.8,32]},{name:"浙江",value:48e5,coordinates:[120.2,30.3]},{name:"山东",value:42e5,coordinates:[117,36.7]},{name:"河南",value:36e5,coordinates:[113.6,34.8]},{name:"四川",value:32e5,coordinates:[104.1,30.7]},{name:"湖北",value:28e5,coordinates:[114.3,30.6]},{name:"湖南",value:25e5,coordinates:[113,28.2]}]}};return d[s.value][l.value]||d.world.sales},o=j(()=>v());j(()=>o.value.reduce((d,g)=>d+g.value,0)),j(()=>o.value.length),j(()=>({sales:12.5,customers:8.3,devices:15.2,rentals:6.8})[l.value]);const x=()=>({sales:"销售额",customers:"客户数",devices:"设备数",rentals:"租赁收入"})[l.value],b=d=>l.value==="sales"||l.value==="rentals"?`¥${(d/1e4).toFixed(1)}万`:l.value==="customers"?`${d.toLocaleString()}人`:`${d.toLocaleString()}台`,A=(d,g)=>{if(!d||!g||g===0)return"#E5E7EB";const y=Math.max(0,Math.min(1,d/g));return y>.8?"#EF4444":y>.6?"#F97316":y>.4?"#EAB308":y>.2?"#22C55E":"#6B7280"},k=()=>{O()},G=()=>{O()},F=()=>{c.value=!0,setTimeout(()=>{O(),c.value=!1,ae.success("数据已刷新")},500)},O=()=>T(null,null,function*(){if(!u){console.warn("ECharts实例不存在，无法更新图表");return}const d=o.value;if(console.log("当前数据:",d),!d||d.length===0){console.warn("数据为空");return}const g=Math.max(...d.map(h=>h.value));console.log("最大值:",g);const y=d.map(h=>({name:h.name,value:[...h.coordinates,h.value],itemStyle:{color:A(h.value,g),borderColor:"#fff",borderWidth:2}}));console.log("散点数据:",y);const $={backgroundColor:"#ffffff",title:{text:s.value==="world"?"全球业务分布":"中国业务分布",left:"center",top:20,textStyle:{color:"#374151",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"transparent",textStyle:{color:"#fff",fontSize:12},formatter:function(h){const R=Array.isArray(h.data.value)?h.data.value[2]:h.data.value;return`<div style="padding: 8px;">
          <div style="font-weight: bold; margin-bottom: 4px;">${h.data.name}</div>
          <div>${x()}: ${b(R)}</div>
        </div>`}},grid:{left:"5%",right:"5%",top:"10%",bottom:"5%",backgroundColor:"#ffffff",borderColor:"transparent",borderWidth:0,show:!1},xAxis:{type:"value",scale:!0,min:s.value==="world"?-180:70,max:s.value==="world"?180:140,show:!1,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},yAxis:{type:"value",scale:!0,min:s.value==="world"?-60:15,max:s.value==="world"?80:55,show:!1,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},series:[{name:"海洋",type:"scatter",data:[],symbolSize:0,itemStyle:{color:"transparent"},markArea:{silent:!0,itemStyle:{color:"#e6f3ff",borderWidth:0},data:[[{coord:[s.value==="world"?-180:70,s.value==="world"?-60:15]},{coord:[s.value==="world"?180:140,s.value==="world"?80:55]}]]}},{name:"大陆",type:"custom",renderItem:function(h,R){return{type:"group",children:(s.value==="world"?[[[-130,60],[-60,60],[-60,20],[-130,20]],[[-80,10],[-35,10],[-35,-55],[-80,-55]],[[-10,70],[40,70],[40,35],[-10,35]],[[10,35],[50,35],[50,-35],[10,-35]],[[60,80],[180,80],[180,10],[60,10]],[[110,-10],[155,-10],[155,-45],[110,-45]]]:[[[73,53],[135,53],[135,18],[73,18]]]).map(f=>({type:"polygon",shape:{points:f.map(t=>R.coord(t))},style:{fill:"#f5f5f5",stroke:"#d1d5db",lineWidth:1}}))}},data:[0]},{name:"国家边界",type:"lines",coordinateSystem:"geo",data:s.value==="world"?[{coords:[[-95.7,49],[-95.7,25]]},{coords:[[-60,5],[-60,-30]]},{coords:[[2,51],[2,42]]},{coords:[[10,54],[10,47]]},{coords:[[104,53],[104,18]]},{coords:[[138,45],[138,30]]},{coords:[[77,37],[77,8]]},{coords:[[37,82],[37,41]]},{coords:[[133,-10],[133,-44]]}]:[{coords:[[116,53],[116,18]]},{coords:[[104,53],[104,18]]},{coords:[[87,53],[87,18]]},{coords:[[73,40],[135,40]]},{coords:[[73,30],[135,30]]}],lineStyle:{color:"#cbd5e1",width:.5,type:"dashed"},silent:!0},{name:x(),type:"scatter",data:y,symbolSize:function(h){const R=Array.isArray(h)?h[2]:h||0;return Math.max(20,Math.min(60,R/g*50))},itemStyle:{shadowBlur:15,shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffsetY:3,borderWidth:3,borderColor:"#fff"},emphasis:{itemStyle:{shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.5)",borderWidth:4},scale:1.3},label:{show:!0,position:"top",formatter:"{b}",color:"#374151",fontSize:11,fontWeight:"bold",distance:10}}],animation:!0,animationDuration:1500,animationEasing:"cubicOut"};console.log("设置图表选项:",$),u.setOption($,!0),console.log("图表更新完成")}),W=()=>T(null,null,function*(){if(!m.value){console.warn("地图容器未找到");return}try{u&&(u.dispose(),u=null),yield q();const d=m.value.getBoundingClientRect();if(d.width===0||d.height===0){console.warn("地图容器尺寸为0，延迟初始化"),setTimeout(()=>W(),100);return}u=Q(m.value,null,{renderer:"canvas",useDirtyRect:!1}),console.log("ECharts实例创建成功"),yield O();const g=()=>{u&&u.resize()};window.addEventListener("resize",g),ee(()=>{window.removeEventListener("resize",g)})}catch(d){console.error("初始化图表失败:",d),ae.error("图表初始化失败")}});return ue([l,s],()=>{O()},{deep:!0}),re(()=>T(null,null,function*(){yield q(),yield W()})),ee(()=>{u&&(u.dispose(),u=null)}),n({refreshData:F}),(d,g)=>{const y=N("el-option"),$=N("el-select"),h=N("el-icon"),R=N("el-button"),V=ve("loading");return D(),S("div",pe,[e("div",ge,[g[2]||(g[2]=e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"业务分布地图"),e("p",{class:"chart-subtitle"},"全球销售、客户、设备分布可视化")],-1)),e("div",_e,[p($,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=f=>l.value=f),size:"small",style:{width:"120px"},onChange:k},{default:B(()=>[p(y,{label:"销售分布",value:"sales"}),p(y,{label:"客户分布",value:"customers"}),p(y,{label:"设备分布",value:"devices"}),p(y,{label:"租赁分布",value:"rentals"})]),_:1},8,["modelValue"]),p($,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=f=>s.value=f),size:"small",style:{width:"100px"},onChange:G},{default:B(()=>[p(y,{label:"世界地图",value:"world"}),p(y,{label:"中国地图",value:"china"})]),_:1},8,["modelValue"]),p(R,{size:"small",onClick:F,loading:c.value},{default:B(()=>[p(h,null,{default:B(()=>[p(L(de))]),_:1})]),_:1},8,["loading"])])]),e("div",be,[me(e("div",{ref_key:"mapContainer",ref:m,class:"map-container"},null,512),[[V,c.value]])])])}}}),we=ie(ye,[["__scopeId","data-v-1b58b4f2"]]),a=(i,n)=>Math.floor(Math.random()*(n-i+1))+i,C=(i,n,c=2)=>parseFloat((Math.random()*(n-i)+i).toFixed(c)),Ce=i=>{const n=new Date;return n.setDate(n.getDate()-a(0,i)),n.toISOString()};class I{static generateDashboardStats(){const n=a(8e6,15e6),c=a(6e5,12e5),m=a(3e3,8e3),l=a(200,600),s=a(500,1200),u=a(300,s-100),v=a(1e3,3e3),o=a(600,v-200),x=Math.floor(n*.7),b=Math.floor(c*.7),A=Math.floor(m*.6),k=Math.floor(l*.6),G=n-x,F=c-b,O=m-A,W=l-k,d=a(80,150),g=Math.floor(d*.7),y=Math.floor(d*.2),$=d-g-y,h=a(40,80),R=Math.floor(h*.6),V=Math.floor(h*.15),f=Math.floor(h*.2),t=h-R-V-f,w=a(15,30),_=Math.floor(w*.8),r=Math.floor(w*.15),E=w-_-r,P=a(40,80),U=Math.floor(P*.8),te=Math.floor(P*.15),ce=P-U-te;return{business:{totalRevenue:n,monthlyRevenue:c,revenueGrowth:C(-8,35),totalOrders:m,monthlyOrders:l,orderGrowth:C(-5,28),activeDevices:u,deviceUtilization:C(68,88),totalCustomers:v,activeCustomers:o,customerGrowth:C(5,25),averageOrderValue:Math.round(n/m),conversionRate:C(3.5,8.2)},devices:{total:s,online:u,offline:a(50,150),maintenance:a(20,60),error:a(10,40),updating:a(5,25),averageBatteryLevel:a(65,85),averageSignalStrength:a(70,90),alertCount:a(15,50),healthScore:a(75,95)},sales:{totalSalesRevenue:x,monthlySalesRevenue:b,salesGrowth:C(-5,30),totalSalesOrders:A,monthlySalesOrders:k,averageSalesOrderValue:Math.round(x/A),topSellingProduct:"YX机器人专业版",salesConversionRate:C(4.2,9.1)},rental:{totalRentalRevenue:G,monthlyRentalRevenue:F,rentalGrowth:C(-3,25),totalRentalOrders:O,monthlyRentalOrders:W,averageRentalPeriod:a(25,45),deviceUtilizationRate:C(72,89),rentalConversionRate:C(2.8,6.5)},courses:{total:d,active:g,draft:y,archived:$,totalCharacters:a(3e3,8e3),completedLessons:a(8e3,25e3),averageRating:C(4.2,4.8,1),popularCourse:"基础汉字入门课程"},fontPackages:{total:h,published:R,training:V,completed:f,failed:t,totalSamples:a(2e3,8e3),averageAccuracy:C(88,96),totalDownloads:a(5e3,2e4)},languages:{supported:12,enabled:a(8,11),averageCompleteness:C(75,92),totalTranslations:a(3e3,1e4),robotInterfaceTexts:a(150,300),websiteContents:a(200,400),pendingTranslations:a(50,200)},products:{total:w,published:_,draft:r,archived:E,totalReviews:a(500,2e3),averageRating:C(4.3,4.9,1),totalSales:A,stockAlerts:a(2,8)},charity:{totalProjects:a(25,40),activeProjects:a(8,15),totalBeneficiaries:a(8e3,2e4),totalDonations:a(2e6,6e6),totalVolunteers:a(80,150),activeVolunteers:a(40,80),totalInstitutions:a(60,120),thisMonthActivities:a(8,20)},platformLinks:{total:P,active:U,inactive:te,error:ce,totalClicks:a(5e4,2e5),totalConversions:a(2e3,8e3),averageConversionRate:C(3.5,7.2),topPerformingPlatform:"淘宝"},customers:{total:v,active:o,inactive:v-o,vip:Math.floor(v*.15),newThisMonth:a(50,200),churnRate:C(2.5,8.5),averageLifetimeValue:a(8e3,25e3),satisfactionScore:C(4.1,4.7,1)}}}static generateRecentActivities(n=20){const c=[],m=["order","device","course","fontPackage","translation"],l=["success","warning","error","info"],s=["张管理员","李操作员","王技术员","陈编辑","刘审核员"],u={order:["新订单创建成功","订单状态更新","订单支付完成","订单取消处理","订单退款申请"],device:["设备上线运行","设备进入维护模式","设备状态异常","设备固件更新","设备离线告警"],course:["新课程发布","课程内容更新","课程汉字添加","课程状态变更","课程删除操作"],fontPackage:["AI字体包训练开始","字体包生成完成","字体包发布上线","字体样本上传","字体包审核通过"],translation:["多语言翻译更新","新语言支持添加","翻译内容审核","批量翻译完成","翻译文件导入"]};for(let v=1;v<=n;v++){const o=m[a(0,m.length-1)],x=u[o],b=x[a(0,x.length-1)];c.push({id:v,type:o,title:b,description:`${b} - 详细描述信息 ${v}`,timestamp:Ce(7),status:l[a(0,l.length-1)],user:s[a(0,s.length-1)]})}return c.sort((v,o)=>new Date(o.timestamp).getTime()-new Date(v.timestamp).getTime())}static generateTrendData(n=30){const c=[],m=new Date;for(let l=n-1;l>=0;l--){const s=new Date(m);s.setDate(s.getDate()-l),c.push({date:s.toISOString().slice(0,10),revenue:a(5e3,15e3),orders:a(10,30),devices:a(50,100),customers:a(20,50)})}return c}static generateTopPerformers(){const n=["YX-Robot-Pro","YX-Robot-Standard","YX-Robot-Lite"],c=["基础汉字入门","常用汉字练习","小学一年级汉字","商务汉字课程","日常生活汉字","汉字笔画学习","部首认识课程","传统汉字艺术"],m=["张伟","王芳","李娜","刘强","陈静","杨洋","赵敏","黄磊","周杰","吴亮","徐丽","孙勇","马超","朱琳","胡斌","郭敏"];return{devices:Array.from({length:5},(l,s)=>({id:`YX-${String(s+1).padStart(4,"0")}`,model:n[a(0,n.length-1)],utilization:C(80,95),revenue:a(5e4,15e4)})).sort((l,s)=>s.utilization-l.utilization),courses:Array.from({length:5},(l,s)=>({id:s+1,name:c[a(0,c.length-1)],completions:a(100,500),rating:C(4,5,1)})).sort((l,s)=>s.completions-l.completions),customers:Array.from({length:5},(l,s)=>({id:s+1,name:m[a(0,m.length-1)],totalSpent:a(1e4,5e4),orderCount:a(5,25)})).sort((l,s)=>s.totalSpent-l.totalSpent)}}}const H=(i=500)=>new Promise(n=>setTimeout(n,i)),J=(i,n=200,c="success")=>({code:n,message:c,data:i,timestamp:Date.now()}),K={getDashboardStats(){return T(this,null,function*(){return yield H(),J(I.generateDashboardStats())})},getRecentActivities(i){return T(this,null,function*(){yield H();let n=I.generateRecentActivities(50);i!=null&&i.type&&(n=n.filter(o=>o.type===i.type)),i!=null&&i.status&&(n=n.filter(o=>o.status===i.status));const c=(i==null?void 0:i.page)||1,m=(i==null?void 0:i.pageSize)||10,l=n.length,s=(c-1)*m,u=s+m,v=n.slice(s,u);return J({list:v,total:l,page:c,pageSize:m,totalPages:Math.ceil(l/m)})})},getTrendData(i){return T(this,null,function*(){yield H();const n=(i==null?void 0:i.days)||30,c=I.generateTrendData(n);return J(c)})},getTopPerformers(){return T(this,null,function*(){return yield H(),J(I.generateTopPerformers())})}},xe={class:"dashboard",style:{width:"100%","max-width":"100%",margin:"0",padding:"24px 8px"}},Se={class:"metrics-cards"},De={class:"metric-card sales-card"},Me={class:"card-content"},ke={class:"card-value"},Re={class:"card-change positive"},ze={class:"change-text"},Le={class:"metric-card rental-card"},Pe={class:"card-content"},Te={class:"card-value"},Ae={class:"card-change positive"},Oe={class:"change-text"},$e={class:"metric-card orders-card"},Ve={class:"card-content"},Ee={class:"card-value"},Be={class:"card-change positive"},Fe={class:"change-text"},We={class:"metric-card customers-card"},Ne={class:"card-content"},Ge={class:"card-value"},Ue={class:"card-change positive"},Xe={class:"change-text"},Ye={key:0,class:"device-status-section"},je={class:"device-status-cards"},Ie={class:"status-card online"},He={class:"status-info"},Je={class:"status-count"},Ke={class:"status-card offline"},Qe={class:"status-info"},qe={class:"status-count"},Ze={class:"status-card maintenance"},et={class:"status-info"},tt={class:"status-count"},at={class:"status-card error"},st={class:"status-info"},ot={class:"status-count"},nt={class:"charts-section",style:{width:"100%","max-width":"100%",margin:"0"}},lt={class:"charts-row two-column-layout"},rt={class:"chart-card sales-trend-card",style:{width:"100%","min-width":"0"}},it={class:"chart-header"},ct={class:"header-right"},dt={class:"chart-content"},ut={class:"chart-card channel-analysis-card",style:{width:"100%","min-width":"0"}},vt={class:"chart-header"},mt={class:"header-right"},ht={class:"chart-content"},ft={class:"charts-row single-column-layout"},pt={class:"chart-card map-visualization-card",style:{width:"100%","min-width":"0"}},gt={key:1,class:"recent-activities-section"},_t={class:"activities-list"},bt={class:"activity-icon"},yt={key:0},wt={key:1},Ct={key:2},xt={key:3},St={key:4},Dt={key:5},Mt={class:"activity-content"},kt={class:"activity-title"},Rt={class:"activity-description"},zt={class:"activity-meta"},Lt={key:0,class:"activity-user"},Pt={class:"activity-time"},Tt={key:0},At={key:1},Ot={key:2},$t={key:3},Vt=le({__name:"Dashboard",setup(i){M(["2024-01-01","2024-01-31"]),M(!1);const n=M(),c=M(),m=M(),l=M();let s=null,u=null,v=null;const o=M(null),x=M([]),b=M([]),A=M(null),k=M({totalSales:125e4,salesChange:12.5,totalRental:385e3,rentalChange:8.7,totalOrders:3680,ordersChange:8.3,newCustomers:456,customersChange:15.2}),G=f=>{const t=new Date(f),_=new Date().getTime()-t.getTime(),r=Math.floor(_/(1e3*60)),E=Math.floor(_/(1e3*60*60)),P=Math.floor(_/(1e3*60*60*24));return r<1?"刚刚":r<60?`${r}分钟前`:E<24?`${E}小时前`:P<7?`${P}天前`:t.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})},F=()=>T(null,null,function*(){var f;try{const[t,w,_,r]=yield Promise.all([K.getDashboardStats(),K.getRecentActivities({pageSize:10}),K.getTrendData({days:30}),K.getTopPerformers()]);if(o.value=t.data,x.value=w.data.list,b.value=_.data,A.value=r.data,o.value){const E=o.value.business.totalRevenue,P=Math.round(E*.25),U=E-P;k.value={totalSales:U,salesChange:o.value.business.revenueGrowth,totalRental:P,rentalChange:((f=o.value.rental)==null?void 0:f.rentalGrowth)||Math.round(Math.random()*15)+5,totalOrders:o.value.business.totalOrders,ordersChange:o.value.business.orderGrowth,newCustomers:o.value.business.totalCustomers-o.value.business.activeCustomers,customersChange:Math.round(Math.random()*20)+5}}g()}catch(t){console.error("加载数据失败:",t)}}),O=()=>{if(!n.value)return;s=Q(n.value);const f={tooltip:{trigger:"axis",formatter:function(t){let w=t[0].name+"<br/>";return t.forEach(_=>{w+=_.marker+_.seriesName+": ¥"+_.value.toLocaleString()+"<br/>"}),w}},legend:{data:["销售收入","租赁收入"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月","7月"],axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#f0f0f0"}},axisLabel:{formatter:function(t){return"¥"+(t/1e4).toFixed(0)+"w"}}},series:[{name:"销售收入",type:"bar",data:[185e3,198e3,165e3,22e4,245e3,268e3,285e3],itemStyle:{color:"#6366f1",borderRadius:[4,4,0,0]},barWidth:"30%"},{name:"租赁收入",type:"bar",data:[45e3,52e3,48e3,58e3,65e3,72e3,78e3],itemStyle:{color:"#10b981",borderRadius:[4,4,0,0]},barWidth:"30%"}]};s.setOption(f)},W=()=>{if(!c.value)return;u=Q(c.value);const f={tooltip:{trigger:"item",formatter:function(t){return`${t.seriesName}<br/>${t.name}: ${t.value}人 (${t.percent}%)`}},legend:{orient:"vertical",left:"left",data:["中国大陆","美国","日本","韩国","新加坡","其他地区"]},series:[{name:"客户地区分布",type:"pie",radius:["40%","70%"],center:["60%","50%"],data:[{value:1248,name:"中国大陆"},{value:435,name:"美国"},{value:380,name:"日本"},{value:284,name:"韩国"},{value:156,name:"新加坡"},{value:197,name:"其他地区"}],itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}
{c}人 ({d}%)`,fontSize:12},labelLine:{show:!0,length:15,length2:10},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold"},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],color:["#6366f1","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"]};u.setOption(f)},d=()=>{if(!m.value)return;v=Q(m.value);const f={tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月"],axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#666"}},yAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#f0f0f0"}},axisLabel:{color:"#666"}},series:[{name:"线上渠道",type:"line",data:[120,132,101,134,90,230],smooth:!0,itemStyle:{color:"#5470c6"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(84, 112, 198, 0.3)"},{offset:1,color:"rgba(84, 112, 198, 0.05)"}]}}},{name:"线下渠道",type:"line",data:[220,182,191,234,290,330],smooth:!0,itemStyle:{color:"#91cc75"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(145, 204, 117, 0.3)"},{offset:1,color:"rgba(145, 204, 117, 0.05)"}]}}},{name:"合作伙伴",type:"line",data:[150,232,201,154,190,330],smooth:!0,itemStyle:{color:"#fac858"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(250, 200, 88, 0.3)"},{offset:1,color:"rgba(250, 200, 88, 0.05)"}]}}}]};v.setOption(f)},g=()=>{b.value.length>0&&y(),A.value&&$(),h()},y=()=>{if(!s||!b.value.length)return;const f=b.value.map(_=>{const r=new Date(_.date);return`${r.getMonth()+1}/${r.getDate()}`}),t=b.value.map(_=>_.revenue),w=b.value.map(_=>_.orders*1e3);s.setOption({xAxis:{data:f.slice(-7)},series:[{name:"销售收入",data:t.slice(-7)},{name:"租赁收入",data:w.slice(-7)}]})},$=()=>{if(!u||!o.value)return;const f=[{value:Math.round(o.value.business.totalCustomers*.45),name:"中国大陆"},{value:Math.round(o.value.business.totalCustomers*.2),name:"美国"},{value:Math.round(o.value.business.totalCustomers*.15),name:"日本"},{value:Math.round(o.value.business.totalCustomers*.1),name:"韩国"},{value:Math.round(o.value.business.totalCustomers*.06),name:"新加坡"},{value:Math.round(o.value.business.totalCustomers*.04),name:"其他地区"}];u.setOption({series:[{data:f}]})},h=()=>{if(!v||!b.value.length)return;const f=b.value.slice(-6).map(r=>`${new Date(r.date).getMonth()+1}月`),t=b.value.slice(-6).map(r=>Math.round(r.orders*.4)),w=b.value.slice(-6).map(r=>Math.round(r.orders*.45)),_=b.value.slice(-6).map(r=>Math.round(r.orders*.15));v.setOption({xAxis:{data:f},series:[{name:"线上渠道",data:t},{name:"线下渠道",data:w},{name:"合作伙伴",data:_}]})},R=()=>{O(),W(),d()},V=()=>{s==null||s.resize(),u==null||u.resize(),v==null||v.resize()};return re(()=>T(null,null,function*(){yield q(),yield F(),yield q(),R(),window.addEventListener("resize",V)})),ee(()=>{s==null||s.dispose(),u==null||u.dispose(),v==null||v.dispose(),window.removeEventListener("resize",V)}),(f,t)=>{const w=N("el-icon"),_=N("el-button");return D(),S("div",xe,[t[20]||(t[20]=e("div",{class:"dashboard-header"},[e("div",{class:"header-left"},[e("h2",null,"销售租赁数据"),e("p",{class:"header-subtitle"},"销售数据分析 · 练字机器人管理系统")])],-1)),e("div",Se,[e("div",De,[e("div",Me,[t[1]||(t[1]=e("div",{class:"card-title"},"销售总额",-1)),e("div",ke,[t[0]||(t[0]=e("span",{class:"currency"},"¥",-1)),p(L(Y),{value:k.value.totalSales,decimals:2,class:"value-number"},null,8,["value"])]),e("div",Re,[p(w,{class:"change-icon"},{default:B(()=>[p(L(X))]),_:1}),e("span",ze,"+"+z(k.value.salesChange)+"%",1)])])]),e("div",Le,[e("div",Pe,[t[3]||(t[3]=e("div",{class:"card-title"},"租赁收入",-1)),e("div",Te,[t[2]||(t[2]=e("span",{class:"currency"},"¥",-1)),p(L(Y),{value:k.value.totalRental,decimals:2,class:"value-number"},null,8,["value"])]),e("div",Ae,[p(w,{class:"change-icon"},{default:B(()=>[p(L(X))]),_:1}),e("span",Oe,"+"+z(k.value.rentalChange)+"%",1)])])]),e("div",$e,[e("div",Ve,[t[4]||(t[4]=e("div",{class:"card-title"},"订单数量",-1)),e("div",Ee,[p(L(Y),{value:k.value.totalOrders,decimals:0,class:"value-number"},null,8,["value"])]),e("div",Be,[p(w,{class:"change-icon"},{default:B(()=>[p(L(X))]),_:1}),e("span",Fe,"+"+z(k.value.ordersChange)+"%",1)])])]),e("div",We,[e("div",Ne,[t[5]||(t[5]=e("div",{class:"card-title"},"新客户",-1)),e("div",Ge,[p(L(Y),{value:k.value.newCustomers,decimals:0,class:"value-number"},null,8,["value"])]),e("div",Ue,[p(w,{class:"change-icon"},{default:B(()=>[p(L(X))]),_:1}),e("span",Xe,"+"+z(k.value.customersChange)+"%",1)])])])]),o.value?(D(),S("div",Ye,[t[14]||(t[14]=e("div",{class:"section-header"},[e("h3",null,"设备状态概览"),e("p",null,"实时设备运行状态监控")],-1)),e("div",je,[e("div",Ie,[t[7]||(t[7]=e("div",{class:"status-icon"},"🟢",-1)),e("div",He,[t[6]||(t[6]=e("div",{class:"status-title"},"在线",-1)),e("div",Je,z(o.value.devices.online),1)])]),e("div",Ke,[t[9]||(t[9]=e("div",{class:"status-icon"},"🔴",-1)),e("div",Qe,[t[8]||(t[8]=e("div",{class:"status-title"},"离线",-1)),e("div",qe,z(o.value.devices.offline),1)])]),e("div",Ze,[t[11]||(t[11]=e("div",{class:"status-icon"},"🔧",-1)),e("div",et,[t[10]||(t[10]=e("div",{class:"status-title"},"维护中",-1)),e("div",tt,z(o.value.devices.maintenance),1)])]),e("div",at,[t[13]||(t[13]=e("div",{class:"status-icon"},"⚠️",-1)),e("div",st,[t[12]||(t[12]=e("div",{class:"status-title"},"故障",-1)),e("div",ot,z(o.value.devices.error),1)])])])])):Z("",!0),e("div",nt,[e("div",lt,[e("div",rt,[e("div",it,[t[15]||(t[15]=e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"销售租赁趋势分析"),e("p",{class:"chart-subtitle"},"各月销售租赁数据对比分析")],-1)),e("div",ct,[p(_,{text:"",icon:L(se)},null,8,["icon"])])]),e("div",dt,[t[16]||(t[16]=oe('<div class="chart-legend" data-v-cfb080fa><div class="legend-item" data-v-cfb080fa><span class="legend-dot sales-dot" data-v-cfb080fa></span><span class="legend-text" data-v-cfb080fa>销售额</span></div><div class="legend-item" data-v-cfb080fa><span class="legend-dot orders-dot" data-v-cfb080fa></span><span class="legend-text" data-v-cfb080fa>订单数</span></div></div>',1)),e("div",{ref_key:"salesTrendChart",ref:n,class:"chart-container",style:{height:"320px",width:"100%"}},null,512)])]),e("div",ut,[e("div",vt,[t[17]||(t[17]=e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"销售租赁渠道分析"),e("p",{class:"chart-subtitle"},"各渠道租赁销售数据对比")],-1)),e("div",mt,[p(_,{text:"",icon:L(se)},null,8,["icon"])])]),e("div",ht,[t[18]||(t[18]=oe('<div class="channel-legend" data-v-cfb080fa><div class="legend-item" data-v-cfb080fa><span class="legend-dot online-dot" data-v-cfb080fa></span><span class="legend-text" data-v-cfb080fa>线上渠道</span></div><div class="legend-item" data-v-cfb080fa><span class="legend-dot offline-dot" data-v-cfb080fa></span><span class="legend-text" data-v-cfb080fa>线下渠道</span></div><div class="legend-item" data-v-cfb080fa><span class="legend-dot partner-dot" data-v-cfb080fa></span><span class="legend-text" data-v-cfb080fa>合作伙伴</span></div></div>',1)),e("div",{ref_key:"channelAnalysisChart",ref:m,class:"chart-container",style:{height:"320px",width:"100%"}},null,512)])])]),e("div",ft,[e("div",pt,[p(we,{ref_key:"mapVisualizationRef",ref:l},null,512)])])]),x.value.length>0?(D(),S("div",gt,[t[19]||(t[19]=e("div",{class:"section-header"},[e("h3",null,"最近活动"),e("p",null,"系统最新动态和操作记录")],-1)),e("div",_t,[(D(!0),S(he,null,fe(x.value.slice(0,8),r=>(D(),S("div",{key:r.id,class:ne(["activity-item",r.status])},[e("div",bt,[r.type==="order"?(D(),S("span",yt,"📋")):r.type==="device"?(D(),S("span",wt,"🤖")):r.type==="course"?(D(),S("span",Ct,"📚")):r.type==="fontPackage"?(D(),S("span",xt,"🎨")):r.type==="translation"?(D(),S("span",St,"🌐")):(D(),S("span",Dt,"ℹ️"))]),e("div",Mt,[e("div",kt,z(r.title),1),e("div",Rt,z(r.description),1),e("div",zt,[r.user?(D(),S("span",Lt,z(r.user),1)):Z("",!0),e("span",Pt,z(G(r.timestamp)),1)])]),e("div",{class:ne(["activity-status",r.status])},[r.status==="success"?(D(),S("span",Tt,"✅")):r.status==="warning"?(D(),S("span",At,"⚠️")):r.status==="error"?(D(),S("span",Ot,"❌")):(D(),S("span",$t,"ℹ️"))],2)],2))),128))])])):Z("",!0)])}}}),Jt=ie(Vt,[["__scopeId","data-v-cfb080fa"]]);export{Jt as default};
