var He=Object.defineProperty,qe=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var Me=(a,n,r)=>n in a?He(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r,he=(a,n)=>{for(var r in n||(n={}))Je.call(n,r)&&Me(a,r,n[r]);if(we)for(var r of we(n))Qe.call(n,r)&&Me(a,r,n[r]);return a},pe=(a,n)=>qe(a,Ke(n));var V=(a,n,r)=>new Promise((v,c)=>{var h=d=>{try{b(r.next(d))}catch(S){c(S)}},p=d=>{try{b(r.throw(d))}catch(S){c(S)}},b=d=>d.done?v(d.value):Promise.resolve(d.value).then(h,p);b((r=r.apply(a,n)).next())});import{o as de,j as Ze}from"./element-plus-B_LAMX2W.js";/* empty css                                                                     */import{C as ue}from"./CountUp-DhNxH7hh.js";/* empty css                                                                  *//* empty css                                                                  */import{i as ie}from"./charts-4xgvsrqt.js";/* empty css                                                                       *//* empty css                                                                         */import{x as Se,c as le,r as C,j as et,S as ze,al as T,H as xe,z as ee,I as _,y as ve,K as tt,A as e,O as y,Q as l,M as N,n as re,h as at,ar as ot,u as W,J as nt,P as st,a6 as it}from"./vue-C2NPAEWw.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $=(a,n)=>Math.floor(Math.random()*(n-a+1))+a,O=(a,n,r=2)=>parseFloat((Math.random()*(n-a)+a).toFixed(r)),lt=a=>{const n=[],r=new Date;for(let v=a-1;v>=0;v--){const c=new Date(r);c.setDate(c.getDate()-v),n.push(c.toISOString().slice(0,10))}return n};class ne{static generateRentalStats(){const n=$(450,650),r=Math.round(n*O(.75,.92)),v=O(78,94),c=$(3200,4800),h=$(32,58),p=O(220,380);return{totalRentalRevenue:Math.round(r*v/100*365*p),totalRentalDevices:n,activeRentalDevices:r,deviceUtilizationRate:v,averageRentalPeriod:h,totalRentalOrders:c,revenueGrowthRate:O(15,35),deviceGrowthRate:O(18,42)}}static generateRentalTrendData(n,r=30){const v=lt(r);return v.map((c,h)=>{const p=new Date(c).getDay(),b=p===0||p===6;let d=45e3,S=85,R=180,z=82;b&&(d*=.75,S*=.65,z*=.85);const Y=1+h/v.length*.45;d*=Y,S*=Y,R*=Y;const I=1+Math.sin(h/v.length*Math.PI*2)*.25,U=1+Math.sin(h/v.length*Math.PI*8)*.15,w=O(.85,1.25);return{date:c,revenue:Math.round(d*I*U*w),orderCount:Math.round(S*I*U*w),deviceCount:Math.round(R*Y*O(.95,1.05)),utilizationRate:Math.round(Math.min(98,Math.max(65,z*I*O(.92,1.08))))}})}static generateDeviceUtilizationData(){const n=["YX-Robot-Pro","YX-Robot-Standard","YX-Robot-Lite","YX-Robot-Mini"],r=["华北","华东","华南","华中","西南","西北","东北","华西"],v=[];for(let c=1;c<=300;c++){const p=n[$(0,n.length-1)],b=r[$(0,r.length-1)];let d=.7,S=75,R=70;switch(p){case"YX-Robot-Pro":d=.85,S=85,R=85;break;case"YX-Robot-Standard":d=.75,S=78,R=75;break;case"YX-Robot-Lite":d=.65,S=70,R=68;break;case"YX-Robot-Mini":d=.55,S=65,R=60;break}const z=["华东","华南","华北"].includes(b)?10:["华中","西南"].includes(b)?5:0,Y=O(-.2,.2),I=Math.max(.2,Math.min(.95,d+Y)),U=Math.round(365*I),w=Math.round(U/365*100),F=Math.round(Math.max(30,Math.min(100,S-(w-50)*.3+O(-10,10)))),j=Math.round(Math.max(20,Math.min(100,R+z+O(-15,15))));let s;if(w>85){const g=Math.random();g>.6?s="renting":g>.3?s="active":g>.1?s="idle":s="maintenance"}else if(w>60){const g=Math.random();g>.5?s="active":g>.2?s="idle":g>.05?s="renting":s="maintenance"}else{const g=Math.random();g>.6?s="idle":g>.3?s="active":g>.1?s="maintenance":s="renting"}let i;F>=80?i="normal":F>=60?i="warning":i="urgent";const k=Math.round(Math.max(0,Math.min(100,(100-F)*.6+w*.3+O(-10,10))));let M;if(["华东","华南","华北"].includes(b)){const g=Math.random();g>.6?M="5G":g>.3?M="WiFi":g>.1?M="4G":M="Ethernet"}else{const g=Math.random();g>.7?M="4G":g>.4?M="WiFi":g>.2?M="5G":M="Ethernet"}const x=new Date(Date.now()-$(7,90)*24*60*60*1e3),X=new Date(x.getTime()+(i==="urgent"?7:i==="warning"?30:90)*24*60*60*1e3);v.push({deviceId:`YX-${String(c).padStart(4,"0")}`,deviceModel:p,utilizationRate:w,totalRentalDays:U,totalAvailableDays:365,currentStatus:s,lastRentalDate:w>20?new Date(Date.now()-$(1,60)*24*60*60*1e3).toISOString().slice(0,10):void 0,signalStrength:s==="active"||s==="renting"?j:void 0,performanceScore:F,region:b,maintenanceStatus:i,predictedFailureRisk:k,networkType:s==="active"||s==="renting"?M:void 0,lastMaintenanceDate:x.toISOString().slice(0,10),nextMaintenanceDate:X.toISOString().slice(0,10)})}return v.sort((c,h)=>h.utilizationRate-c.utilizationRate)}static generateRentalOrders(n=200){const r=["YX-Robot-Pro","YX-Robot-Standard","YX-Robot-Lite"],v=["租赁宝","设备租","智能租赁","机器人租赁平台","科技设备租"],c=["pending","active","expired","returned","cancelled"],h=["张三","李四","王五","赵六","钱七","孙八","周九","吴十","郑十一","王十二","冯十三","陈十四","褚十五","卫十六"],p=[];for(let b=1;b<=n;b++){const d=$(7,90),S=O(80,300),R=d*S,z=new Date(Date.now()-$(0,180)*24*60*60*1e3),Y=new Date(z.getTime()+d*24*60*60*1e3);p.push({id:b,orderNumber:`R${new Date().getFullYear()}${String(b).padStart(6,"0")}`,customerId:$(1,100),customerName:h[$(0,h.length-1)],customerPhone:`1${$(3,9)}${String($(1e7,99999999))}`,deviceModel:r[$(0,r.length-1)],deviceId:`YX-${String($(1,500)).padStart(4,"0")}`,rentalPeriod:d,dailyRate:S,totalAmount:R,platform:v[$(0,v.length-1)],status:c[$(0,c.length-1)],startDate:z.toISOString().slice(0,10),endDate:Y.toISOString().slice(0,10),createdAt:new Date(z.getTime()-$(1,7)*24*60*60*1e3).toISOString(),updatedAt:new Date().toISOString()})}return p.sort((b,d)=>new Date(d.createdAt).getTime()-new Date(b.createdAt).getTime())}static generateRentalRevenueAnalysis(){const n=["YX-Robot-Pro","YX-Robot-Standard","YX-Robot-Lite","YX-Robot-Mini"],r=["华北","华东","华南","华中","西南","西北","东北","华西"],v=$(18e5,28e5),c=$(2200,3500),h=Math.round(v/c),p=[.35,.28,.22,.15],b=n.map((R,z)=>{const Y=p[z],I=Math.round(v*Y*O(.8,1.2)),U=Math.round(c*Y*O(.8,1.2));let w=75;switch(R){case"YX-Robot-Pro":w=85;break;case"YX-Robot-Standard":w=78;break;case"YX-Robot-Lite":w=72;break;case"YX-Robot-Mini":w=65;break}return{deviceModel:R,revenue:I,orderCount:U,utilizationRate:O(w-8,w+8)}}),d=[.18,.22,.16,.12,.1,.08,.09,.05],S=r.map((R,z)=>{const Y=d[z],I=Math.round(v*Y*O(.8,1.2)),U=Math.round(c*Y*O(.8,1.2)),w=Math.round(U/$(8,15));return{region:R,revenue:I,orderCount:U,deviceCount:w}});return{period:"2024年度",totalRevenue:v,orderCount:c,averageOrderValue:h,topPerformingDevices:b.sort((R,z)=>z.revenue-R.revenue),regionDistribution:S.sort((R,z)=>z.revenue-R.revenue)}}}const J=(a=500)=>new Promise(n=>setTimeout(n,a)),Q=(a,n=200,r="success")=>({code:n,message:r,data:a,timestamp:Date.now()}),se={getRentalStats(){return V(this,null,function*(){return yield J(),Q(ne.generateRentalStats())})},getRentalTrendData(a){return V(this,null,function*(){yield J();let n=30;switch(a==null?void 0:a.period){case"daily":n=7;break;case"weekly":n=28;break;case"monthly":n=365;break;case"quarterly":n=90;break;case"yearly":n=365;break}return Q(ne.generateRentalTrendData((a==null?void 0:a.period)||"monthly",n))})},getDeviceUtilizationData(a){return V(this,null,function*(){yield J();let n=ne.generateDeviceUtilizationData();return a!=null&&a.deviceModel&&(n=n.filter(r=>r.deviceModel===a.deviceModel)),a!=null&&a.status&&(n=n.filter(r=>r.currentStatus===a.status)),a!=null&&a.sortBy&&n.sort((r,v)=>{const c=r[a.sortBy],h=v[a.sortBy];return typeof c=="number"&&typeof h=="number"?a.sortOrder==="asc"?c-h:h-c:typeof c=="string"&&typeof h=="string"?a.sortOrder==="asc"?c.localeCompare(h):h.localeCompare(c):0}),Q(n)})},getRentalOrders(a){return V(this,null,function*(){yield J();let n=ne.generateRentalOrders(100);a!=null&&a.status&&(n=n.filter(d=>d.status===a.status)),a!=null&&a.deviceModel&&(n=n.filter(d=>d.deviceModel===a.deviceModel)),a!=null&&a.platform&&(n=n.filter(d=>d.platform.includes(a.platform))),a!=null&&a.keyword&&(n=n.filter(d=>d.orderNumber.includes(a.keyword)||d.customerName.includes(a.keyword)||d.customerPhone.includes(a.keyword)));const r=(a==null?void 0:a.page)||1,v=(a==null?void 0:a.pageSize)||10,c=n.length,h=(r-1)*v,p=h+v,b=n.slice(h,p);return Q({list:b,total:c,page:r,pageSize:v,totalPages:Math.ceil(c/v)})})},getRentalRevenueAnalysis(a){return V(this,null,function*(){return yield J(),Q(ne.generateRentalRevenueAnalysis())})},createRentalOrder(a){return V(this,null,function*(){yield J();const n=pe(he({id:Date.now(),orderNumber:`R${new Date().getFullYear()}${String(Date.now()).slice(-6)}`},a),{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});return Q(n)})},updateRentalOrder(a,n){return V(this,null,function*(){yield J();const r=pe(he({id:a},n),{updatedAt:new Date().toISOString()});return Q(r)})},deleteRentalOrder(a){return V(this,null,function*(){return yield J(),Q(null)})}},rt={key:0,class:"device-detail-content"},ct={class:"detail-section"},dt={class:"info-grid"},ut={class:"info-item"},vt={class:"value"},gt={class:"info-item"},ht={class:"info-item"},pt={class:"info-item"},ft={class:"value"},mt={class:"info-item"},bt={class:"value"},_t={class:"info-item"},yt={class:"value"},Dt={class:"info-item"},Rt={class:"value"},wt={class:"info-item"},Mt={class:"value"},St={class:"detail-section"},zt={class:"metrics-grid"},xt={class:"metric-card"},Ct={class:"metric-value"},$t={class:"metric-text"},kt={class:"metric-card"},Yt={class:"metric-value"},Xt={class:"metric-text"},Ot={class:"metric-card"},At={class:"metric-value"},Pt={class:"detail-section"},Tt={class:"detail-section"},Lt={class:"dialog-footer"},Vt=Se({__name:"DeviceDetailDialog",props:{modelValue:{type:Boolean},deviceData:{}},emits:["update:modelValue"],setup(a,{emit:n}){const r=a,v=n,c=le({get:()=>r.modelValue,set:s=>v("update:modelValue",s)}),h=C();let p=null;const b=C([{rentalDate:"2024-01-15",customerName:"张三",rentalDays:7,revenue:2800,status:"已完成"},{rentalDate:"2024-01-08",customerName:"李四",rentalDays:14,revenue:5600,status:"已完成"},{rentalDate:"2024-01-01",customerName:"王五",rentalDays:3,revenue:1200,status:"已完成"},{rentalDate:"2023-12-28",customerName:"赵六",rentalDays:10,revenue:4e3,status:"已完成"}]),d=s=>({"YX-Robot-Pro":"danger","YX-Robot-Standard":"primary","YX-Robot-Lite":"success","YX-Robot-Mini":"warning"})[s]||"info",S=s=>({active:"success",idle:"warning",maintenance:"info"})[s]||"info",R=s=>({active:"运行中",idle:"空闲",maintenance:"维护中"})[s]||s,z=s=>({normal:"success",warning:"warning",urgent:"danger"})[s]||"info",Y=s=>({normal:"正常",warning:"需关注",urgent:"需维护"})[s]||s,I=s=>s>=90?"#67c23a":s>=70?"#e6a23c":s>=50?"#f56c6c":"#909399",U=s=>s>=80?"#67c23a":s>=60?"#e6a23c":s>=40?"#f56c6c":"#909399",w=()=>V(null,null,function*(){var x;if(yield re(),!h.value)return;p=ie(h.value);const s=[],i=[],k=new Date;for(let X=29;X>=0;X--){const g=new Date(k);g.setDate(g.getDate()-X),s.push(`${g.getMonth()+1}/${g.getDate()}`);const B=((x=r.deviceData)==null?void 0:x.utilizationRate)||75,P=(Math.random()-.5)*20,te=Math.max(0,Math.min(100,B+P));i.push(Math.round(te))}const M={tooltip:{trigger:"axis",formatter:"{b}: {c}%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:s,axisLabel:{fontSize:11}},yAxis:{type:"value",max:100,axisLabel:{formatter:"{value}%"}},series:[{name:"利用率",type:"line",data:i,smooth:!0,itemStyle:{color:"#409eff"},lineStyle:{width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}]}}}]};p.setOption(M)});et(c,s=>{s&&r.deviceData&&re(()=>{w()})});const F=()=>{c.value=!1,p&&(p.dispose(),p=null)},j=()=>{console.log("导出设备详情:",r.deviceData)};return ze(()=>{p&&(p.dispose(),p=null)}),(s,i)=>{const k=T("el-tag"),M=T("el-progress"),x=T("el-table-column"),X=T("el-table"),g=T("el-button"),B=T("el-dialog");return ee(),xe(B,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=P=>c.value=P),title:"设备详情",width:"800px","before-close":F,class:"device-detail-dialog"},{footer:_(()=>[e("div",Lt,[l(g,{onClick:F},{default:_(()=>i[16]||(i[16]=[N("关闭",-1)])),_:1,__:[16]}),l(g,{type:"primary",onClick:j},{default:_(()=>i[17]||(i[17]=[N("导出详情",-1)])),_:1,__:[17]})])]),default:_(()=>[s.deviceData?(ee(),ve("div",rt,[e("div",ct,[i[9]||(i[9]=e("h3",{class:"section-title"},"基本信息",-1)),e("div",dt,[e("div",ut,[i[1]||(i[1]=e("span",{class:"label"},"设备ID:",-1)),e("span",vt,y(s.deviceData.deviceId),1)]),e("div",gt,[i[2]||(i[2]=e("span",{class:"label"},"设备型号:",-1)),l(k,{type:d(s.deviceData.deviceModel),size:"small"},{default:_(()=>[N(y(s.deviceData.deviceModel),1)]),_:1},8,["type"])]),e("div",ht,[i[3]||(i[3]=e("span",{class:"label"},"当前状态:",-1)),l(k,{type:S(s.deviceData.currentStatus),size:"small"},{default:_(()=>[N(y(R(s.deviceData.currentStatus)),1)]),_:1},8,["type"])]),e("div",pt,[i[4]||(i[4]=e("span",{class:"label"},"利用率:",-1)),e("span",ft,y(s.deviceData.utilizationRate)+"%",1)]),e("div",mt,[i[5]||(i[5]=e("span",{class:"label"},"租赁天数:",-1)),e("span",bt,y(s.deviceData.totalRentalDays)+"天",1)]),e("div",_t,[i[6]||(i[6]=e("span",{class:"label"},"可用天数:",-1)),e("span",yt,y(s.deviceData.totalAvailableDays)+"天",1)]),e("div",Dt,[i[7]||(i[7]=e("span",{class:"label"},"最后租赁:",-1)),e("span",Rt,y(s.deviceData.lastRentalDate||"暂无"),1)]),e("div",wt,[i[8]||(i[8]=e("span",{class:"label"},"所在地区:",-1)),e("span",Mt,y(s.deviceData.region||"未知"),1)])])]),e("div",St,[i[13]||(i[13]=e("h3",{class:"section-title"},"性能指标",-1)),e("div",zt,[e("div",xt,[i[10]||(i[10]=e("div",{class:"metric-title"},"设备健康度",-1)),e("div",Ct,[l(M,{percentage:s.deviceData.performanceScore||85,color:I(s.deviceData.performanceScore||85),"stroke-width":8},null,8,["percentage","color"]),e("span",$t,y(s.deviceData.performanceScore||85)+"分",1)])]),e("div",kt,[i[11]||(i[11]=e("div",{class:"metric-title"},"信号强度",-1)),e("div",Yt,[l(M,{percentage:s.deviceData.signalStrength||78,color:U(s.deviceData.signalStrength||78),"stroke-width":8},null,8,["percentage","color"]),e("span",Xt,y(s.deviceData.signalStrength||78)+"%",1)])]),e("div",Ot,[i[12]||(i[12]=e("div",{class:"metric-title"},"维护状态",-1)),e("div",At,[l(k,{type:z(s.deviceData.maintenanceStatus||"normal"),size:"large"},{default:_(()=>[N(y(Y(s.deviceData.maintenanceStatus||"normal")),1)]),_:1},8,["type"])])])])]),e("div",Pt,[i[14]||(i[14]=e("h3",{class:"section-title"},"利用率趋势（最近30天）",-1)),e("div",{ref_key:"utilizationTrendChart",ref:h,class:"trend-chart"},null,512)]),e("div",Tt,[i[15]||(i[15]=e("h3",{class:"section-title"},"最近租赁记录",-1)),l(X,{data:b.value,size:"small","max-height":"200"},{default:_(()=>[l(x,{prop:"rentalDate",label:"租赁日期",width:"100"}),l(x,{prop:"customerName",label:"客户",width:"120"}),l(x,{prop:"rentalDays",label:"租赁天数",width:"80",align:"center"}),l(x,{prop:"revenue",label:"收入",width:"100",align:"right"},{default:_(({row:P})=>[N(" ¥"+y(P.revenue.toLocaleString()),1)]),_:1}),l(x,{prop:"status",label:"状态",width:"80",align:"center"},{default:_(({row:P})=>[l(k,{type:P.status==="已完成"?"success":"warning",size:"small"},{default:_(()=>[N(y(P.status),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])])):tt("",!0)]),_:1},8,["modelValue"])}}}),It=Ce(Vt,[["__scopeId","data-v-ed95e62f"]]),Ut={class:"rental-analytics"},Nt={class:"metrics-cards"},Ft={class:"metric-card revenue-card"},Bt={class:"card-content"},Et={class:"card-value"},Gt={class:"card-change positive"},Wt={class:"change-text"},jt={class:"metric-card devices-card"},Ht={class:"card-content"},qt={class:"card-value"},Kt={class:"card-change positive"},Jt={class:"change-text"},Qt={class:"metric-card utilization-card"},Zt={class:"card-content"},ea={class:"card-value"},ta={class:"card-change positive"},aa={class:"metric-card period-card"},oa={class:"card-content"},na={class:"card-value"},sa={class:"card-change positive"},ia={class:"main-content"},la={class:"left-content"},ra={class:"charts-section"},ca={class:"charts-row"},da={class:"chart-card rental-trend-card"},ua={class:"chart-header"},va={class:"header-right"},ga={class:"chart-content"},ha={class:"chart-card utilization-ranking-card"},pa={class:"chart-content"},fa={class:"charts-row"},ma={class:"chart-card region-distribution-card"},ba={class:"chart-content"},_a={class:"chart-card device-model-card"},ya={class:"chart-content"},Da={class:"device-utilization-section"},Ra={class:"table-controls"},wa={class:"controls-left"},Ma={class:"controls-right"},Sa={class:"utilization-cell"},za={class:"rate-text"},xa={class:"pagination-wrapper"},Ca={class:"right-sidebar"},$a={class:"sidebar-card"},ka={class:"card-content"},Ya={class:"overview-item"},Xa={class:"value"},Oa={class:"overview-item"},Aa={class:"value"},Pa={class:"overview-item"},Ta={class:"value"},La={class:"overview-item"},Va={class:"value"},Ia={class:"sidebar-card"},Ua={class:"card-content"},Na={class:"status-item"},Fa={class:"count"},Ba={class:"status-item"},Ea={class:"count"},Ga={class:"status-item"},Wa={class:"count"},ja={class:"sidebar-card"},Ha={class:"card-content"},qa={class:"rank"},Ka={class:"device-info"},Ja={class:"device-id"},Qa={class:"device-model"},Za={class:"utilization"},eo=Se({__name:"RentalAnalytics",setup(a){C(["2024-01-01","2024-01-31"]),C(!1);const n=C(!1),r=C("monthly"),v=C(""),c=C(""),h=C(""),p=C(1),b=C(20),d=C(!1),S=C(null),R=C({revenue:45680,orders:23,activeDevices:198,avgUtilization:78.5}),z=le(()=>{const o={active:0,idle:0,maintenance:0};return B.value.forEach(t=>{o[t.currentStatus]++}),o}),Y=le(()=>B.value.slice().sort((o,t)=>t.utilizationRate-o.utilizationRate).slice(0,5)),I=le(()=>{let o=B.value;if(v.value&&(o=o.filter(t=>t.deviceModel===v.value)),c.value&&(o=o.filter(t=>t.currentStatus===c.value)),h.value){const t=h.value.toLowerCase();o=o.filter(f=>f.deviceId.toLowerCase().includes(t)||f.deviceModel.toLowerCase().includes(t))}return o}),U=le(()=>{const o=(p.value-1)*b.value,t=o+b.value;return I.value.slice(o,t)}),w=C(),F=C(),j=C(),s=C();let i=null,k=null,M=null,x=null;const X=C(null),g=C([]),B=C([]),P=C(null);let te=null;const $e=()=>{te&&clearTimeout(te),te=setTimeout(()=>{ge()},300)},ke=()=>V(null,null,function*(){try{const o=yield se.getRentalTrendData({period:r.value});g.value=o.data,me()}catch(o){console.error("加载趋势数据失败:",o)}}),ge=()=>V(null,null,function*(){p.value=1}),Ye=()=>V(null,null,function*(){console.log("🔄 开始加载租赁分析数据...");try{fe();const[o,t,f,u]=yield Promise.all([se.getRentalStats(),se.getRentalTrendData({period:r.value}),se.getDeviceUtilizationData({}),se.getRentalRevenueAnalysis({})]);o&&o.data&&(X.value=o.data,console.log("📊 租赁统计数据加载成功:",X.value)),t&&t.data&&(g.value=t.data,console.log("📈 趋势数据加载成功，数据点数量:",g.value.length)),f&&f.data&&(B.value=f.data,console.log("🔧 设备数据加载成功，设备数量:",B.value.length)),u&&u.data&&(P.value=u.data,console.log("💰 收入分析数据加载成功:",P.value))}catch(o){console.error("❌ 加载数据失败，使用默认数据:",o),X.value||fe()}yield re();try{je(),console.log("✅ 租赁分析数据和图表更新完成")}catch(o){console.error("❌ 图表更新失败:",o)}}),fe=()=>{console.log("📊 设置默认租赁数据..."),X.value={totalRentalRevenue:1285420,totalRentalDevices:285,activeRentalDevices:198,deviceUtilizationRate:78.5,averageRentalPeriod:32,totalRentalOrders:1456,revenueGrowthRate:18.6,deviceGrowthRate:12.3};const o=[],t=[],f=[],u=new Date;for(let L=29;L>=0;L--){const G=new Date(u);G.setDate(G.getDate()-L),o.push(G.toISOString().slice(0,10));const Z=35e3+Math.sin(L*.1)*8e3+Math.random()*5e3,ae=45+Math.sin(L*.15)*15+Math.random()*10;t.push(Math.floor(Z)),f.push(Math.floor(ae))}g.value=o.map((L,G)=>({date:L,revenue:t[G],orderCount:f[G],deviceCount:Math.floor(Math.random()*50)+150,utilizationRate:Math.floor(Math.random()*30)+60}));const D=["YX-Robot-Pro","YX-Robot-Standard","YX-Robot-Lite","YX-Robot-Mini"],E=["active","idle","maintenance"],A=["华东","华北","华南","华中","西南","西北","东北","华西"],H=["normal","warning","urgent"],ce=[];for(let L=1;L<=50;L++){const Z=Math.floor(Math.random()*250)+50,ae=Math.floor(Z/365*100),oe=D[Math.floor(Math.random()*D.length)];let q=85,K=78;switch(oe){case"YX-Robot-Pro":q=90,K=85;break;case"YX-Robot-Standard":q=85,K=80;break;case"YX-Robot-Lite":q=80,K=75;break;case"YX-Robot-Mini":q=75,K=70;break}ce.push({deviceId:`YX-${String(L).padStart(4,"0")}`,deviceModel:oe,utilizationRate:ae,totalRentalDays:Z,totalAvailableDays:365,currentStatus:E[Math.floor(Math.random()*E.length)],lastRentalDate:Math.random()>.2?new Date(Date.now()-Math.floor(Math.random()*30)*24*60*60*1e3).toISOString().slice(0,10):void 0,region:A[Math.floor(Math.random()*A.length)],performanceScore:Math.floor(q+(Math.random()-.5)*20),signalStrength:Math.floor(K+(Math.random()-.5)*30),maintenanceStatus:H[Math.floor(Math.random()*H.length)]})}B.value=ce.sort((L,G)=>G.utilizationRate-L.utilizationRate),P.value={period:"2024年度",totalRevenue:245e4,orderCount:2800,averageOrderValue:875,topPerformingDevices:[{deviceModel:"YX-Robot-Pro",revenue:857500,orderCount:980,utilizationRate:85.2},{deviceModel:"YX-Robot-Standard",revenue:686e3,orderCount:784,utilizationRate:78.6},{deviceModel:"YX-Robot-Lite",revenue:539e3,orderCount:616,utilizationRate:72.1},{deviceModel:"YX-Robot-Mini",revenue:367500,orderCount:420,utilizationRate:65.8}],regionDistribution:[{region:"华东",revenue:539e3,orderCount:616,deviceCount:85},{region:"华北",revenue:441e3,orderCount:504,deviceCount:72},{region:"华南",revenue:392e3,orderCount:448,deviceCount:68},{region:"华中",revenue:294e3,orderCount:336,deviceCount:52},{region:"西南",revenue:245e3,orderCount:280,deviceCount:45},{region:"西北",revenue:196e3,orderCount:224,deviceCount:38},{region:"东北",revenue:220500,orderCount:252,deviceCount:42},{region:"华西",revenue:122500,orderCount:140,deviceCount:28}]},console.log("✅ 默认租赁数据设置完成")},Xe=o=>o>=80?"#67c23a":o>=60?"#e6a23c":o>=40?"#f56c6c":"#909399",Oe=o=>({active:"success",idle:"warning",maintenance:"info"})[o]||"info",Ae=o=>({active:"运行中",idle:"空闲",maintenance:"维护中"})[o]||o,Pe=o=>({"YX-Robot-Pro":"danger","YX-Robot-Standard":"primary","YX-Robot-Lite":"success","YX-Robot-Mini":"warning"})[o]||"info",Te=o=>{b.value=o,p.value=1},Le=o=>{p.value=o},Ve=o=>{console.log("查看设备详情:",o),S.value=o,d.value=!0},Ie=()=>{if(!w.value)return;i=ie(w.value);const o={tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(t){let f=`${t[0].name}<br/>`;return t.forEach(u=>{u.seriesName==="租赁收入"?f+=`${u.seriesName}: ¥${u.value.toLocaleString()}<br/>`:u.seriesName==="订单数量"?f+=`${u.seriesName}: ${u.value}个<br/>`:f+=`${u.seriesName}: ${u.value}%<br/>`}),f}},legend:{data:["租赁收入","订单数量","设备利用率"],top:10},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:[],axisLabel:{rotate:45,fontSize:11}},yAxis:[{type:"value",name:"收入(元)",position:"left",axisLabel:{formatter:function(t){return t>=1e4?(t/1e4).toFixed(1)+"w":t.toString()}}},{type:"value",name:"订单数/利用率",position:"right",max:100}],series:[{name:"租赁收入",type:"line",yAxisIndex:0,data:[],smooth:!0,itemStyle:{color:"#5470c6"},lineStyle:{width:3}},{name:"订单数量",type:"bar",yAxisIndex:1,data:[],itemStyle:{color:"#91cc75",opacity:.8}},{name:"设备利用率",type:"line",yAxisIndex:1,data:[],smooth:!0,itemStyle:{color:"#fac858"},lineStyle:{width:2,type:"dashed"}}]};i.setOption(o)},me=()=>{if(!i||!g.value.length)return;const o=g.value.map(D=>{const E=new Date(D.date);return`${E.getMonth()+1}/${E.getDate()}`}),t=g.value.map(D=>D.revenue),f=g.value.map(D=>D.orderCount),u=g.value.map(D=>D.utilizationRate);i.setOption({xAxis:{data:o},series:[{data:t},{data:f},{data:u}]})},Ue=()=>{if(!F.value)return;k=ie(F.value);const o={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){const f=t[0];return`${f.name}<br/>利用率: ${f.value}%`}},grid:{left:"25%",right:"8%",bottom:"3%",top:"3%",containLabel:!1},xAxis:{type:"value",max:100,axisLabel:{formatter:"{value}%"}},yAxis:{type:"category",data:[],axisLabel:{fontSize:11,width:120,overflow:"truncate"}},series:[{name:"利用率",type:"bar",data:[],barWidth:"60%",itemStyle:{borderRadius:[0,4,4,0]},label:{show:!0,position:"right",formatter:"{c}%",fontSize:11}}]};k.setOption(o)},Ne=()=>{if(!j.value)return;M=ie(j.value);const o={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"地区分布",type:"pie",radius:["40%","70%"],center:["60%","50%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,formatter:"{b}: {c}"}}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272"]};M.setOption(o)},Fe=()=>{if(!s.value)return;x=ie(s.value);const o={tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["租赁数量","收入贡献"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[]},yAxis:[{type:"value",name:"数量",position:"left"},{type:"value",name:"收入(万元)",position:"right"}],series:[{name:"租赁数量",type:"bar",yAxisIndex:0,data:[],itemStyle:{color:"#5470c6"}},{name:"收入贡献",type:"line",yAxisIndex:1,data:[],smooth:!0,itemStyle:{color:"#91cc75"}}]};x.setOption(o)},Be=()=>{if(!k||!B.value.length)return;const o=B.value.sort((u,D)=>D.utilizationRate-u.utilizationRate).slice(0,12),t=o.map(u=>`${u.deviceId} (${u.deviceModel})`),f=o.map(u=>u.utilizationRate);k.setOption({yAxis:{data:t,axisLabel:{fontSize:11,width:120,overflow:"truncate"}},series:[{data:f,itemStyle:{color:function(u){const D=u.value;return D>=85?"#52c41a":D>=70?"#1890ff":D>=50?"#faad14":"#f5222d"}}}]})},Ee=()=>{if(!M||!P.value)return;const o=P.value.regionDistribution.map(t=>({name:t.region,value:t.deviceCount,revenue:t.revenue,orderCount:t.orderCount}));M.setOption({tooltip:{trigger:"item",formatter:function(t){const f=t.data;return`${t.name}<br/>
                设备数量: ${f.value}台<br/>
                租赁收入: ¥${(f.revenue/1e4).toFixed(1)}万<br/>
                订单数量: ${f.orderCount}个<br/>
                占比: ${t.percent}%`}},series:[{data:o,label:{show:!0,formatter:"{b}: {c}台"}}]})},Ge=()=>{if(!x||!P.value)return;const o=P.value.topPerformingDevices,t=o.map(D=>D.deviceModel),f=o.map(D=>D.orderCount),u=o.map(D=>Math.round(D.revenue/1e4));x.setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(D){let E=`${D[0].name}<br/>`;return D.forEach(A=>{A.seriesName==="订单数量"?E+=`${A.seriesName}: ${A.value}个<br/>`:E+=`${A.seriesName}: ${A.value}万元<br/>`}),E}},xAxis:{data:t,axisLabel:{rotate:15,fontSize:11}},series:[{name:"订单数量",data:f,itemStyle:{color:"#5470c6"}},{name:"收入贡献",data:u,itemStyle:{color:"#91cc75"}}]})},We=()=>V(null,null,function*(){yield re();try{console.log("📊 开始初始化图表..."),w.value?(Ie(),console.log("✅ 租赁趋势图表初始化完成")):console.warn("⚠️ 租赁趋势图表DOM元素未找到"),F.value?(Ue(),console.log("✅ 设备利用率排行图表初始化完成")):console.warn("⚠️ 设备利用率排行图表DOM元素未找到"),j.value?(Ne(),console.log("✅ 地区分布图表初始化完成")):console.warn("⚠️ 地区分布图表DOM元素未找到"),s.value?(Fe(),console.log("✅ 设备型号分析图表初始化完成")):console.warn("⚠️ 设备型号分析图表DOM元素未找到"),console.log("📊 所有图表初始化完成")}catch(o){console.error("❌ 图表初始化过程中出错:",o)}}),je=()=>{try{console.log("📊 开始更新图表数据..."),me(),console.log("✅ 租赁趋势图表数据更新完成"),Be(),console.log("✅ 设备利用率排行图表数据更新完成"),Ee(),console.log("✅ 地区分布图表数据更新完成"),Ge(),console.log("✅ 设备型号分析图表数据更新完成"),console.log("📊 所有图表数据更新完成")}catch(o){console.error("❌ 图表数据更新过程中出错:",o)}},be=()=>{i==null||i.resize(),k==null||k.resize(),M==null||M.resize(),x==null||x.resize()};return at(()=>V(null,null,function*(){console.log("🚀 租赁分析页面开始初始化..."),yield re();try{We(),console.log("📊 图表初始化完成")}catch(o){console.error("❌ 图表初始化失败:",o)}yield Ye(),window.addEventListener("resize",be),console.log("✅ 租赁分析页面初始化完成")})),ze(()=>{i==null||i.dispose(),k==null||k.dispose(),M==null||M.dispose(),x==null||x.dispose(),window.removeEventListener("resize",be)}),(o,t)=>{var oe,q,K,_e,ye,De;const f=T("el-icon"),u=T("el-option"),D=T("el-select"),E=T("el-input"),A=T("el-table-column"),H=T("el-tag"),ce=T("el-progress"),L=T("el-button"),G=T("el-table"),Z=T("el-pagination"),ae=ot("loading");return ee(),ve("div",Ut,[t[32]||(t[32]=e("div",{class:"page-header"},[e("div",{class:"header-left"},[e("h2",null,"租赁数据分析"),e("p",{class:"header-subtitle"},"租赁业务数据分析 · 练字机器人管理系统")])],-1)),e("div",Nt,[e("div",Ft,[e("div",Bt,[t[8]||(t[8]=e("div",{class:"card-title"},"租赁总收入",-1)),e("div",Et,[t[7]||(t[7]=e("span",{class:"currency"},"¥",-1)),l(W(ue),{value:((oe=X.value)==null?void 0:oe.totalRentalRevenue)||0,decimals:2,class:"value-number"},null,8,["value"])]),e("div",Gt,[l(f,{class:"change-icon"},{default:_(()=>[l(W(de))]),_:1}),e("span",Wt,"+"+y(((q=X.value)==null?void 0:q.revenueGrowthRate)||0)+"%",1)])])]),e("div",jt,[e("div",Ht,[t[9]||(t[9]=e("div",{class:"card-title"},"租赁设备数",-1)),e("div",qt,[l(W(ue),{value:((K=X.value)==null?void 0:K.totalRentalDevices)||0,decimals:0,class:"value-number"},null,8,["value"])]),e("div",Kt,[l(f,{class:"change-icon"},{default:_(()=>[l(W(de))]),_:1}),e("span",Jt,"+"+y(((_e=X.value)==null?void 0:_e.deviceGrowthRate)||0)+"%",1)])])]),e("div",Qt,[e("div",Zt,[t[12]||(t[12]=e("div",{class:"card-title"},"设备利用率",-1)),e("div",ea,[l(W(ue),{value:((ye=X.value)==null?void 0:ye.deviceUtilizationRate)||0,decimals:1,class:"value-number"},null,8,["value"]),t[10]||(t[10]=e("span",{class:"unit"},"%",-1))]),e("div",ta,[l(f,{class:"change-icon"},{default:_(()=>[l(W(de))]),_:1}),t[11]||(t[11]=e("span",{class:"change-text"},"+2.3%",-1))])])]),e("div",aa,[e("div",oa,[t[15]||(t[15]=e("div",{class:"card-title"},"平均租期",-1)),e("div",na,[l(W(ue),{value:((De=X.value)==null?void 0:De.averageRentalPeriod)||0,decimals:0,class:"value-number"},null,8,["value"]),t[13]||(t[13]=e("span",{class:"unit"},"天",-1))]),e("div",sa,[l(f,{class:"change-icon"},{default:_(()=>[l(W(de))]),_:1}),t[14]||(t[14]=e("span",{class:"change-text"},"+1.8天",-1))])])])]),e("div",ia,[e("div",la,[e("div",ra,[e("div",ca,[e("div",da,[e("div",ua,[t[16]||(t[16]=e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"租赁趋势分析"),e("p",{class:"chart-subtitle"},"租赁收入和订单数量趋势")],-1)),e("div",va,[l(D,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=m=>r.value=m),onChange:ke,size:"small"},{default:_(()=>[l(u,{label:"最近7天",value:"daily"}),l(u,{label:"最近4周",value:"weekly"}),l(u,{label:"最近12月",value:"monthly"}),l(u,{label:"最近4季度",value:"quarterly"})]),_:1},8,["modelValue"])])]),e("div",ga,[e("div",{ref_key:"rentalTrendChart",ref:w,class:"chart-container",style:{height:"300px"}},null,512)])]),e("div",ha,[t[17]||(t[17]=e("div",{class:"chart-header"},[e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"设备利用率排行"),e("p",{class:"chart-subtitle"},"各设备利用率对比")])],-1)),e("div",pa,[e("div",{ref_key:"utilizationRankingChart",ref:F,class:"chart-container",style:{height:"300px"}},null,512)])])]),e("div",fa,[e("div",ma,[t[18]||(t[18]=e("div",{class:"chart-header"},[e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"地区分布"),e("p",{class:"chart-subtitle"},"各地区租赁业务分布")])],-1)),e("div",ba,[e("div",{ref_key:"regionDistributionChart",ref:j,class:"chart-container",style:{height:"300px"}},null,512)])]),e("div",_a,[t[19]||(t[19]=e("div",{class:"chart-header"},[e("div",{class:"header-left"},[e("h3",{class:"chart-title"},"设备型号分析"),e("p",{class:"chart-subtitle"},"各型号设备租赁表现")])],-1)),e("div",ya,[e("div",{ref_key:"deviceModelChart",ref:s,class:"chart-container",style:{height:"300px"}},null,512)])])])]),e("div",Da,[t[21]||(t[21]=e("div",{class:"section-header"},[e("h3",null,"设备利用率详情"),e("p",null,"各设备的详细利用率数据")],-1)),e("div",Ra,[e("div",wa,[l(D,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=m=>v.value=m),placeholder:"设备型号",clearable:"",onChange:ge},{default:_(()=>[l(u,{label:"全部型号",value:""}),l(u,{label:"YX-Robot-Pro",value:"YX-Robot-Pro"}),l(u,{label:"YX-Robot-Standard",value:"YX-Robot-Standard"}),l(u,{label:"YX-Robot-Lite",value:"YX-Robot-Lite"}),l(u,{label:"YX-Robot-Mini",value:"YX-Robot-Mini"})]),_:1},8,["modelValue"]),l(D,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=m=>c.value=m),placeholder:"设备状态",clearable:"",onChange:ge},{default:_(()=>[l(u,{label:"全部状态",value:""}),l(u,{label:"运行中",value:"active"}),l(u,{label:"空闲",value:"idle"}),l(u,{label:"维护中",value:"maintenance"})]),_:1},8,["modelValue"])]),e("div",Ma,[l(E,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=m=>h.value=m),placeholder:"搜索设备ID","prefix-icon":W(Ze),clearable:"",onInput:$e,style:{width:"200px"}},null,8,["modelValue","prefix-icon"])])]),nt((ee(),xe(G,{data:U.value,stripe:"",height:"400"},{default:_(()=>[l(A,{prop:"deviceId",label:"设备ID",width:"120"}),l(A,{prop:"deviceModel",label:"设备型号",width:"150"},{default:_(({row:m})=>[l(H,{size:"small",type:Pe(m.deviceModel)},{default:_(()=>[N(y(m.deviceModel),1)]),_:2},1032,["type"])]),_:1}),l(A,{prop:"utilizationRate",label:"利用率",width:"140"},{default:_(({row:m})=>[e("div",Sa,[e("span",za,y(m.utilizationRate)+"%",1),l(ce,{percentage:m.utilizationRate,"stroke-width":6,"show-text":!1,color:Xe(m.utilizationRate)},null,8,["percentage","color"])])]),_:1}),l(A,{prop:"totalRentalDays",label:"租赁天数",width:"100",align:"center"}),l(A,{prop:"totalAvailableDays",label:"可用天数",width:"100",align:"center"}),l(A,{prop:"currentStatus",label:"当前状态",width:"100",align:"center"},{default:_(({row:m})=>[l(H,{type:Oe(m.currentStatus),size:"small"},{default:_(()=>[N(y(Ae(m.currentStatus)),1)]),_:2},1032,["type"])]),_:1}),l(A,{prop:"lastRentalDate",label:"最后租赁日期",width:"120",align:"center"},{default:_(({row:m})=>[N(y(m.lastRentalDate||"-"),1)]),_:1}),l(A,{label:"操作",width:"120",align:"center"},{default:_(({row:m})=>[l(L,{text:"",type:"primary",size:"small",onClick:Re=>Ve(m)},{default:_(()=>t[20]||(t[20]=[N(" 查看详情 ",-1)])),_:2,__:[20]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,n.value]]),e("div",xa,[l(Z,{"current-page":p.value,"onUpdate:currentPage":t[4]||(t[4]=m=>p.value=m),"page-size":b.value,"onUpdate:pageSize":t[5]||(t[5]=m=>b.value=m),"page-sizes":[10,20,50,100],total:I.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Te,onCurrentChange:Le},null,8,["current-page","page-size","total"])])])]),e("div",Ca,[e("div",$a,[t[26]||(t[26]=e("div",{class:"card-header"},[e("h4",null,"今日概览")],-1)),e("div",ka,[e("div",Ya,[t[22]||(t[22]=e("span",{class:"label"},"今日收入",-1)),e("span",Xa,"¥"+y(R.value.revenue.toLocaleString()),1)]),e("div",Oa,[t[23]||(t[23]=e("span",{class:"label"},"新增订单",-1)),e("span",Aa,y(R.value.orders)+"个",1)]),e("div",Pa,[t[24]||(t[24]=e("span",{class:"label"},"活跃设备",-1)),e("span",Ta,y(R.value.activeDevices)+"台",1)]),e("div",La,[t[25]||(t[25]=e("span",{class:"label"},"平均利用率",-1)),e("span",Va,y(R.value.avgUtilization)+"%",1)])])]),e("div",Ia,[t[30]||(t[30]=e("div",{class:"card-header"},[e("h4",null,"设备状态")],-1)),e("div",Ua,[e("div",Na,[l(H,{type:"success",size:"small"},{default:_(()=>t[27]||(t[27]=[N("运行中",-1)])),_:1,__:[27]}),e("span",Fa,y(z.value.active)+"台",1)]),e("div",Ba,[l(H,{type:"warning",size:"small"},{default:_(()=>t[28]||(t[28]=[N("空闲",-1)])),_:1,__:[28]}),e("span",Ea,y(z.value.idle)+"台",1)]),e("div",Ga,[l(H,{type:"info",size:"small"},{default:_(()=>t[29]||(t[29]=[N("维护中",-1)])),_:1,__:[29]}),e("span",Wa,y(z.value.maintenance)+"台",1)])])]),e("div",ja,[t[31]||(t[31]=e("div",{class:"card-header"},[e("h4",null,"利用率TOP5")],-1)),e("div",Ha,[(ee(!0),ve(st,null,it(Y.value,(m,Re)=>(ee(),ve("div",{key:m.deviceId,class:"ranking-item"},[e("div",qa,y(Re+1),1),e("div",Ka,[e("div",Ja,y(m.deviceId),1),e("div",Qa,y(m.deviceModel),1)]),e("div",Za,y(m.utilizationRate)+"%",1)]))),128))])])])]),l(It,{modelValue:d.value,"onUpdate:modelValue":t[6]||(t[6]=m=>d.value=m),"device-data":S.value},null,8,["modelValue","device-data"])])}}}),go=Ce(eo,[["__scopeId","data-v-e519c4b8"]]);export{go as default};
