# Admin Business - 销售数据模块需求文档

## 🚨 核心需求要求（强制执行）

### ⚠️ 前端页面与数据库数据完全绑定规范

**本需求文档的核心要求是实现前端页面与数据库数据的完全绑定，确保使用真实数据，并能在前端页面正常显示：**

#### 🔥 前端数据展示强制要求

1. **数据来源要求**：
   - ✅ **必须使用**：通过API接口从数据库获取的真实数据
   - ❌ **严禁使用**：在Vue组件中硬编码的模拟数据
   - ❌ **严禁使用**：在constants文件中定义的静态假数据
   - ❌ **严禁使用**：任何形式的mock数据或示例数据

2. **Vue数据绑定要求**：
   - 所有页面数据必须通过`reactive`或`ref`进行响应式绑定
   - 数据必须通过API调用动态加载，不能预设静态值
   - 页面加载时必须调用对应的API接口获取数据
   - 数据更新后必须重新调用API刷新页面显示

#### 🚨 字段映射一致性要求（最高优先级）

项目开发过程中前端使用的字段名和后端的字段名要匹配，字段映射要正确：

1. **四层数据结构映射**：
   - 数据库表字段 (snake_case) ↔ Java实体类属性 (camelCase)
   - Java实体类属性 (camelCase) ↔ MyBatis XML映射 (column/property)
   - 后端API响应 (camelCase) ↔ 前端TypeScript接口 (camelCase)
   - 前端页面字段 (camelCase) ↔ API调用参数 (camelCase)

2. **字段映射验证要求**：
   - 数据库字段命名使用snake_case：`sales_amount`、`order_date`、`customer_id`
   - Java实体类属性使用camelCase：`salesAmount`、`orderDate`、`customerId`
   - MyBatis映射正确：`<result column="sales_amount" property="salesAmount"/>`
   - 前端接口一致：`salesAmount: number`、`orderDate: string`、`customerId: number`

3. **字段映射检查清单**：
   - [ ] 数据库表结构与Java实体类字段完全对应
   - [ ] MyBatis XML映射文件column和property正确匹配
   - [ ] 前端TypeScript接口与后端DTO字段名称一致
   - [ ] API请求响应参数在前后端保持统一命名
   - [ ] 枚举值在数据库、后端、前端三层完全一致

## 介绍

销售数据模块是 YXRobot 管理后台业务管理模块的核心功能，为管理员提供销售数据的全面管理和分析。该模块需要开发完整的前后端功能，包含销售数据录入、查询、统计分析、图表展示等功能，访问地址为 http://localhost:8081/admin/business/sales。

**核心技术实现要求:**

1. **严禁使用模拟数据**: 
   - 前端页面不得使用任何硬编码的模拟数据，包括销售记录、统计数据、图表数据等
   - 后端不得在数据初始化时插入任何示例/模拟销售数据
   - 所有销售数据必须通过管理后台手动录入，确保数据的真实性

2. **API数据绑定**: 所有前端显示的数据必须通过HTTP API从后端获取

3. **数据库实时查询**: 后端API必须从MySQL数据库实时查询数据，不使用静态数据

4. **空数据状态处理**: 
   - 当数据库中没有销售数据时，页面应显示空状态提示
   - 空状态应引导用户录入第一条销售数据
   - 不得因为数据为空而显示模拟数据

5. **CRUD操作生效**: 所有的创建、编辑、删除操作都必须实际操作数据库并立即反映在前端页面上

6. **数据验证**: 
   - 系统启动时不得自动插入任何示例销售数据
   - 所有显示的销售数据必须来自真实的用户录入

**技术实现要求:**
- 前端Vue组件通过axios调用后端Spring Boot API
- 后端通过MyBatis查询MySQL数据库
- 数据传输格式完全匹配前后端接口定义
- **严格执行字段映射一致性**（数据库snake_case ↔ Java camelCase ↔ 前端camelCase）
- 后端DataInitializationService不得插入示例销售数据
- 前端组件必须正确处理空数据状态

**字段映射实施标准：**
```sql
-- 数据库表字段 (snake_case)
CREATE TABLE sales_records (
  id BIGINT PRIMARY KEY,
  sales_amount DECIMAL(10,2),
  order_date DATE,
  customer_id BIGINT
);
```

```java
// Java实体类属性 (camelCase)
public class SalesRecord {
  private Long id;
  private BigDecimal salesAmount;
  private LocalDate orderDate;
  private Long customerId;
}
```

```xml
<!-- MyBatis映射配置 -->
<result column="sales_amount" property="salesAmount"/>
<result column="order_date" property="orderDate"/>
<result column="customer_id" property="customerId"/>
```

```typescript
// 前端TypeScript接口 (camelCase)
interface SalesRecord {
  id: number;
  salesAmount: number;
  orderDate: string;
  customerId: number;
}
```

## 需求

### 需求 1

**用户故事:** 作为销售管理员，我希望能够查看销售数据管理页面的整体布局和导航，包括页面标题、描述和主要操作按钮，并且页面能够正常加载真实的数据库数据，以便快速了解页面功能和进行操作。

#### 验收标准

1. WHEN 用户访问销售数据管理页面 THEN 系统 SHALL 显示"销售数据管理"页面标题
2. WHEN 显示页面描述 THEN 系统 SHALL 显示"管理和分析销售数据，包括销售记录、统计分析和趋势图表"副标题
3. WHEN 页面加载 THEN 系统 SHALL 在页面右上角显示"录入销售数据"按钮
4. WHEN 页面布局 THEN 系统 SHALL 使用左右分布的头部布局方式
5. WHEN 页面初始化 THEN 系统 SHALL 通过后端API从数据库加载真实的销售数据，不使用任何前端模拟数据

### 需求 2

**用户故事:** 作为销售管理员，我希望能够通过筛选和搜索功能快速找到目标销售记录，包括按时间范围、产品类型、销售人员筛选和关键词搜索，并且所有筛选结果都基于数据库的真实查询，以便高效管理大量销售数据。

#### 验收标准

1. WHEN 用户查看筛选区域 THEN 系统 SHALL 显示搜索输入框、时间范围选择器、产品类型选择器、销售人员选择器
2. WHEN 用户输入搜索关键词 THEN 系统 SHALL 通过API调用数据库LIKE查询实时搜索客户名称或订单号并更新列表
3. WHEN 用户选择时间范围 THEN 系统 SHALL 基于数据库中实际的销售日期范围提供筛选
4. WHEN 用户选择产品类型筛选 THEN 系统 SHALL 从数据库products表动态加载产品类型选项，而不是使用硬编码的类型列表
5. WHEN 筛选条件变更 THEN 系统 SHALL 通过API发送查询参数到后端，后端执行相应的SQL查询并返回筛选结果

### 需求 3

**用户故事:** 作为销售管理员，我希望能够查看销售记录列表，包含销售的基本信息、金额、客户信息和操作按钮，并且所有数据都来自数据库的真实记录，以便全面了解销售情况并进行管理操作。

#### 验收标准

1. WHEN 用户查看销售记录列表 THEN 系统 SHALL 通过后端API从数据库查询并显示真实的销售信息表格
2. WHEN 显示销售信息 THEN 系统 SHALL 包含数据库中存储的订单号、客户名称、产品信息、销售金额、销售日期
3. WHEN 显示销售状态 THEN 系统 SHALL 根据数据库中的状态字段使用不同颜色的标签显示"已完成"、"进行中"、"已取消"状态
4. WHEN 显示销售人员 THEN 系统 SHALL 从数据库实时查询销售人员信息并显示
5. WHEN 显示销售金额 THEN 系统 SHALL 显示数据库中存储的真实金额信息，并支持货币格式化显示

### 需求 4

**用户故事:** 作为销售管理员，我希望能够对销售记录进行各种操作，包括编辑、查看详情、导出、复制、删除等，以便灵活管理销售数据。

#### 验收标准

1. WHEN 用户查看操作列 THEN 系统 SHALL 显示"编辑"按钮和更多操作下拉菜单
2. WHEN 用户点击"编辑"按钮 THEN 系统 SHALL 打开销售记录编辑对话框并预填充现有数据
3. WHEN 用户点击"查看详情"操作 THEN 系统 SHALL 显示销售记录的完整详细信息
4. WHEN 用户点击"导出"操作 THEN 系统 SHALL 支持导出选中的销售记录为Excel格式
5. WHEN 用户点击"删除"操作 THEN 系统 SHALL 显示确认对话框并执行软删除操作

### 需求 5

**用户故事:** 作为销售管理员，我希望能够录入和编辑销售记录，包含完整的销售信息表单，支持客户选择、产品选择、金额计算等功能。

#### 验收标准

1. WHEN 用户点击"录入销售数据"或"编辑"按钮 THEN 系统 SHALL 打开销售记录编辑对话框
2. WHEN 显示编辑表单 THEN 系统 SHALL 包含客户信息、产品信息、销售金额、销售日期、销售人员、备注字段
3. WHEN 用户选择客户 THEN 系统 SHALL 提供客户搜索和选择功能，数据来自数据库customers表
4. WHEN 用户选择产品 THEN 系统 SHALL 提供产品搜索和选择功能，数据来自数据库products表，并自动计算金额
5. WHEN 用户输入销售金额 THEN 系统 SHALL 支持数字格式验证和货币格式化显示

### 需求 6

**用户故事:** 作为销售管理员，我希望销售记录表单具有完善的验证机制，确保销售数据的准确性和完整性。

#### 验收标准

1. WHEN 客户信息为空 THEN 系统 SHALL 显示"请选择客户"错误提示
2. WHEN 产品信息为空 THEN 系统 SHALL 显示"请选择产品"错误提示
3. WHEN 销售金额为空或无效 THEN 系统 SHALL 显示"请输入有效的销售金额"错误提示
4. WHEN 销售日期为空 THEN 系统 SHALL 显示"请选择销售日期"错误提示
5. WHEN 销售人员未选择 THEN 系统 SHALL 显示"请选择销售人员"错误提示

### 需求 7

**用户故事:** 作为销售管理员，我希望能够查看销售数据的统计分析，包括总销售额、销售趋势、产品销售排行等，以便了解销售业绩和趋势。

#### 验收标准

1. WHEN 用户查看统计面板 THEN 系统 SHALL 显示总销售额、订单数量、平均订单金额、同比增长率等关键指标
2. WHEN 显示销售趋势图 THEN 系统 SHALL 使用ECharts展示按月或按日的销售趋势折线图
3. WHEN 显示产品销售排行 THEN 系统 SHALL 显示销售金额前10的产品排行榜
4. WHEN 显示销售人员业绩 THEN 系统 SHALL 显示各销售人员的销售业绩排行
5. WHEN 统计数据更新 THEN 系统 SHALL 在销售记录变更时通过数据库事务自动更新统计数据

### 需求 8

**用户故事:** 作为销售管理员，我希望能够查看销售数据的图表分析，包括饼图、柱状图、折线图等多种图表形式，以便直观了解销售数据分布和趋势。

#### 验收标准

1. WHEN 用户查看销售分布饼图 THEN 系统 SHALL 显示按产品类型或地区的销售金额分布饼图
2. WHEN 用户查看月度销售柱状图 THEN 系统 SHALL 显示最近12个月的销售金额柱状图
3. WHEN 用户查看销售趋势折线图 THEN 系统 SHALL 显示销售金额和订单数量的双轴折线图
4. WHEN 用户切换图表类型 THEN 系统 SHALL 支持在不同图表类型之间切换显示
5. WHEN 图表数据更新 THEN 系统 SHALL 支持实时刷新图表数据

### 需求 9

**用户故事:** 作为销售管理员，我希望销售记录列表支持分页功能，能够处理大量销售数据并提供灵活的分页控制。

#### 验收标准

1. WHEN 显示销售记录列表 THEN 系统 SHALL 支持分页显示，默认每页20条记录
2. WHEN 用户切换页码 THEN 系统 SHALL 加载对应页面的销售数据
3. WHEN 用户修改每页显示数量 THEN 系统 SHALL 提供20、50、100的选项
4. WHEN 分页信息显示 THEN 系统 SHALL 显示总记录数、当前页码、总页数等信息
5. WHEN 筛选条件变更 THEN 系统 SHALL 重置分页到第一页

### 需求 10

**用户故事:** 作为销售管理员，我希望能够执行批量操作，包括批量导出、批量删除、批量修改状态等，以便高效管理多条销售记录。

#### 验收标准

1. WHEN 用户选择多条销售记录 THEN 系统 SHALL 通过复选框支持多选功能
2. WHEN 执行批量导出 THEN 系统 SHALL 将选中的销售记录导出为Excel文件
3. WHEN 执行批量删除 THEN 系统 SHALL 显示确认对话框并软删除选中的记录
4. WHEN 执行批量状态修改 THEN 系统 SHALL 支持批量修改销售记录状态
5. WHEN 批量操作完成 THEN 系统 SHALL 显示操作结果提示并刷新列表

### 需求 11

**用户故事:** 作为销售管理员，我希望系统能够提供基于数据库真实数据的销售统计信息，包括各种维度的统计分析，以便制定销售策略。

#### 验收标准

1. WHEN 获取销售统计 THEN 系统 SHALL 通过SQL查询数据库计算总销售额、订单数、平均订单金额等统计
2. WHEN 显示时间维度统计 THEN 系统 SHALL 从数据库聚合查询日、周、月、年各维度的销售数据
3. WHEN 统计数据更新 THEN 系统 SHALL 在销售记录变更时通过数据库事务自动更新统计数据
4. WHEN 查看统计信息 THEN 系统 SHALL 通过API实时查询数据库并显示最新统计数据
5. WHEN 前端显示统计 THEN 系统 SHALL 将数据库查询结果直接绑定到前端组件，不使用任何硬编码数据

### 需求 12

**用户故事:** 作为销售管理员，我希望系统具有良好的用户体验，包括响应式设计、加载状态、错误处理等。

#### 验收标准

1. WHEN 页面在移动设备显示 THEN 系统 SHALL 自动适配屏幕尺寸并调整布局
2. WHEN 数据加载中 THEN 系统 SHALL 显示加载动画和状态提示
3. WHEN 操作执行中 THEN 系统 SHALL 显示相应的处理状态和进度提示
4. WHEN 操作成功 THEN 系统 SHALL 显示成功提示信息并自动刷新相关数据
5. WHEN 操作失败 THEN 系统 SHALL 显示友好的错误提示信息

### 需求 13

**用户故事:** 作为销售管理员，我希望能够导出销售数据报表，支持多种格式和自定义导出字段，以便进行离线分析和汇报。

#### 验收标准

1. WHEN 用户点击导出功能 THEN 系统 SHALL 提供Excel、CSV、PDF格式选项
2. WHEN 选择导出字段 THEN 系统 SHALL 支持自定义选择要导出的数据字段
3. WHEN 设置导出条件 THEN 系统 SHALL 支持按时间范围、状态等条件筛选导出数据
4. WHEN 执行导出操作 THEN 系统 SHALL 生成包含真实数据库数据的报表文件
5. WHEN 导出完成 THEN 系统 SHALL 提供文件下载链接并显示导出成功提示

### 需求 14

**用户故事:** 作为销售管理员，我希望前端页面能够完全与后端API和数据库数据绑定，确保页面显示的所有内容都是真实的数据库数据，而不是任何形式的模拟数据。

#### 验收标准

1. WHEN 前端页面加载 THEN 系统 SHALL 通过HTTP请求调用后端API获取所有数据
2. WHEN 后端API响应 THEN 系统 SHALL 从MySQL数据库中查询真实的销售记录并返回
3. WHEN 前端接收数据 THEN 系统 SHALL 将API返回的数据直接绑定到Vue组件的响应式数据中
4. WHEN 用户操作数据 THEN 系统 SHALL 通过API调用实时更新数据库记录并同步前端显示
5. WHEN 页面刷新 THEN 系统 SHALL 重新从数据库加载最新数据，确保数据的实时性和准确性

### 需求 15

**用户故事:** 作为销售管理员，我希望系统能够正确处理空数据状态，当数据库中没有销售数据时，页面应显示友好的空状态提示而不是模拟数据，以便我了解当前状态并开始录入真实数据。

#### 验收标准

1. WHEN 数据库中没有销售数据 THEN 系统 SHALL 显示空状态页面，包含"暂无销售数据"提示信息
2. WHEN 显示空状态 THEN 系统 SHALL 提供"录入第一条销售数据"的引导按钮
3. WHEN 数据库查询返回空结果 THEN 系统 SHALL NOT 显示任何模拟或示例销售数据
4. WHEN 用户首次访问系统 THEN 系统 SHALL 显示真实的空状态而不是预填充的示例数据
5. WHEN 所有销售记录被删除后 THEN 系统 SHALL 重新显示空状态页面

### 需求 16

**用户故事:** 作为系统管理员，我希望确保系统启动时不会自动插入任何模拟销售数据，所有销售数据都必须通过管理后台手动录入，以保证数据的真实性和可控性。

#### 验收标准

1. WHEN 系统首次启动 THEN 系统 SHALL NOT 在数据库中插入任何示例销售数据
2. WHEN DataInitializationService运行 THEN 系统 SHALL 只创建必要的基础数据（如产品类型、销售人员等），不创建销售记录
3. WHEN 检查数据库初始状态 THEN sales_records表 SHALL 为空，不包含任何预设的销售记录
4. WHEN 管理员访问销售数据管理页面 THEN 系统 SHALL 显示真实的空状态，提示录入第一条销售数据
5. WHEN 需要测试功能 THEN 管理员 SHALL 通过前端界面手动录入测试销售数据，而不是依赖预设数据

### 需求 17

**用户故事:** 作为销售管理员，我希望能够查看销售数据的实时仪表板，包括关键指标的实时更新和预警功能，以便及时了解销售状况。

#### 验收标准

1. WHEN 用户访问销售仪表板 THEN 系统 SHALL 显示实时的销售关键指标卡片
2. WHEN 显示实时数据 THEN 系统 SHALL 每5分钟自动刷新统计数据
3. WHEN 销售目标设置 THEN 系统 SHALL 支持设置月度和年度销售目标，并显示完成进度
4. WHEN 异常预警 THEN 系统 SHALL 在销售数据异常时显示预警提示
5. WHEN 数据对比 THEN 系统 SHALL 显示与上期（上月/上年）的对比数据和增长率