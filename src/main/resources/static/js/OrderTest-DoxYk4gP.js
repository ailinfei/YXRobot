var T=(V,O,n)=>new Promise((g,f)=>{var w=d=>{try{o(n.next(d))}catch(i){f(i)}},k=d=>{try{o(n.throw(d))}catch(i){f(i)}},o=d=>d.done?g(d.value):Promise.resolve(d.value).then(w,k);o((n=n.apply(V,O)).next())});import{q as J,r as K,b as C}from"./element-plus-B_LAMX2W.js";import{a as S}from"./order-DgpU5ivT.js";import{O as Q,a as X,b as j}from"./OrderDetailDialog-GG31NPc3.js";import{x as G,r as h,h as W,al as y,y as p,z as u,A as r,K as N,Q as a,I as l,M as _,u as $,O as c,P as E,a6 as P,H as Y}from"./vue-C2NPAEWw.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"order-test-page"},te={class:"test-actions"},se={key:0,class:"orders-list"},ae={key:0},le={key:1,class:"test-results"},oe={class:"test-result"},re={class:"result-title"},ne={class:"result-message"},de={key:0,class:"result-data"},ie=G({__name:"OrderTest",setup(V){const O=h([]),n=h(!1),g=h(!1),f=h(null),w=h(null),k=h([]),o=(e,t,D,v)=>{k.value.unshift({id:Date.now().toString(),action:e,message:t,success:D,timestamp:new Date().toLocaleString(),data:v})},d=()=>{f.value=null,n.value=!0,o("打开创建对话框","销售订单创建对话框已打开",!0)},i=()=>T(null,null,function*(){try{const e=yield S.getOrders({pageSize:10});O.value=e.data.list,o("加载订单列表",`成功加载 ${e.data.list.length} 个订单`,!0,{total:e.data.total,stats:e.data.stats}),C.success("订单列表加载成功")}catch(e){o("加载订单列表","加载失败: "+e,!1),C.error("加载订单列表失败")}}),z=e=>{w.value=e,g.value=!0,o("查看订单详情",`查看订单: ${e.orderNumber}`,!0,e)},x=e=>{f.value=e,n.value=!0,o("编辑订单",`编辑订单: ${e.orderNumber}`,!0)},F=e=>T(null,null,function*(){try{yield S.deleteOrder(e.id),yield i(),o("删除订单",`订单 ${e.orderNumber} 删除成功`,!0),C.success("订单删除成功")}catch(t){o("删除订单","删除失败: "+t,!1),C.error("删除订单失败")}}),I=()=>{i();const e=f.value?"更新订单":"创建订单";o(e,`${e}成功`,!0)},R=e=>{g.value=!1,x(e)},B=e=>({pending:"warning",confirmed:"primary",processing:"primary",shipped:"info",delivered:"success",completed:"success",cancelled:"danger"})[e]||"info",q=e=>j[e]||e,M=()=>T(null,null,function*(){o("开始自动测试","销售订单功能自动测试开始",!0),yield i();try{const e={type:"sales",customerName:"测试客户",customerPhone:"13800138000",customerEmail:"test@example.com",deliveryAddress:"北京市朝阳区测试地址123号",items:[{productId:"prod_001",productName:"练字机器人 - 基础版",quantity:1,unitPrice:2999,totalPrice:2999,notes:"测试商品"}],shippingFee:50,discount:0,totalAmount:3049,expectedDeliveryDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],salesPerson:"测试销售员",notes:"这是一个自动测试创建的订单"},t=yield S.createOrder(e);o("创建测试订单","测试订单创建成功",!0,t.data),yield i()}catch(e){o("创建测试订单","创建失败: "+e,!1)}o("自动测试完成","销售订单功能自动测试完成",!0)});return W(()=>{setTimeout(()=>{M()},1e3)}),(e,t)=>{const D=y("el-icon"),v=y("el-button"),m=y("el-table-column"),A=y("el-tag"),U=y("el-table"),L=y("el-timeline-item"),H=y("el-timeline");return u(),p("div",ee,[t[9]||(t[9]=r("div",{class:"page-header"},[r("h2",null,"销售订单创建功能测试"),r("p",null,"测试销售订单创建、编辑、查看等功能")],-1)),r("div",te,[a(v,{type:"primary",onClick:d},{default:l(()=>[a(D,null,{default:l(()=>[a($(J))]),_:1}),t[2]||(t[2]=_(" 创建销售订单 ",-1))]),_:1,__:[2]}),a(v,{onClick:i},{default:l(()=>[a(D,null,{default:l(()=>[a($(K))]),_:1}),t[3]||(t[3]=_(" 加载测试订单 ",-1))]),_:1,__:[3]})]),O.value.length>0?(u(),p("div",se,[t[7]||(t[7]=r("h3",null,"测试订单列表",-1)),a(U,{data:O.value,border:""},{default:l(()=>[a(m,{prop:"orderNumber",label:"订单号",width:"150"}),a(m,{prop:"type",label:"类型",width:"100"},{default:l(({row:s})=>[a(A,{type:s.type==="sales"?"success":"primary"},{default:l(()=>[_(c(s.type==="sales"?"销售":"租赁"),1)]),_:2},1032,["type"])]),_:1}),a(m,{prop:"customerName",label:"客户",width:"120"}),a(m,{prop:"customerPhone",label:"电话",width:"130"}),a(m,{label:"商品",width:"200"},{default:l(({row:s})=>[(u(!0),p(E,null,P(s.items.slice(0,2),b=>(u(),p("div",{key:b.id},c(b.productName)+" x"+c(b.quantity),1))),128)),s.items.length>2?(u(),p("div",ae," +"+c(s.items.length-2)+"个商品 ",1)):N("",!0)]),_:1}),a(m,{prop:"totalAmount",label:"总金额",width:"120"},{default:l(({row:s})=>[_(" ¥"+c(s.totalAmount.toFixed(2)),1)]),_:1}),a(m,{prop:"status",label:"状态",width:"100"},{default:l(({row:s})=>[a(A,{type:B(s.status)},{default:l(()=>[_(c(q(s.status)),1)]),_:2},1032,["type"])]),_:1}),a(m,{label:"操作",width:"200"},{default:l(({row:s})=>[a(v,{size:"small",onClick:b=>z(s)},{default:l(()=>t[4]||(t[4]=[_("查看",-1)])),_:2,__:[4]},1032,["onClick"]),a(v,{size:"small",type:"primary",onClick:b=>x(s)},{default:l(()=>t[5]||(t[5]=[_("编辑",-1)])),_:2,__:[5]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:b=>F(s)},{default:l(()=>t[6]||(t[6]=[_("删除",-1)])),_:2,__:[6]},1032,["onClick"])]),_:1})]),_:1},8,["data"])])):N("",!0),k.value.length>0?(u(),p("div",le,[t[8]||(t[8]=r("h3",null,"测试结果",-1)),a(H,null,{default:l(()=>[(u(!0),p(E,null,P(k.value,s=>(u(),Y(L,{key:s.id,timestamp:s.timestamp,type:s.success?"success":"danger"},{default:l(()=>[r("div",oe,[r("div",re,c(s.action),1),r("div",ne,c(s.message),1),s.data?(u(),p("div",de,[r("pre",null,c(JSON.stringify(s.data,null,2)),1)])):N("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):N("",!0),a(Q,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),order:f.value,onSuccess:I},null,8,["modelValue","order"]),a(X,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),order:w.value,onEdit:R},null,8,["modelValue","order"])])}}}),ve=Z(ie,[["__scopeId","data-v-dd699e09"]]);export{ve as default};
