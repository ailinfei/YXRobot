var re=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var G=(_,i,r)=>i in _?re(_,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):_[i]=r,O=(_,i)=>{for(var r in i||(i={}))ce.call(i,r)&&G(_,r,i[r]);if(H)for(var r of H(i))ue.call(i,r)&&G(_,r,i[r]);return _},U=(_,i)=>ie(_,de(i));var K=(_,i,r)=>new Promise((b,u)=>{var D=v=>{try{M(r.next(v))}catch(k){u(k)}},y=v=>{try{M(r.throw(v))}catch(k){u(k)}},M=v=>v.done?b(v.value):Promise.resolve(v.value).then(D,y);M((r=r.apply(_,i)).next())});import{a3 as L,ab as j,ac as A,T as J,M as fe,r as _e,ad as me,ae as pe,af as ve,j as he,b as P}from"./element-plus-BHn0tN3r.js";import{m as ge}from"./device-DE1c5Zxf.js";import{x as be,r as w,c as ye,h as we,al as f,ar as Me,y as $,z as m,A as e,Q as s,I as a,u as d,O as c,D as T,K as Q,P as ke,a6 as xe,H as g,J as Te,M as C}from"./vue-C2NPAEWw.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const De={class:"device-monitoring"},ze={class:"monitoring-stats"},Ne={class:"stat-card online"},Ve={class:"stat-icon"},Se={class:"stat-content"},Le={class:"stat-value"},Pe={class:"stat-trend"},$e={class:"stat-card offline"},Ee={class:"stat-icon"},Oe={class:"stat-content"},Ue={class:"stat-value"},Ae={class:"stat-trend"},Be={class:"stat-card error"},Ie={class:"stat-icon"},Fe={class:"stat-content"},He={class:"stat-value"},Ge={class:"stat-trend"},Ke={class:"stat-card performance"},je={class:"stat-icon"},Je={class:"stat-content"},Qe={class:"stat-value"},Re={class:"stat-trend"},We={class:"card-header"},Xe={class:"device-map",ref:"mapContainer",style:{height:"400px"}},Ye={class:"map-placeholder"},qe={class:"card-header"},Ze={class:"alerts-list"},et={class:"alert-icon"},tt={class:"alert-content"},st={class:"alert-message"},at={class:"alert-time"},lt={key:0,class:"no-alerts"},nt={class:"chart-container",ref:"performanceChart",style:{height:"300px"}},ot={class:"chart-placeholder"},rt={class:"chart-container",ref:"networkChart",style:{height:"300px"}},it={class:"chart-placeholder"},dt={class:"card-header"},ct={class:"header-actions"},ut={class:"performance-metrics"},ft={class:"metric-item"},_t={class:"metric-value"},mt={class:"metric-item"},pt={class:"metric-value"},vt={class:"device-info-detail"},ht={class:"info-row"},gt={class:"info-value"},bt={class:"info-row"},yt={class:"info-value"},wt={class:"network-status"},Mt={class:"network-item"},kt={class:"network-type"},xt=be({__name:"DeviceMonitoring",setup(_){const i=w(!1),r=w(""),b=w(""),u=w({online:0,offline:0,error:0,avgPerformance:0,onlineTrend:0,offlineTrend:0,errorTrend:0,performanceTrend:0}),D=w([]),y=w([]),M=ye(()=>{let l=D.value;if(r.value){const t=r.value.toLowerCase();l=l.filter(o=>o.serialNumber.toLowerCase().includes(t)||o.customerName.toLowerCase().includes(t))}return b.value&&(l=l.filter(t=>t.status===b.value)),l}),v=()=>K(null,null,function*(){i.value=!0;try{const l=yield ge.getDevices({pageSize:100}),t=l.data.list;D.value=t.map(p=>U(O({},p),{performance:{cpu:Math.floor(Math.random()*100),memory:Math.floor(Math.random()*100)}}));const o=l.data.stats;u.value={online:o.online,offline:o.offline,error:o.error,avgPerformance:Math.floor(Math.random()*30)+70,onlineTrend:Math.floor(Math.random()*20)-10,offlineTrend:Math.floor(Math.random()*10)-5,errorTrend:Math.floor(Math.random()*6)-3,performanceTrend:Math.floor(Math.random()*10)-5},k()}catch(l){console.error("加载监控数据失败:",l),P.error("加载监控数据失败")}finally{i.value=!1}}),k=()=>{const l=[{level:"error",message:"设备 EDU-001234 连接超时"},{level:"warning",message:"设备 HOME-005678 电池电量低于20%"},{level:"error",message:"设备 PRO-009876 硬件故障"},{level:"warning",message:"设备 EDU-002468 内存使用率过高"},{level:"info",message:"设备 HOME-001357 固件更新完成"}];y.value=l.map((t,o)=>U(O({id:(o+1).toString()},t),{timestamp:new Date(Date.now()-Math.random()*36e5).toISOString()}))},R=()=>{P.info("地图数据已刷新")},W=l=>{P.info(`查看设备详情：${l.serialNumber}`)},X=l=>{P.info(`远程控制设备：${l.serialNumber}`)},z=l=>l>0?"trend-up":l<0?"trend-down":"trend-stable",N=l=>l>0?`+${l}`:l.toString(),Y=l=>({online:"success",offline:"info",error:"danger",maintenance:"warning"})[l]||"info",q=l=>({online:"在线",offline:"离线",error:"故障",maintenance:"维护中"})[l]||l,B=l=>l>=80?"#f56c6c":l>=60?"#e6a23c":"#67c23a",Z=l=>l?new Date(l).toLocaleString("zh-CN"):"无",ee=l=>{const t=new Date,o=new Date(l),p=t.getTime()-o.getTime();return p<6e4?"刚刚":p<36e5?`${Math.floor(p/6e4)}分钟前`:p<864e5?`${Math.floor(p/36e5)}小时前`:o.toLocaleDateString("zh-CN")};return we(()=>{v()}),(l,t)=>{const o=f("el-icon"),p=f("el-button"),x=f("el-card"),V=f("el-col"),te=f("el-badge"),I=f("el-row"),se=f("el-input"),S=f("el-option"),ae=f("el-select"),h=f("el-table-column"),F=f("el-tag"),E=f("el-progress"),le=f("el-table"),ne=Me("loading");return m(),$("div",De,[t[23]||(t[23]=e("div",{class:"page-header"},[e("div",{class:"header-left"},[e("h2",null,"设备监控"),e("p",{class:"header-subtitle"},"实时监控设备状态与性能 · 练字机器人管理系统")])],-1)),e("div",ze,[e("div",Ne,[e("div",Ve,[s(o,null,{default:a(()=>[s(d(L))]),_:1})]),e("div",Se,[e("div",Le,c(u.value.online),1),t[2]||(t[2]=e("div",{class:"stat-label"},"在线设备",-1)),e("div",Pe,[e("span",{class:T(["trend",z(u.value.onlineTrend)])},c(N(u.value.onlineTrend)),3)])])]),e("div",$e,[e("div",Ee,[s(o,null,{default:a(()=>[s(d(j))]),_:1})]),e("div",Oe,[e("div",Ue,c(u.value.offline),1),t[3]||(t[3]=e("div",{class:"stat-label"},"离线设备",-1)),e("div",Ae,[e("span",{class:T(["trend",z(u.value.offlineTrend)])},c(N(u.value.offlineTrend)),3)])])]),e("div",Be,[e("div",Ie,[s(o,null,{default:a(()=>[s(d(A))]),_:1})]),e("div",Fe,[e("div",He,c(u.value.error),1),t[4]||(t[4]=e("div",{class:"stat-label"},"故障设备",-1)),e("div",Ge,[e("span",{class:T(["trend",z(u.value.errorTrend)])},c(N(u.value.errorTrend)),3)])])]),e("div",Ke,[e("div",je,[s(o,null,{default:a(()=>[s(d(J))]),_:1})]),e("div",Je,[e("div",Qe,c(u.value.avgPerformance)+"%",1),t[5]||(t[5]=e("div",{class:"stat-label"},"平均性能",-1)),e("div",Re,[e("span",{class:T(["trend",z(u.value.performanceTrend)])},c(N(u.value.performanceTrend)),3)])])])]),s(I,{gutter:24},{default:a(()=>[s(V,{span:16},{default:a(()=>[s(x,{class:"monitoring-card"},{header:a(()=>[e("div",We,[t[6]||(t[6]=e("span",null,"设备分布地图",-1)),s(p,{text:"",onClick:R},{default:a(()=>[s(o,null,{default:a(()=>[s(d(_e))]),_:1})]),_:1})])]),default:a(()=>[e("div",Xe,[e("div",Ye,[s(o,{size:"48"},{default:a(()=>[s(d(fe))]),_:1}),t[7]||(t[7]=e("p",null,"设备分布地图",-1)),t[8]||(t[8]=e("p",{class:"map-info"},"显示全球设备实时状态分布",-1))])],512)]),_:1})]),_:1}),s(V,{span:8},{default:a(()=>[s(x,{class:"monitoring-card"},{header:a(()=>[e("div",qe,[t[9]||(t[9]=e("span",null,"实时告警",-1)),s(te,{value:y.value.length,max:99,type:"danger"},{default:a(()=>[s(o,null,{default:a(()=>[s(d(pe))]),_:1})]),_:1},8,["value"])])]),default:a(()=>[e("div",Ze,[(m(!0),$(ke,null,xe(y.value.slice(0,10),n=>(m(),$("div",{key:n.id,class:T(["alert-item",`alert-${n.level}`])},[e("div",et,[s(o,null,{default:a(()=>[n.level==="error"?(m(),g(d(A),{key:0})):n.level==="warning"?(m(),g(d(me),{key:1})):(m(),g(d(L),{key:2}))]),_:2},1024)]),e("div",tt,[e("div",st,c(n.message),1),e("div",at,c(ee(n.timestamp)),1)])],2))),128)),y.value.length===0?(m(),$("div",lt,[s(o,null,{default:a(()=>[s(d(L))]),_:1}),t[10]||(t[10]=e("p",null,"暂无告警信息",-1))])):Q("",!0)])]),_:1})]),_:1})]),_:1}),s(I,{gutter:24,style:{"margin-top":"24px"}},{default:a(()=>[s(V,{span:12},{default:a(()=>[s(x,{class:"monitoring-card"},{header:a(()=>t[11]||(t[11]=[e("span",null,"设备性能趋势",-1)])),default:a(()=>[e("div",nt,[e("div",ot,[s(o,{size:"48"},{default:a(()=>[s(d(J))]),_:1}),t[12]||(t[12]=e("p",null,"设备性能趋势图",-1))])],512)]),_:1})]),_:1}),s(V,{span:12},{default:a(()=>[s(x,{class:"monitoring-card"},{header:a(()=>t[13]||(t[13]=[e("span",null,"网络连接状态",-1)])),default:a(()=>[e("div",rt,[e("div",it,[s(o,{size:"48"},{default:a(()=>[s(d(ve))]),_:1}),t[14]||(t[14]=e("p",null,"网络连接状态图",-1))])],512)]),_:1})]),_:1})]),_:1}),s(x,{class:"monitoring-card",style:{"margin-top":"24px"}},{header:a(()=>[e("div",dt,[t[15]||(t[15]=e("span",null,"设备实时状态",-1)),e("div",ct,[s(se,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=n=>r.value=n),placeholder:"搜索设备","prefix-icon":d(he),clearable:"",style:{width:"200px","margin-right":"12px"}},null,8,["modelValue","prefix-icon"]),s(ae,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=n=>b.value=n),placeholder:"状态筛选",clearable:"",style:{width:"120px"}},{default:a(()=>[s(S,{label:"全部",value:""}),s(S,{label:"在线",value:"online"}),s(S,{label:"离线",value:"offline"}),s(S,{label:"故障",value:"error"})]),_:1},8,["modelValue"])])])]),default:a(()=>[Te((m(),g(le,{data:M.value,stripe:""},{default:a(()=>[s(h,{prop:"serialNumber",label:"设备序列号","min-width":"160"}),s(h,{prop:"customerName",label:"客户","min-width":"120"}),s(h,{prop:"status",label:"状态","min-width":"120"},{default:a(({row:n})=>[s(F,{type:Y(n.status),size:"small"},{default:a(()=>[s(o,{style:{"margin-right":"4px"}},{default:a(()=>[n.status==="online"?(m(),g(d(L),{key:0})):n.status==="offline"?(m(),g(d(j),{key:1})):(m(),g(d(A),{key:2}))]),_:2},1024),C(" "+c(q(n.status)),1)]),_:2},1032,["type"])]),_:1}),s(h,{label:"性能指标","min-width":"280"},{default:a(({row:n})=>[e("div",ut,[e("div",ft,[t[16]||(t[16]=e("span",{class:"metric-label"},"CPU:",-1)),s(E,{percentage:n.performance.cpu,"stroke-width":6,"show-text":!1,color:B(n.performance.cpu)},null,8,["percentage","color"]),e("span",_t,c(n.performance.cpu)+"%",1)]),e("div",mt,[t[17]||(t[17]=e("span",{class:"metric-label"},"内存:",-1)),s(E,{percentage:n.performance.memory,"stroke-width":6,"show-text":!1,color:B(n.performance.memory)},null,8,["percentage","color"]),e("span",pt,c(n.performance.memory)+"%",1)])])]),_:1}),s(h,{prop:"lastOnlineAt",label:"最后在线时间","min-width":"180"},{default:a(({row:n})=>[C(c(Z(n.lastOnlineAt)),1)]),_:1}),s(h,{label:"设备信息","min-width":"200"},{default:a(({row:n})=>[e("div",vt,[e("div",ht,[t[18]||(t[18]=e("span",{class:"info-label"},"型号:",-1)),e("span",gt,c(n.model||"YX-EDU-2024"),1)]),e("div",bt,[t[19]||(t[19]=e("span",{class:"info-label"},"固件:",-1)),e("span",yt,c(n.firmwareVersion||"v2.1.0"),1)])])]),_:1}),s(h,{label:"网络状态","min-width":"160"},{default:a(({row:n})=>[e("div",wt,[e("div",Mt,[t[20]||(t[20]=e("span",{class:"network-label"},"信号强度:",-1)),s(E,{percentage:Math.floor(Math.random()*40)+60,"stroke-width":4,"show-text":!1,color:"#67c23a"},null,8,["percentage"])]),e("div",kt,[s(F,{size:"small",type:"info"},{default:a(()=>[C(c(["4G","5G","WiFi"][Math.floor(Math.random()*3)]),1)]),_:1})])])]),_:1}),s(h,{label:"操作","min-width":"200",fixed:"right"},{default:a(({row:n})=>[s(p,{text:"",type:"primary",size:"small",onClick:oe=>W(n)},{default:a(()=>t[21]||(t[21]=[C(" 查看详情 ",-1)])),_:2,__:[21]},1032,["onClick"]),n.status==="online"?(m(),g(p,{key:0,text:"",type:"success",size:"small",onClick:oe=>X(n)},{default:a(()=>t[22]||(t[22]=[C(" 远程控制 ",-1)])),_:2,__:[22]},1032,["onClick"])):Q("",!0)]),_:1})]),_:1},8,["data"])),[[ne,i.value]])]),_:1})])}}}),Vt=Ce(xt,[["__scopeId","data-v-2c82d353"]]);export{Vt as default};
