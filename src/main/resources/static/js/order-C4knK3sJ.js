var $=Object.defineProperty,E=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var S=(d,e,t)=>e in d?$(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t,O=(d,e)=>{for(var t in e||(e={}))k.call(e,t)&&S(d,t,e[t]);if(v)for(var t of v(e))F.call(e,t)&&S(d,t,e[t]);return d},_=(d,e)=>E(d,C(e));var I=(d,e,t)=>S(d,typeof e!="symbol"?e+"":e,t);var p=(d,e,t)=>new Promise((s,n)=>{var i=a=>{try{h(t.next(a))}catch(r){n(r)}},l=a=>{try{h(t.throw(a))}catch(r){n(r)}},h=a=>a.done?s(a.value):Promise.resolve(a.value).then(i,l);h((t=t.apply(d,e)).next())});class D{static generateOrderNumber(){const t=new Date().getTime().toString().slice(-8),s=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`ORD${t}${s}`}static generateOrderItem(){const e=[{id:"prod_001",name:"练字机器人 - 基础版",price:2999},{id:"prod_002",name:"练字机器人 - 专业版",price:4999},{id:"prod_003",name:"练字机器人 - 企业版",price:7999},{id:"prod_004",name:"智能写字板",price:599},{id:"prod_005",name:"专用墨水套装",price:199}],t=e[Math.floor(Math.random()*e.length)],s=Math.floor(Math.random()*5)+1;return{id:`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,productId:t.id,productName:t.name,quantity:s,unitPrice:t.price,totalPrice:t.price*s,notes:Math.random()>.7?"客户要求加急处理":""}}static generateOrder(){var y,A,P,T;const e=[{name:"张三",phone:"13800138001",email:"zhangsan@example.com",address:"北京市朝阳区建国路1号"},{name:"李四",phone:"13800138002",email:"lisi@example.com",address:"上海市浦东新区陆家嘴路2号"},{name:"王五",phone:"13800138003",email:"wangwu@example.com",address:"广州市天河区珠江路3号"},{name:"赵六",phone:"13800138004",email:"zhaoliu@example.com",address:"深圳市南山区科技路4号"},{name:"钱七",phone:"13800138005",email:"qianqi@example.com",address:"杭州市西湖区文三路5号"}],t=["pending","confirmed","processing","shipped","delivered","completed","cancelled"],s=["sales","rental"],n=["pending","paid","failed","refunded"],i=["张经理","李经理","王经理","赵经理","钱经理"],l=e[Math.floor(Math.random()*e.length)],h=s[Math.floor(Math.random()*s.length)],a=t[Math.floor(Math.random()*t.length)],r=Math.floor(Math.random()*3)+1,c=Array.from({length:r},()=>this.generateOrderItem()),u=c.reduce((f,w)=>f+w.totalPrice,0),g=Math.floor(Math.random()*100)+50,M=Math.floor(Math.random()*200),N=u+g-M,m=new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),o={id:`order_${this.orderCounter++}`,orderNumber:this.generateOrderNumber(),type:h,status:a,customerId:`customer_${Math.floor(Math.random()*1e3)}`,customerName:l.name,customerPhone:l.phone,customerEmail:l.email,deliveryAddress:l.address,items:c,subtotal:u,shippingFee:g,discount:M,totalAmount:N,currency:"CNY",paymentStatus:n[Math.floor(Math.random()*n.length)],paymentMethod:Math.random()>.5?"微信支付":"支付宝",paymentTime:a!=="pending"?m:void 0,expectedDeliveryDate:new Date(Date.now()+Math.random()*7*24*60*60*1e3).toISOString().split("T")[0],salesPerson:i[Math.floor(Math.random()*i.length)],notes:Math.random()>.6?"客户要求尽快发货，联系方式已确认":"",createdAt:m,updatedAt:m,createdBy:"admin"};if(h==="rental"){const f=new Date(Date.now()+Math.random()*7*24*60*60*1e3),w=Math.floor(Math.random()*30)+7,b=new Date(f.getTime()+w*24*60*60*1e3);o.rentalStartDate=f.toISOString().split("T")[0],o.rentalEndDate=b.toISOString().split("T")[0],o.rentalDays=w,o.rentalNotes="租赁期间请妥善保管设备，如有损坏需要赔偿"}return["shipped","delivered","completed"].includes(a)&&(o.shippingInfo={company:Math.random()>.5?"顺丰快递":"京东物流",trackingNumber:`SF${Math.floor(Math.random()*1e12)}`,shippedAt:new Date(new Date(m).getTime()+1440*60*1e3).toISOString(),deliveredAt:a==="delivered"||a==="completed"?new Date(new Date(m).getTime()+4320*60*1e3).toISOString():void 0}),o.logs=[{id:"log_1",action:"创建订单",operator:o.salesPerson||"admin",notes:"订单创建成功",createdAt:o.createdAt}],a!=="pending"&&o.logs.push({id:"log_2",action:"确认订单",operator:o.salesPerson||"admin",notes:"订单已确认，准备处理",createdAt:new Date(new Date(m).getTime()+7200*1e3).toISOString()}),["shipped","delivered","completed"].includes(a)&&o.logs.push({id:"log_3",action:"发货",operator:"仓库管理员",notes:`已通过${(y=o.shippingInfo)==null?void 0:y.company}发货`,createdAt:((A=o.shippingInfo)==null?void 0:A.shippedAt)||m}),["delivered","completed"].includes(a)&&o.logs.push({id:"log_4",action:"送达",operator:"系统",notes:"订单已送达客户",createdAt:((P=o.shippingInfo)==null?void 0:P.deliveredAt)||m}),a==="completed"&&o.logs.push({id:"log_5",action:"完成",operator:o.salesPerson||"admin",notes:"订单已完成",createdAt:new Date(new Date(((T=o.shippingInfo)==null?void 0:T.deliveredAt)||m).getTime()+1440*60*1e3).toISOString()}),a==="cancelled"&&o.logs.push({id:"log_cancel",action:"取消",operator:o.salesPerson||"admin",notes:"订单已取消",createdAt:new Date(new Date(m).getTime()+1800*1e3).toISOString()}),o}static generateOrders(e=50){return Array.from({length:e},()=>this.generateOrder())}}I(D,"orderCounter",1e3);class x{static getOrders(){return p(this,arguments,function*(e={}){yield new Promise(r=>setTimeout(r,300));let t=[...this.orders];if(e.keyword){const r=e.keyword.toLowerCase();t=t.filter(c=>c.orderNumber.toLowerCase().includes(r)||c.customerName.toLowerCase().includes(r)||c.customerPhone.includes(r))}if(e.type&&(t=t.filter(r=>r.type===e.type)),e.status&&(t=t.filter(r=>r.status===e.status)),e.dateRange){const[r,c]=e.dateRange;t=t.filter(u=>{const g=u.createdAt.split("T")[0];return g>=r&&g<=c})}e.customerId&&(t=t.filter(r=>r.customerId===e.customerId)),e.salesPerson&&(t=t.filter(r=>r.salesPerson===e.salesPerson)),t.sort((r,c)=>new Date(c.createdAt).getTime()-new Date(r.createdAt).getTime());const s=e.page||1,n=e.pageSize||10,i=(s-1)*n,l=i+n,h=t.slice(i,l),a={total:this.orders.length,pending:this.orders.filter(r=>r.status==="pending").length,processing:this.orders.filter(r=>["confirmed","processing","shipped"].includes(r.status)).length,completed:this.orders.filter(r=>r.status==="completed").length,cancelled:this.orders.filter(r=>r.status==="cancelled").length,totalRevenue:this.orders.filter(r=>r.status==="completed").reduce((r,c)=>r+c.totalAmount,0),averageOrderValue:this.orders.length>0?this.orders.reduce((r,c)=>r+c.totalAmount,0)/this.orders.length:0,salesOrders:this.orders.filter(r=>r.type==="sales").length,rentalOrders:this.orders.filter(r=>r.type==="rental").length};return{data:{list:h,total:t.length,stats:a}}})}static getOrderById(e){return p(this,null,function*(){yield new Promise(s=>setTimeout(s,200));const t=this.orders.find(s=>s.id===e);if(!t)throw new Error("订单不存在");return{data:t}})}static createOrder(e){return p(this,null,function*(){var s;yield new Promise(n=>setTimeout(n,500));const t={id:`order_${Date.now()}`,orderNumber:e.orderNumber||D.generateOrderNumber(),type:e.type||"sales",status:"pending",customerId:e.customerId||`customer_${Date.now()}`,customerName:e.customerName||"",customerPhone:e.customerPhone||"",customerEmail:e.customerEmail,deliveryAddress:e.deliveryAddress||"",items:e.items||[],subtotal:((s=e.items)==null?void 0:s.reduce((n,i)=>n+(i.totalPrice||0),0))||0,shippingFee:e.shippingFee||0,discount:e.discount||0,totalAmount:e.totalAmount||0,currency:"CNY",paymentStatus:"pending",expectedDeliveryDate:e.expectedDeliveryDate,salesPerson:e.salesPerson,notes:e.notes,rentalStartDate:e.rentalStartDate,rentalEndDate:e.rentalEndDate,rentalDays:e.rentalDays,rentalNotes:e.rentalNotes,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"admin",logs:[{id:"log_1",action:"创建订单",operator:e.salesPerson||"admin",notes:"订单创建成功",createdAt:new Date().toISOString()}]};return this.orders.unshift(t),{data:t}})}static updateOrder(e,t){return p(this,null,function*(){yield new Promise(i=>setTimeout(i,500));const s=this.orders.findIndex(i=>i.id===e);if(s===-1)throw new Error("订单不存在");const n=_(O(O({},this.orders[s]),t),{updatedAt:new Date().toISOString()});return n.logs||(n.logs=[]),n.logs.push({id:`log_${Date.now()}`,action:"更新订单",operator:"admin",notes:"订单信息已更新",createdAt:new Date().toISOString()}),this.orders[s]=n,{data:n}})}static updateOrderStatus(e,t){return p(this,null,function*(){yield new Promise(l=>setTimeout(l,300));const s=this.orders.findIndex(l=>l.id===e);if(s===-1)throw new Error("订单不存在");const n=this.orders[s];n.status=t,n.updatedAt=new Date().toISOString(),n.logs||(n.logs=[]);const i={pending:"待确认",confirmed:"已确认",processing:"处理中",shipped:"已发货",delivered:"已送达",completed:"已完成",cancelled:"已取消"};return n.logs.push({id:`log_${Date.now()}`,action:i[t],operator:"admin",notes:`订单状态更新为：${i[t]}`,createdAt:new Date().toISOString()}),t==="shipped"&&!n.shippingInfo&&(n.shippingInfo={company:"顺丰快递",trackingNumber:`SF${Math.floor(Math.random()*1e12)}`,shippedAt:new Date().toISOString()}),t==="delivered"&&n.shippingInfo&&(n.shippingInfo.deliveredAt=new Date().toISOString()),t==="completed"&&(n.paymentStatus="paid",n.paymentTime||(n.paymentTime=new Date().toISOString())),{data:n}})}static batchUpdateOrderStatus(e,t){return p(this,null,function*(){yield new Promise(n=>setTimeout(n,500));const s=[];for(const n of e){const i=yield this.updateOrderStatus(n,t);s.push(i.data)}return{data:s}})}static deleteOrder(e){return p(this,null,function*(){yield new Promise(s=>setTimeout(s,300));const t=this.orders.findIndex(s=>s.id===e);if(t===-1)throw new Error("订单不存在");return this.orders.splice(t,1),{data:!0}})}static batchDeleteOrders(e){return p(this,null,function*(){return yield new Promise(t=>setTimeout(t,500)),this.orders=this.orders.filter(t=>!e.includes(t.id)),{data:!0}})}static exportOrders(){return p(this,arguments,function*(e={}){return yield new Promise(t=>setTimeout(t,1e3)),console.log("导出订单:",e),{data:!0}})}}I(x,"orders",D.generateOrders(100));const R=x;export{R as m};
