var J=Object.defineProperty;var E=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var I=(p,i,u)=>i in p?J(p,i,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[i]=u,N=(p,i)=>{for(var u in i||(i={}))W.call(i,u)&&I(p,u,i[u]);if(E)for(var u of E(i))X.call(i,u)&&I(p,u,i[u]);return p};var M=(p,i,u)=>new Promise((C,w)=>{var U=t=>{try{V(u.next(t))}catch(_){w(_)}},k=t=>{try{V(u.throw(t))}catch(_){w(_)}},V=t=>t.done?C(t.value):Promise.resolve(t.value).then(U,k);V((u=u.apply(p,i)).next())});import{c as P}from"./customer-CyLpurj8.js";import{b as h}from"./element-plus-B_LfhBgj.js";import{x as Y,c as T,r as y,j as A,al as f,H as q,z as g,I as l,Q as e,A as c,y as x,K as Z,P as R,a6 as S,M as L,O as ee,n as le}from"./vue-C2NPAEWw.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"form-section"},oe={class:"form-section"},ue={key:0,class:"form-section"},de={class:"form-section"},se={class:"dialog-footer"},re=Y({__name:"CustomerFormDialog",props:{modelValue:{type:Boolean},customer:{default:null}},emits:["update:modelValue","success"],setup(p,{emit:i}){const u=p,C=i,w=T({get:()=>u.modelValue,set:r=>C("update:modelValue",r)}),U=y(),k=y(!1),V=()=>({name:"",type:"individual",phone:"",email:"",level:"regular",status:"active",address:{province:"",city:"",district:"",detail:"",zipCode:""},companyName:"",creditCode:"",legalRepresentative:"",companySize:"",tags:[],notes:""}),t=y(V()),_=T(()=>!!u.customer),j=y(["北京市","上海市","天津市","重庆市","河北省","山西省","辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省","山东省","河南省","湖北省","湖南省","广东省","海南省","四川省","贵州省","云南省","陕西省","甘肃省","青海省","内蒙古自治区","广西壮族自治区","西藏自治区","宁夏回族自治区","新疆维吾尔自治区"]),B=y([]),H=y(["重要客户","长期合作","教育行业","政府客户","企业客户","个人用户","新客户","老客户","高价值","潜在客户"]),K={name:[{required:!0,message:"请输入客户姓名",trigger:"blur"}],type:[{required:!0,message:"请选择客户类型",trigger:"change"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],level:[{required:!0,message:"请选择客户等级",trigger:"change"}],status:[{required:!0,message:"请选择客户状态",trigger:"change"}],"address.province":[{required:!0,message:"请选择省份",trigger:"change"}],"address.city":[{required:!0,message:"请选择城市",trigger:"change"}],"address.detail":[{required:!0,message:"请输入详细地址",trigger:"blur"}],companyName:[{required:!0,message:"请输入企业名称",trigger:"blur",validator:(r,a,m)=>{t.value.type==="enterprise"&&!a?m(new Error("请输入企业名称")):m()}}]};A(()=>u.modelValue,r=>{r&&D()}),A(()=>u.customer,r=>{r&&u.modelValue&&D()});const D=()=>{u.customer?t.value=N(N({},V()),u.customer):t.value=V(),le(()=>{var r;(r=U.value)==null||r.clearValidate()})},O=r=>{const a={北京市:["北京市"],上海市:["上海市"],广东省:["广州市","深圳市","珠海市","佛山市","东莞市"],浙江省:["杭州市","宁波市","温州市","嘉兴市","湖州市"],江苏省:["南京市","苏州市","无锡市","常州市","南通市"]};B.value=a[r]||[r],t.value.address.city=""},Q=()=>M(null,null,function*(){var r;try{yield(r=U.value)==null?void 0:r.validate(),k.value=!0,_.value?(yield P.updateCustomer(u.customer.id,t.value),h.success("客户更新成功")):(yield P.createCustomer(t.value),h.success("客户创建成功")),C("success"),z()}catch(a){console.error("提交失败:",a),h.error("操作失败，请重试")}finally{k.value=!1}}),z=()=>{C("update:modelValue",!1)};return(r,a)=>{const m=f("el-input"),d=f("el-form-item"),s=f("el-col"),n=f("el-option"),b=f("el-select"),v=f("el-row"),$=f("el-form"),F=f("el-button"),G=f("el-dialog");return g(),q(G,{modelValue:w.value,"onUpdate:modelValue":a[17]||(a[17]=o=>w.value=o),title:_.value?"编辑客户":"创建客户",width:"70%","before-close":z,class:"customer-form-dialog"},{footer:l(()=>[c("div",se,[e(F,{onClick:z},{default:l(()=>a[22]||(a[22]=[L("取消",-1)])),_:1,__:[22]}),e(F,{type:"primary",onClick:Q,loading:k.value},{default:l(()=>[L(ee(_.value?"更新客户":"创建客户"),1)]),_:1},8,["loading"])])]),default:l(()=>[e($,{ref_key:"formRef",ref:U,model:t.value,rules:K,"label-width":"120px",class:"customer-form"},{default:l(()=>[c("div",te,[a[18]||(a[18]=c("h3",{class:"section-title"},"基本信息",-1)),e(v,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(d,{label:"客户姓名",prop:"name"},{default:l(()=>[e(m,{modelValue:t.value.name,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.name=o),placeholder:"请输入客户姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(d,{label:"客户类型",prop:"type"},{default:l(()=>[e(b,{modelValue:t.value.type,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.type=o),placeholder:"选择客户类型",style:{width:"100%"}},{default:l(()=>[e(n,{label:"个人客户",value:"individual"}),e(n,{label:"企业客户",value:"enterprise"}),e(n,{label:"教育机构",value:"education"}),e(n,{label:"政府机构",value:"government"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(d,{label:"联系电话",prop:"phone"},{default:l(()=>[e(m,{modelValue:t.value.phone,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.phone=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(d,{label:"电子邮箱",prop:"email"},{default:l(()=>[e(m,{modelValue:t.value.email,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.email=o),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(d,{label:"客户等级",prop:"level"},{default:l(()=>[e(b,{modelValue:t.value.level,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.level=o),placeholder:"选择客户等级",style:{width:"100%"}},{default:l(()=>[e(n,{label:"普通客户",value:"regular"}),e(n,{label:"VIP客户",value:"vip"}),e(n,{label:"高级客户",value:"premium"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(d,{label:"客户状态",prop:"status"},{default:l(()=>[e(b,{modelValue:t.value.status,"onUpdate:modelValue":a[5]||(a[5]=o=>t.value.status=o),placeholder:"选择客户状态",style:{width:"100%"}},{default:l(()=>[e(n,{label:"活跃",value:"active"}),e(n,{label:"非活跃",value:"inactive"}),e(n,{label:"暂停",value:"suspended"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),c("div",oe,[a[19]||(a[19]=c("h3",{class:"section-title"},"联系信息",-1)),e(v,{gutter:24},{default:l(()=>[e(s,{span:8},{default:l(()=>[e(d,{label:"省份",prop:"address.province"},{default:l(()=>[e(b,{modelValue:t.value.address.province,"onUpdate:modelValue":a[6]||(a[6]=o=>t.value.address.province=o),placeholder:"选择省份",onChange:O,style:{width:"100%"}},{default:l(()=>[(g(!0),x(R,null,S(j.value,o=>(g(),q(n,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:8},{default:l(()=>[e(d,{label:"城市",prop:"address.city"},{default:l(()=>[e(b,{modelValue:t.value.address.city,"onUpdate:modelValue":a[7]||(a[7]=o=>t.value.address.city=o),placeholder:"选择城市",style:{width:"100%"}},{default:l(()=>[(g(!0),x(R,null,S(B.value,o=>(g(),q(n,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:8},{default:l(()=>[e(d,{label:"区县",prop:"address.district"},{default:l(()=>[e(m,{modelValue:t.value.address.district,"onUpdate:modelValue":a[8]||(a[8]=o=>t.value.address.district=o),placeholder:"区县"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:24},{default:l(()=>[e(s,{span:18},{default:l(()=>[e(d,{label:"详细地址",prop:"address.detail"},{default:l(()=>[e(m,{modelValue:t.value.address.detail,"onUpdate:modelValue":a[9]||(a[9]=o=>t.value.address.detail=o),placeholder:"详细地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(d,{label:"邮政编码",prop:"address.zipCode"},{default:l(()=>[e(m,{modelValue:t.value.address.zipCode,"onUpdate:modelValue":a[10]||(a[10]=o=>t.value.address.zipCode=o),placeholder:"邮政编码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),t.value.type==="enterprise"?(g(),x("div",ue,[a[20]||(a[20]=c("h3",{class:"section-title"},"企业信息",-1)),e(v,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(d,{label:"企业名称",prop:"companyName"},{default:l(()=>[e(m,{modelValue:t.value.companyName,"onUpdate:modelValue":a[11]||(a[11]=o=>t.value.companyName=o),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(d,{label:"统一社会信用代码",prop:"creditCode"},{default:l(()=>[e(m,{modelValue:t.value.creditCode,"onUpdate:modelValue":a[12]||(a[12]=o=>t.value.creditCode=o),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(d,{label:"法定代表人",prop:"legalRepresentative"},{default:l(()=>[e(m,{modelValue:t.value.legalRepresentative,"onUpdate:modelValue":a[13]||(a[13]=o=>t.value.legalRepresentative=o),placeholder:"请输入法定代表人"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(d,{label:"企业规模",prop:"companySize"},{default:l(()=>[e(b,{modelValue:t.value.companySize,"onUpdate:modelValue":a[14]||(a[14]=o=>t.value.companySize=o),placeholder:"选择企业规模",style:{width:"100%"}},{default:l(()=>[e(n,{label:"小型企业",value:"small"}),e(n,{label:"中型企业",value:"medium"}),e(n,{label:"大型企业",value:"large"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])):Z("",!0),c("div",de,[a[21]||(a[21]=c("h3",{class:"section-title"},"标签和备注",-1)),e(v,{gutter:24},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(d,{label:"客户标签",prop:"tags"},{default:l(()=>[e(b,{modelValue:t.value.tags,"onUpdate:modelValue":a[15]||(a[15]=o=>t.value.tags=o),multiple:"",filterable:"","allow-create":"",placeholder:"选择或创建标签",style:{width:"100%"}},{default:l(()=>[(g(!0),x(R,null,S(H.value,o=>(g(),q(n,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:24},{default:l(()=>[e(s,{span:24},{default:l(()=>[e(d,{label:"备注信息",prop:"notes"},{default:l(()=>[e(m,{modelValue:t.value.notes,"onUpdate:modelValue":a[16]||(a[16]=o=>t.value.notes=o),type:"textarea",rows:3,placeholder:"客户备注信息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),fe=ae(re,[["__scopeId","data-v-8c45b9ce"]]);export{fe as C};
