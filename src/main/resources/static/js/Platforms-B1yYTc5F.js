var $e=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var ne=(p,v,s)=>v in p?$e(p,v,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[v]=s,se=(p,v)=>{for(var s in v||(v={}))Ee.call(v,s)&&ne(p,s,v[s]);if(le)for(var s of le(v))Ue.call(v,s)&&ne(p,s,v[s]);return p},re=(p,v)=>Te(p,De(v));var B=(p,v,s)=>new Promise((D,z)=>{var f=L=>{try{V(s.next(L))}catch(T){z(T)}},n=L=>{try{V(s.throw(L))}catch(T){z(T)}},V=L=>L.done?D(L.value):Promise.resolve(L.value).then(f,n);V((s=s.apply(p,v)).next())});import{i as J}from"./charts-4xgvsrqt.js";import{B as ie,o as Re,k as Pe,T as Be,U as xe,V as ze,p as Ae,x as Fe,b as W,n as Ne}from"./element-plus-B_LfhBgj.js";/* empty css                                                                     *//* empty css                                                                         */import{C as ce}from"./CommonDialog-DmvKEX1O.js";import{D as Ie}from"./DataTable-BfvT2meh.js";import{C as Me}from"./CountUp-DhNxH7hh.js";import{x as te,c as I,al as _,y as k,z as r,D as Y,K as q,A as b,B as Z,O as x,Q as t,I as l,u as R,M as O,C as We,H as N,L as ue,P as X,a6 as K,r as E,X as qe,h as Oe,aB as He,n as Xe}from"./vue-C2NPAEWw.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as de}from"./StatusTag-C08vtP-K.js";/* empty css                                                                       */import{a as H}from"./config-Da9KhdDy.js";/* empty css                                                                  *//* empty css                                                                  */import"./utils-T70AYnHr.js";const Ke={key:0,class:"card-header"},Qe={class:"header-left"},je={class:"card-title-section"},Ge={class:"card-title"},Je={key:0,class:"card-subtitle"},Ye={class:"header-right"},Ze={class:"card-content"},et={key:0,class:"card-loading"},tt={key:1,class:"card-error"},ot={key:2,class:"card-empty"},at={key:3,class:"card-body"},lt={key:0,class:"number-display"},nt={key:0,class:"card-title-inline"},st={class:"main-value"},rt={key:1,class:"value-change"},it={key:1,class:"progress-display"},ct={class:"progress-info"},ut={class:"progress-label"},dt={class:"progress-value"},mt={key:2,class:"list-display"},pt={class:"item-label"},vt={class:"item-value"},ft={key:3,class:"custom-content"},gt={key:1,class:"card-footer"},ht={class:"footer-info"},yt={key:0,class:"update-time"},kt=te({__name:"DataCard",props:{title:{default:""},subtitle:{default:""},type:{default:"custom"},value:{default:0},unit:{default:""},change:{default:void 0},changeType:{default:"percent"},icon:{default:void 0},iconClass:{default:""},valueColor:{default:""},progressLabel:{default:""},progressColor:{default:"#409eff"},progressStrokeWidth:{default:6},listData:{default:()=>[]},loading:{type:Boolean,default:!1},loadingText:{default:"加载中..."},error:{default:""},isEmpty:{type:Boolean,default:!1},emptyText:{default:"暂无数据"},showHeader:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},updateTime:{default:""},moreLink:{default:""},theme:{default:"default"},size:{default:"default"},clickable:{type:Boolean,default:!1},customClass:{default:""}},emits:["click","action","retry"],setup(p,{emit:v}){const s=p,D=v,z=I(()=>[`card-${s.theme}`,`card-${s.size}`,s.customClass,{clickable:s.clickable,"has-error":s.error,"is-loading":s.loading,"is-empty":s.isEmpty}]),f=I(()=>s.change===void 0?"":s.change>0?"change-positive":s.change<0?"change-negative":"change-neutral"),n=I(()=>s.change===void 0?ie:s.change>0?Re:s.change<0?Pe:ie),V=o=>{const g=Math.abs(o),c=o>0?"+":o<0?"-":"",i=s.changeType==="percent"?"%":"";return`${c}${g}${i}`},L=o=>o?new Date(o).toLocaleString("zh-CN"):"",T=o=>{D("action",o)},A=()=>{D("retry")};return(o,g)=>{const c=_("el-icon"),i=_("el-button"),U=_("el-dropdown-item"),S=_("el-dropdown-menu"),$=_("el-dropdown"),M=_("el-progress"),y=_("el-link");return r(),k("div",{class:Y(["data-card",z.value])},[o.showHeader?(r(),k("div",Ke,[b("div",Qe,[o.icon||o.$slots.icon?(r(),k("div",{key:0,class:Y(["card-icon",o.iconClass])},[Z(o.$slots,"icon",{},()=>[o.icon?(r(),N(c,{key:0},{default:l(()=>[(r(),N(ue(o.icon)))]),_:1})):q("",!0)],!0)],2)):q("",!0),b("div",je,[b("h3",Ge,x(o.title),1),o.subtitle?(r(),k("p",Je,x(o.subtitle),1)):q("",!0)])]),b("div",Ye,[Z(o.$slots,"header-actions",{},()=>[o.showActions?(r(),N($,{key:0,onCommand:T},{dropdown:l(()=>[t(S,null,{default:l(()=>[t(U,{command:"refresh"},{default:l(()=>g[0]||(g[0]=[O("刷新",-1)])),_:1,__:[0]}),t(U,{command:"export"},{default:l(()=>g[1]||(g[1]=[O("导出",-1)])),_:1,__:[1]}),t(U,{command:"settings"},{default:l(()=>g[2]||(g[2]=[O("设置",-1)])),_:1,__:[2]})]),_:1})]),default:l(()=>[t(i,{text:"",icon:R(Ae)},null,8,["icon"])]),_:1})):q("",!0)],!0)])])):q("",!0),b("div",Ze,[o.loading?(r(),k("div",et,[t(c,{class:"is-loading"},{default:l(()=>[t(R(Be))]),_:1}),b("span",null,x(o.loadingText),1)])):o.error?(r(),k("div",tt,[t(c,null,{default:l(()=>[t(R(xe))]),_:1}),b("span",null,x(o.error),1),t(i,{type:"primary",size:"small",onClick:A},{default:l(()=>g[3]||(g[3]=[O("重试",-1)])),_:1,__:[3]})])):o.isEmpty?(r(),k("div",ot,[t(c,null,{default:l(()=>[t(R(ze))]),_:1}),b("span",null,x(o.emptyText),1)])):(r(),k("div",at,[o.type==="number"?(r(),k("div",lt,[o.title?(r(),k("div",nt,x(o.title),1)):q("",!0),b("div",st,[t(Me,{value:Number(o.value),duration:1500,decimals:0,suffix:o.unit,class:"value-number",style:We({color:o.valueColor})},null,8,["value","suffix","style"])]),o.change!==void 0?(r(),k("div",rt,[t(c,{class:Y(f.value)},{default:l(()=>[(r(),N(ue(n.value)))]),_:1},8,["class"]),b("span",{class:Y(f.value)},x(V(o.change)),3)])):q("",!0)])):o.type==="progress"?(r(),k("div",it,[b("div",ct,[b("span",ut,x(o.progressLabel),1),b("span",dt,x(o.value)+x(o.unit||"%"),1)]),t(M,{percentage:Number(o.value),color:o.progressColor,"stroke-width":o.progressStrokeWidth,"show-text":!1},null,8,["percentage","color","stroke-width"])])):o.type==="list"?(r(),k("div",mt,[(r(!0),k(X,null,K(o.listData,(F,h)=>(r(),k("div",{key:h,class:"list-item"},[b("div",pt,x(F.label),1),b("div",vt,x(F.value),1)]))),128))])):(r(),k("div",ft,[Z(o.$slots,"default",{},void 0,!0)]))]))]),o.showFooter||o.$slots.footer?(r(),k("div",gt,[Z(o.$slots,"footer",{},()=>[b("div",ht,[o.updateTime?(r(),k("span",yt," 更新时间: "+x(L(o.updateTime)),1)):q("",!0),o.moreLink?(r(),N(y,{key:1,type:"primary",href:o.moreLink,underline:!1},{default:l(()=>g[4]||(g[4]=[O(" 查看更多 ",-1)])),_:1,__:[4]},8,["href"])):q("",!0)])],!0)])):q("",!0)],2)}}}),ee=oe(kt,[["__scopeId","data-v-42bdc7bd"]]),Ct=p=>H.get("/api/platform-links",{params:p}),bt=p=>H.post("/api/platform-links",p),_t=(p,v)=>H.put(`/api/platform-links/${p}`,v),wt=p=>H.delete(`/api/platform-links/${p}`),Vt=p=>H.put("/api/platform-links/batch",p),Lt=()=>H.get("/api/platform-stats"),St=()=>H.get("/api/platform-stats/regions"),$t=(p,v)=>H.patch(`/api/platform-links/${p}/toggle`,{isEnabled:v}),Tt={class:"platform-link-form"},Dt=te({__name:"PlatformLinkForm",props:{modelValue:{},regions:{},editing:{type:Boolean}},emits:["update:modelValue"],setup(p,{expose:v,emit:s}){const D=p,z=s,f=E(),n=I({get:()=>D.modelValue,set:c=>z("update:modelValue",c)}),V=I(()=>D.regions.find(c=>c.region===n.value.region)),L=I(()=>{const c=new Set;return D.regions.forEach(i=>{i.country&&c.add(i.country)}),Array.from(c).map(i=>({name:i,code:i}))}),T=I(()=>{var c;return((c=V.value)==null?void 0:c.languages)||[]}),A={platformName:[{required:!0,message:"请输入平台名称",trigger:"blur"}],platformType:[{required:!0,message:"请选择平台类型",trigger:"change"}],linkUrl:[{required:!0,message:"请输入链接地址",trigger:"blur"},{type:"url",message:"请输入有效的URL地址",trigger:"blur"}],region:[{required:!0,message:"请选择地区",trigger:"change"}],country:[{required:!0,message:"请选择国家",trigger:"change"}],languageCode:[{required:!0,message:"请选择语言",trigger:"change"}]},o=()=>{n.value.country="",n.value.languageCode=""};return v({validate:()=>B(null,null,function*(){if(!f.value)return!1;try{return yield f.value.validate(),!0}catch(c){return!1}})}),(c,i)=>{const U=_("el-input"),S=_("el-form-item"),$=_("el-option"),M=_("el-select"),y=_("el-switch"),F=_("el-form");return r(),k("div",Tt,[t(F,{ref_key:"formRef",ref:f,model:n.value,rules:A,"label-width":"120px"},{default:l(()=>[t(S,{label:"平台名称",prop:"platformName"},{default:l(()=>[t(U,{modelValue:n.value.platformName,"onUpdate:modelValue":i[0]||(i[0]=h=>n.value.platformName=h),placeholder:"请输入平台名称"},null,8,["modelValue"])]),_:1}),t(S,{label:"平台类型",prop:"platformType"},{default:l(()=>[t(M,{modelValue:n.value.platformType,"onUpdate:modelValue":i[1]||(i[1]=h=>n.value.platformType=h),placeholder:"请选择平台类型",style:{width:"100%"}},{default:l(()=>[t($,{label:"电商平台",value:"ecommerce"}),t($,{label:"租赁平台",value:"rental"})]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"链接地址",prop:"linkUrl"},{default:l(()=>[t(U,{modelValue:n.value.linkUrl,"onUpdate:modelValue":i[2]||(i[2]=h=>n.value.linkUrl=h),placeholder:"请输入链接地址",type:"url"},null,8,["modelValue"])]),_:1}),t(S,{label:"地区",prop:"region"},{default:l(()=>[t(M,{modelValue:n.value.region,"onUpdate:modelValue":i[3]||(i[3]=h=>n.value.region=h),placeholder:"请选择地区",style:{width:"100%"},onChange:o},{default:l(()=>[(r(!0),k(X,null,K(c.regions,h=>(r(),N($,{key:h.region,label:h.region,value:h.region},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"国家",prop:"country"},{default:l(()=>[t(M,{modelValue:n.value.country,"onUpdate:modelValue":i[4]||(i[4]=h=>n.value.country=h),placeholder:"请选择国家",style:{width:"100%"}},{default:l(()=>[(r(!0),k(X,null,K(L.value,h=>(r(),N($,{key:h.code,label:h.name,value:h.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"语言",prop:"languageCode"},{default:l(()=>[t(M,{modelValue:n.value.languageCode,"onUpdate:modelValue":i[5]||(i[5]=h=>n.value.languageCode=h),placeholder:"请选择语言",style:{width:"100%"}},{default:l(()=>[(r(!0),k(X,null,K(T.value,h=>(r(),N($,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"启用状态"},{default:l(()=>[t(y,{modelValue:n.value.isEnabled,"onUpdate:modelValue":i[6]||(i[6]=h=>n.value.isEnabled=h),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])}}}),Et=oe(Dt,[["__scopeId","data-v-1e01c480"]]),Ut={class:"batch-update-form"},Rt={class:"form-tip"},Pt=te({__name:"BatchUpdateForm",props:{modelValue:{},regions:{}},emits:["update:modelValue"],setup(p,{expose:v,emit:s}){const D=p,z=s,f=E(),n=I({get:()=>D.modelValue,set:g=>z("update:modelValue",g)}),V=I(()=>D.regions.find(g=>g.region===n.value.region)),L=I(()=>{var g;return((g=V.value)==null?void 0:g.countries)||[]}),T=I(()=>{var g;return((g=V.value)==null?void 0:g.languages)||[]}),A=()=>{n.value.country=void 0,n.value.languageCode=void 0};return v({validate:()=>B(null,null,function*(){return!0})}),(g,c)=>{const i=_("el-option"),U=_("el-select"),S=_("el-form-item"),$=_("el-form"),M=_("el-alert");return r(),k("div",Ut,[t($,{ref_key:"formRef",ref:f,model:n.value,"label-width":"120px"},{default:l(()=>[t(S,{label:"平台类型"},{default:l(()=>[t(U,{modelValue:n.value.platformType,"onUpdate:modelValue":c[0]||(c[0]=y=>n.value.platformType=y),placeholder:"请选择平台类型（可选）",style:{width:"100%"},clearable:""},{default:l(()=>[t(i,{label:"电商平台",value:"ecommerce"}),t(i,{label:"租赁平台",value:"rental"})]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"地区"},{default:l(()=>[t(U,{modelValue:n.value.region,"onUpdate:modelValue":c[1]||(c[1]=y=>n.value.region=y),placeholder:"请选择地区（可选）",style:{width:"100%"},clearable:"",onChange:A},{default:l(()=>[(r(!0),k(X,null,K(g.regions,y=>(r(),N(i,{key:y.region,label:y.region,value:y.region},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"国家"},{default:l(()=>[t(U,{modelValue:n.value.country,"onUpdate:modelValue":c[2]||(c[2]=y=>n.value.country=y),placeholder:"请选择国家（可选）",style:{width:"100%"},clearable:""},{default:l(()=>[(r(!0),k(X,null,K(L.value,y=>(r(),N(i,{key:y.code,label:y.name,value:y.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"语言"},{default:l(()=>[t(U,{modelValue:n.value.languageCode,"onUpdate:modelValue":c[3]||(c[3]=y=>n.value.languageCode=y),placeholder:"请选择语言（可选）",style:{width:"100%"},clearable:""},{default:l(()=>[(r(!0),k(X,null,K(T.value,y=>(r(),N(i,{key:y.code,label:y.name,value:y.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"启用状态"},{default:l(()=>[t(U,{modelValue:n.value.isEnabled,"onUpdate:modelValue":c[4]||(c[4]=y=>n.value.isEnabled=y),placeholder:"请选择启用状态（可选）",style:{width:"100%"},clearable:""},{default:l(()=>[t(i,{label:"启用",value:!0}),t(i,{label:"禁用",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("div",Rt,[t(M,{title:"批量更新说明",description:"只有选择了值的字段才会被更新，未选择的字段保持原值不变",type:"info",closable:!1,"show-icon":""})])])}}}),Bt=oe(Pt,[["__scopeId","data-v-3a1e801e"]]),xt={class:"platforms-management"},zt={class:"page-header"},At={class:"header-right"},Ft={class:"stats-cards"},Nt=te({__name:"Platforms",setup(p){const v=E(!1),s=E([]),D=E([]),z=E([]),f=E({totalLinks:0,activeLinks:0,inactiveLinks:0,totalClicks:0,totalConversions:0,conversionRate:0,topPerformingLinks:[],regionStats:[],languageStats:[]}),n=qe({page:1,pageSize:20,total:0}),V=E(!1),L=E(!1),T=E(null),A=E({platformName:"",platformType:"ecommerce",linkUrl:"",region:"",country:"",languageCode:"",isEnabled:!0}),o=E({}),g=E(),c=E(),i=[{prop:"platformName",label:"平台名称",minWidth:120},{prop:"platformType",label:"平台类型",width:100,type:"tag"},{prop:"linkUrl",label:"链接地址",minWidth:200,showOverflowTooltip:!0},{prop:"region",label:"地区",width:100},{prop:"languageName",label:"语言",width:100},{prop:"linkStatus",label:"状态",width:100,type:"tag"},{prop:"isEnabled",label:"启用",width:80},{prop:"clickCount",label:"点击量",width:100,align:"right"},{prop:"conversionCount",label:"转化量",width:100,align:"right"},{prop:"lastCheckedAt",label:"最后检查",width:150,type:"date"},{prop:"actions",label:"操作",width:180,fixed:"right"}],U={ecommerce:{text:"电商平台",type:"success"},rental:{text:"租赁平台",type:"info"}},S={active:{text:"正常",type:"success"},inactive:{text:"异常",type:"danger"},checking:{text:"检查中",type:"warning"},error:{text:"错误",type:"danger"}},$=()=>B(null,null,function*(){try{v.value=!0;const e=yield Ct({page:n.page,pageSize:n.pageSize});e.code===200&&(s.value=e.data.list,n.total=e.data.total)}catch(e){console.error("加载数据失败:",e),W.error("加载数据失败")}finally{v.value=!1}}),M=()=>({totalLinks:80,activeLinks:65,inactiveLinks:15,totalClicks:285420,totalConversions:18650,conversionRate:6.53,topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654},{name:"天猫",clicks:15420,conversions:1234},{name:"eBay",clicks:12340,conversions:987}],regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],languageStats:[{language:"简体中文",linkCount:28,clicks:145230,conversions:9876},{language:"英语",linkCount:22,clicks:98450,conversions:6234},{language:"日语",linkCount:12,clicks:41740,conversions:2540},{language:"韩语",linkCount:10,clicks:24430,conversions:1581},{language:"德语",linkCount:8,clicks:18650,conversions:1104}]}),y=e=>{if(!e)return!1;const C=["totalLinks","activeLinks","totalClicks","conversionRate"].every(u=>e[u]!==void 0),d=Array.isArray(e.regionStats)&&e.regionStats.length>0,w=Array.isArray(e.topPerformingLinks);return C&&d&&w},F=()=>B(null,null,function*(){try{console.log("📊 开始加载统计数据..."),v.value=!0;const e=yield Lt();if(console.log("📊 统计数据响应:",e),e.code===200&&y(e.data))f.value=e.data,console.log("📊 API统计数据已设置:",f.value);else throw new Error("API数据无效或不完整")}catch(e){console.warn("📊 API加载失败，使用默认数据:",e),f.value=M(),console.log("📊 默认统计数据已设置:",f.value)}finally{v.value=!1,yield Xe(),console.log("📊 数据加载完成，开始初始化图表..."),ae()}}),h=E({regionChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},platformTypeChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},clickTrendChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},conversionChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0}}),me=(e,a=10)=>new Promise((C,d)=>{let w=0;const u=()=>{const m=document.getElementById(e);m&&m.offsetWidth>0&&m.offsetHeight>0?(console.log(`✅ 容器 ${e} 已就绪:`,{width:m.offsetWidth,height:m.offsetHeight}),C(m)):w<a?(w++,console.log(`⏳ 等待容器 ${e} 就绪... (${w}/${a})`),setTimeout(u,200)):(console.error(`❌ 容器 ${e} 超时未就绪`),d(new Error(`Container ${e} not ready after ${a} retries`)))};u()}),Q=(e,a,C=3)=>B(null,null,function*(){var w;const d=h.value[e];try{console.log(`📊 开始初始化图表: ${e}`),d.isLoading=!0,d.hasError=!1,yield me(e),(!f.value||!((w=f.value.regionStats)!=null&&w.length)&&e==="regionChart")&&console.log(`📊 ${e} 数据未就绪，使用默认数据`),a(),d.isInitialized=!0,d.isLoading=!1,console.log(`✅ 图表 ${e} 初始化成功`)}catch(u){console.error(`❌ 图表 ${e} 初始化失败:`,u),d.hasError=!0,d.isLoading=!1,d.retryCount++,d.retryCount<C?(console.log(`🔄 重试初始化图表 ${e} (${d.retryCount}/${C})`),setTimeout(()=>{Q(e,a,C)},1e3*d.retryCount)):console.error(`💥 图表 ${e} 初始化最终失败，已达到最大重试次数`)}}),ae=()=>B(null,null,function*(){var a;console.log("🚀 开始初始化所有图表..."),(a=f.value.regionStats)!=null&&a.length||(console.log("📊 设置默认图表数据..."),f.value=re(se({},f.value),{regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654}]}));const e=[Q("regionChart",pe),Q("platformTypeChart",ve),Q("clickTrendChart",fe),Q("conversionChart",ge)];try{yield Promise.allSettled(e),console.log("🎉 所有图表初始化完成!")}catch(C){console.error("💥 图表初始化过程中出现错误:",C)}}),pe=()=>{const e=document.getElementById("regionChart");if(!e){console.error("地区分布图表容器未找到");return}console.log("📊 初始化地区分布图表，数据:",f.value.regionStats);const a=J(e),C=f.value.regionStats.length>0?f.value.regionStats.map(w=>({value:w.linkCount,name:w.region})):[{value:25,name:"中国大陆"},{value:18,name:"美国"},{value:12,name:"日本"},{value:10,name:"韩国"},{value:8,name:"德国"},{value:7,name:"其他地区"}],d={title:{text:"地区分布统计",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}个链接 ({d}%)"},legend:{orient:"vertical",left:"left",top:"middle"},series:[{name:"地区分布",type:"pie",radius:["40%","70%"],center:["60%","50%"],data:C,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,formatter:"{b}: {c}"},labelLine:{show:!0}}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452"]};a.setOption(d),console.log("✅ 地区分布图表初始化完成")},ve=()=>{const e=document.getElementById("platformTypeChart");if(!e){console.error("平台类型图表容器未找到");return}const a=J(e),C=s.value.filter(m=>m.platformType==="ecommerce").length,d=s.value.filter(m=>m.platformType==="rental").length;console.log("📊 平台类型统计:",{ecommerceCount:C,rentalCount:d});const u={title:{text:"平台类型分布",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}个链接 ({d}%)"},legend:{orient:"horizontal",bottom:"10%",left:"center"},series:[{name:"平台类型",type:"pie",radius:["30%","60%"],center:["50%","45%"],data:[{value:C||52,name:"电商平台"},{value:d||28,name:"租赁平台"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,formatter:"{b}: {c}个\\n({d}%)"},labelLine:{show:!1}}],color:["#5470c6","#91cc75"]};a.setOption(u),console.log("📊 平台类型图表初始化完成")},fe=()=>{const e=document.getElementById("clickTrendChart");if(!e){console.error("点击量趋势图表容器未找到");return}const a=J(e),C=[],d=[],w=[],u=new Date;for(let P=29;P>=0;P--){const j=new Date(u);j.setDate(j.getDate()-P),C.push(j.toLocaleDateString("zh-CN",{month:"short",day:"numeric"}));const G=3e3+Math.sin(P*.2)*1e3+Math.random()*800,Se=G*(.05+Math.random()*.03);d.push(Math.floor(G)),w.push(Math.floor(Se))}console.log("📊 点击量趋势数据:",{dates:C.slice(-7),clicks:d.slice(-7)});const m={title:{text:"点击量趋势（最近30天）",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["点击量","转化量"],top:"10%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},xAxis:{type:"category",data:C,axisLabel:{rotate:45}},yAxis:[{type:"value",name:"点击量",position:"left",axisLabel:{formatter:"{value}"}},{type:"value",name:"转化量",position:"right",axisLabel:{formatter:"{value}"}}],series:[{name:"点击量",type:"line",yAxisIndex:0,data:d,smooth:!0,itemStyle:{color:"#5470c6"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(84, 112, 198, 0.3)"},{offset:1,color:"rgba(84, 112, 198, 0.1)"}]}}},{name:"转化量",type:"line",yAxisIndex:1,data:w,smooth:!0,itemStyle:{color:"#91cc75"}}]};a.setOption(m),console.log("📊 点击量趋势图表初始化完成")},ge=()=>{var w,u;const e=document.getElementById("conversionChart");if(!e){console.error("转化率对比图表容器未找到");return}const a=J(e),C=((u=(w=f.value)==null?void 0:w.regionStats)==null?void 0:u.map(m=>({region:m.region,conversionRate:(m.conversions/m.clicks*100).toFixed(2),clicks:m.clicks,conversions:m.conversions})))||[{region:"中国大陆",conversionRate:"7.12",clicks:125680,conversions:8945},{region:"美国",conversionRate:"5.85",clicks:89420,conversions:5234},{region:"日本",conversionRate:"6.30",clicks:45890,conversions:2890},{region:"韩国",conversionRate:"6.47",clicks:24430,conversions:1581},{region:"德国",conversionRate:"5.92",clicks:18650,conversions:1104},{region:"法国",conversionRate:"6.18",clicks:15420,conversions:953}];console.log("📊 转化率对比数据:",C);const d={title:{text:"各地区转化率对比",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(m){const P=C[m[0].dataIndex];if(!P)return"";const j=P.clicks||0,G=P.conversions||0;return`${P.region}<br/>转化率: ${P.conversionRate}%<br/>点击量: ${j.toLocaleString()}<br/>转化量: ${G.toLocaleString()}`}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:C.map(m=>m.region),axisLabel:{rotate:45}},yAxis:{type:"value",axisLabel:{formatter:"{value}%"},min:0,max:10},series:[{name:"转化率",type:"bar",data:C.map(m=>parseFloat(m.conversionRate)),itemStyle:{color:function(m){const P=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272"];return P[m.dataIndex%P.length]}},label:{show:!0,position:"top",formatter:"{c}%"}}]};a.setOption(d),console.log("📊 转化率对比图表初始化完成")},he=()=>B(null,null,function*(){try{const e=yield St();e.code===200&&(z.value=e.data)}catch(e){console.error("加载区域配置失败:",e)}}),ye=e=>{n.page=e,$()},ke=e=>{n.pageSize=e,n.page=1,$()},Ce=e=>{D.value=e},be=e=>{T.value=e,A.value={platformName:e.platformName,platformType:e.platformType,linkUrl:e.linkUrl,region:e.region,country:e.country,languageCode:e.languageCode,isEnabled:e.isEnabled},V.value=!0},_e=()=>B(null,null,function*(){var e;try{if(!((e=g.value)!=null&&e.validate()))return;T.value?(yield _t(T.value.id,A.value)).code===200&&(W.success("更新成功"),V.value=!1,T.value=null,$(),F()):(yield bt(A.value)).code===200&&(W.success("创建成功"),V.value=!1,$(),F())}catch(a){console.error("保存失败:",a),W.error("保存失败")}}),we=e=>B(null,null,function*(){try{yield Ne.confirm("确定要删除这个链接吗？","确认删除",{type:"warning"}),(yield wt(e)).code===200&&(W.success("删除成功"),$(),F())}catch(a){a!=="cancel"&&(console.error("删除失败:",a),W.error("删除失败"))}}),Ve=()=>B(null,null,function*(){var e;try{if(!((e=c.value)!=null&&e.validate()))return;const a=D.value.map(d=>d.id);(yield Vt({linkIds:a,updates:o.value})).code===200&&(W.success("批量更新成功"),L.value=!1,o.value={},D.value=[],$(),F())}catch(a){console.error("批量更新失败:",a),W.error("批量更新失败")}}),Le=e=>B(null,null,function*(){try{(yield $t(e.id,e.isEnabled)).code===200&&(W.success(e.isEnabled?"已启用":"已禁用"),F())}catch(a){console.error("切换状态失败:",a),W.error("切换状态失败"),e.isEnabled=!e.isEnabled}});return Oe(()=>B(null,null,function*(){console.log("🚀 平台链接管理页面加载中...");try{yield he(),yield $(),yield F(),setTimeout(()=>{console.log("🔄 强制重新初始化图表..."),ae()},1e3),console.log("✅ 平台链接管理页面数据加载完成")}catch(e){console.error("❌ 平台链接管理页面数据加载失败:",e),f.value={totalLinks:80,activeLinks:65,inactiveLinks:15,totalClicks:285420,totalConversions:18650,conversionRate:6.53,topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654}],regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],languageStats:[{language:"简体中文",linkCount:28,clicks:145230,conversions:9876},{language:"英语",linkCount:22,clicks:98450,conversions:6234},{language:"日语",linkCount:12,clicks:41740,conversions:2540},{language:"韩语",linkCount:10,clicks:24430,conversions:1581},{language:"德语",linkCount:8,clicks:18650,conversions:1104}]},setTimeout(()=>{console.log("🔄 加载失败后强制初始化图表..."),ae()},1e3)}})),(e,a)=>{const C=_("el-icon"),d=_("el-button"),w=_("el-switch");return r(),k("div",xt,[b("div",zt,[a[6]||(a[6]=b("div",{class:"header-left"},[b("h2",null,"平台链接管理"),b("p",{class:"page-description"},"管理电商平台和租赁平台的链接配置")],-1)),b("div",At,[t(d,{type:"primary",onClick:a[0]||(a[0]=u=>V.value=!0)},{default:l(()=>[t(C,null,{default:l(()=>[t(R(Fe))]),_:1}),a[5]||(a[5]=O(" 添加链接 ",-1))]),_:1,__:[5]})])]),b("div",Ft,[t(R(ee),{title:"总链接数",type:"number",value:f.value.totalLinks,theme:"primary","show-header":!1},null,8,["value"]),t(R(ee),{title:"活跃链接",type:"number",value:f.value.activeLinks,theme:"success","show-header":!1},null,8,["value"]),t(R(ee),{title:"总点击量",type:"number",value:f.value.totalClicks,theme:"warning","show-header":!1},null,8,["value"]),t(R(ee),{title:"转化率",type:"number",value:f.value.conversionRate,unit:"%",theme:"danger","show-header":!1},null,8,["value"])]),a[9]||(a[9]=He('<div class="charts-section" data-v-25f8251a><div class="chart-row" data-v-25f8251a><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📍 地区分布统计</h3></div><div class="chart-content" data-v-25f8251a><div id="regionChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>🏪 平台类型分布</h3></div><div class="chart-content" data-v-25f8251a><div id="platformTypeChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div></div><div class="chart-row" data-v-25f8251a><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📈 点击量趋势</h3></div><div class="chart-content" data-v-25f8251a><div id="clickTrendChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📊 转化率对比</h3></div><div class="chart-content" data-v-25f8251a><div id="conversionChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div></div></div>',1)),t(R(Ie),{data:s.value,columns:i,loading:v.value,"show-toolbar":!1,"show-selection":!0,"show-actions":!0,"show-edit":!1,"show-delete":!1,onSelectionChange:Ce,onPageChange:ye,onSizeChange:ke},{platformType:l(({row:u})=>[t(R(de),{status:u.platformType,"status-map":U},null,8,["status"])]),linkStatus:l(({row:u})=>[t(R(de),{status:u.linkStatus,"status-map":S},null,8,["status"])]),isEnabled:l(({row:u})=>[t(w,{modelValue:u.isEnabled,"onUpdate:modelValue":m=>u.isEnabled=m,onChange:m=>Le(u)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),actions:l(({row:u})=>[t(d,{size:"small",type:"primary",onClick:m=>be(u)},{default:l(()=>a[7]||(a[7]=[O(" 编辑 ",-1)])),_:2,__:[7]},1032,["onClick"]),t(d,{size:"small",type:"danger",onClick:m=>we(u.id)},{default:l(()=>a[8]||(a[8]=[O(" 删除 ",-1)])),_:2,__:[8]},1032,["onClick"])]),_:1},8,["data","loading"]),t(R(ce),{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=u=>V.value=u),title:T.value?"编辑链接":"添加链接",width:"600px",onConfirm:_e},{default:l(()=>[t(Et,{ref_key:"linkFormRef",ref:g,modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=u=>A.value=u),regions:z.value,editing:!!T.value},null,8,["modelValue","regions","editing"])]),_:1},8,["modelValue","title"]),t(R(ce),{modelValue:L.value,"onUpdate:modelValue":a[4]||(a[4]=u=>L.value=u),title:"批量更新链接",width:"500px",onConfirm:Ve},{default:l(()=>[t(Bt,{ref_key:"batchFormRef",ref:c,modelValue:o.value,"onUpdate:modelValue":a[3]||(a[3]=u=>o.value=u),regions:z.value},null,8,["modelValue","regions"])]),_:1},8,["modelValue"])])}}}),oo=oe(Nt,[["__scopeId","data-v-25f8251a"]]);export{oo as default};
