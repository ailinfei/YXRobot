var we=Object.defineProperty,De=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var ge=(p,u,r)=>u in p?we(p,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[u]=r,E=(p,u)=>{for(var r in u||(u={}))Pe.call(u,r)&&ge(p,r,u[r]);if(fe)for(var r of fe(u))ke.call(u,r)&&ge(p,r,u[r]);return p},L=(p,u)=>De(p,Ve(u));var C=(p,u,r)=>new Promise((f,_)=>{var h=V=>{try{k(r.next(V))}catch(o){_(o)}},A=V=>{try{k(r.throw(V))}catch(o){_(o)}},k=V=>V.done?f(V.value):Promise.resolve(V.value).then(h,A);k((r=r.apply(p,u)).next())});import{q as Se,a0 as Ae,b as K,e as Ce,k as Ie,aG as $e,n as Ne}from"./element-plus-B_LAMX2W.js";import{m as Me,a as me}from"./order-DgpU5ivT.js";import{x as ve,r as G,c as J,j as pe,al as v,H as M,z as b,I as t,Q as e,A as l,y as I,K as S,P as oe,a6 as ne,M as D,u as x,O as m,n as Te}from"./vue-C2NPAEWw.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ue=[{id:"1",url:"https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=800&h=600&fit=crop",alt:"练字机器人主图",order:1,type:"main"},{id:"2",url:"https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=800&h=600&fit=crop",alt:"产品侧面图",order:2,type:"gallery"},{id:"3",url:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&h=600&fit=crop",alt:"产品细节图",order:3,type:"gallery"},{id:"4",url:"https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=800&h=600&fit=crop",alt:"使用场景图",order:4,type:"detail"}],Ee=[{title:"AI智能识别",description:"采用先进的人工智能技术，精准识别笔画轨迹，实时纠正书写错误，提供个性化指导建议。",icon:"Cpu"},{title:"数据分析系统",description:"全面记录学习数据，生成详细的学习报告，帮助教师了解学生进度，制定针对性教学计划。",icon:"DataAnalysis"},{title:"教育专用设计",description:"专为教育机构设计，支持多人同时使用，配备教师管理端，方便课堂教学和学生管理。",icon:"School"},{title:"智能教学模式",description:"内置多种教学模式，从基础笔画到复杂汉字，循序渐进，适应不同年龄段学生的学习需求。",icon:"Lightning"},{title:"护眼显示技术",description:"采用电子墨水屏技术，无蓝光伤害，长时间使用不疲劳，保护学生视力健康。",icon:"Monitor"}],ee={id:"1",name:"教育版练字机器人",model:"YX-EDU-2024",description:"专为教育机构设计的智能练字机器人，集成AI识别技术，提供个性化书法教学解决方案。",badge:"教育专版",features:["AI智能笔迹识别","实时书写指导","多人协作学习","学习进度跟踪","个性化课程推荐"],productFeatures:Ee,specifications:{dimensions:"420mm × 320mm × 180mm",weight:"2.8kg",display:"10.1英寸电子墨水屏",connectivity:"Wi-Fi 6, 蓝牙 5.0, USB-C",teaching:"手把手教学，实时纠错",recognition:"AI深度学习算法",courses:"内置3000+汉字课程",management:"云端管理平台"},price:2999,originalPrice:3999,prices:[{currency:"CNY",amount:2999,originalAmount:3999,discount:25},{currency:"USD",amount:420,originalAmount:560,discount:25}],images:Ue,highlights:["AI智能识别技术，准确率达99.5%","支持50人同时在线学习","内置专业书法教学课程","实时学习数据分析","护眼电子墨水屏设计"],status:"published",createdAt:"2024-01-15T08:00:00Z",updatedAt:"2024-02-20T10:30:00Z"},_e=[ee,L(E({},ee),{id:"2",name:"家庭版练字机器人",model:"YX-HOME-2024",description:"适合家庭使用的智能练字机器人，轻便易用，让孩子在家也能享受专业的书法指导。",badge:"家庭首选",price:1999,originalPrice:2499,status:"published"}),L(E({},ee),{id:"3",name:"专业版练字机器人",model:"YX-PRO-2024",description:"面向专业书法培训机构的高端产品，配备更多专业功能和高精度识别系统。",badge:"专业版",price:4999,originalPrice:5999,status:"draft"})];class se{static generateProducts(u=10){const r=[];for(let f=0;f<u;f++){const _=_e[f%_e.length];r.push(L(E({},_),{id:`product-${f+1}`,name:`${_.name} ${f+1}`,model:`${_.model}-${String(f+1).padStart(3,"0")}`,createdAt:new Date(Date.now()-Math.random()*365*24*60*60*1e3).toISOString(),updatedAt:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString()}))}return r}static generateProductCategories(){return[{id:"1",name:"教育版",description:"专为教育机构设计",count:5},{id:"2",name:"家庭版",description:"适合家庭使用",count:3},{id:"3",name:"专业版",description:"专业书法培训",count:2},{id:"4",name:"企业版",description:"企业培训专用",count:1}]}static generateProductReviews(u,r=10){const f=[],_=["产品质量很好，孩子很喜欢用来练字","AI识别很准确，确实能帮助改善书写","教学功能丰富，适合学校使用","设计人性化，操作简单易懂","性价比不错，推荐购买"];for(let h=0;h<r;h++)f.push({id:`review-${h+1}`,productId:u,userId:`user-${h+1}`,userName:`用户${h+1}`,rating:Math.floor(Math.random()*2)+4,content:_[h%_.length],createdAt:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toISOString()});return f}}const X=(p=500)=>new Promise(u=>setTimeout(u,p)),F=(p,u=200,r="success")=>({code:u,message:r,data:p,timestamp:Date.now()}),Ye={getProducts(p){return C(this,null,function*(){yield X();const{page:u=1,pageSize:r=10,keyword:f=""}=p||{};let _=se.generateProducts(30);f&&(_=_.filter(o=>o.name.includes(f)||o.description.includes(f)));const h=_.length,A=(u-1)*r,k=A+r,V=_.slice(A,k);return F({list:V,total:h,page:u,pageSize:r,totalPages:Math.ceil(h/r)})})},getProduct(p){return C(this,null,function*(){yield X();const r=se.generateProducts(30).find(f=>f.id===p);return r?F(r):F(null,404,"产品不存在")})},getProductCategories(){return C(this,null,function*(){yield X();const p=se.generateProductCategories();return F(p)})},getProductReviews(p,u){return C(this,null,function*(){yield X();const{page:r=1,pageSize:f=10}=u||{},_=se.generateProductReviews(p,50),h=_.length,A=(r-1)*f,k=A+f,V=_.slice(A,k);return F({list:V,total:h,page:r,pageSize:f,totalPages:Math.ceil(h/f)})})},createProduct(p){return C(this,null,function*(){yield X();const u=L(E(E({},ee),p),{id:`product-${Date.now()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});return F(u,201,"产品创建成功")})},updateProduct(p,u){return C(this,null,function*(){yield X();const r=L(E(E({},ee),u),{id:p,updatedAt:new Date().toISOString()});return F(r,200,"产品更新成功")})},deleteProduct(p){return C(this,null,function*(){return yield X(),F(null,200,"产品删除成功")})}},Oe={pending:"待确认",confirmed:"已确认",processing:"处理中",shipped:"已发货",delivered:"已送达",completed:"已完成",cancelled:"已取消"},Fe={pending:"待支付",paid:"已支付",failed:"支付失败",refunded:"已退款"},qe={class:"form-section"},ze={class:"form-section"},Re={class:"form-section"},Be={class:"section-title"},Le={class:"order-items"},Xe={key:0,class:"form-section"},je={class:"form-section"},He={class:"amount-summary"},Ze={class:"amount-item"},Ge={class:"value"},Ke={class:"amount-item"},Qe={class:"amount-item"},We={class:"amount-item total"},Je={class:"value"},xe={class:"form-section"},et={class:"dialog-footer"},tt=ve({__name:"OrderFormDialog",props:{modelValue:{type:Boolean},order:{}},emits:["update:modelValue","success"],setup(p,{emit:u}){const r=p,f=u,_=G(),h=G(!1),A=G(!1),k=G([]),V=G([]),o=G({type:"sales",orderNumber:"",customerId:"",customerName:"",customerPhone:"",customerEmail:"",deliveryAddress:"",items:[{productId:"",productName:"",quantity:1,unitPrice:0,totalPrice:0,notes:""}],shippingFee:0,discount:0,totalAmount:0,expectedDeliveryDate:"",salesPerson:"",notes:"",rentalStartDate:"",rentalEndDate:"",rentalDays:0,rentalNotes:""}),Q={type:[{required:!0,message:"请选择订单类型",trigger:"change"}],customerName:[{required:!0,message:"请输入客户姓名",trigger:"blur"}],customerPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],customerEmail:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],deliveryAddress:[{required:!0,message:"请输入收货地址",trigger:"blur"}],rentalStartDate:[{required:!0,message:"请选择租赁开始日期",trigger:"change"}],rentalEndDate:[{required:!0,message:"请选择租赁结束日期",trigger:"change"}]},j=J({get:()=>r.modelValue,set:i=>f("update:modelValue",i)}),H=J(()=>!!r.order),te=J(()=>o.value.items.reduce((i,s)=>i+(s.totalPrice||0),0)),U=()=>{o.value={type:"sales",orderNumber:"",customerId:"",customerName:"",customerPhone:"",customerEmail:"",deliveryAddress:"",items:[{productId:"",productName:"",quantity:1,unitPrice:0,totalPrice:0,notes:""}],shippingFee:0,discount:0,totalAmount:0,expectedDeliveryDate:"",salesPerson:"",notes:"",rentalStartDate:"",rentalEndDate:"",rentalDays:0,rentalNotes:""}},n=()=>{const s=new Date().getTime().toString().slice(-8),c=Math.floor(Math.random()*1e3).toString().padStart(3,"0");o.value.orderNumber=`ORD${s}${c}`};pe(()=>r.order,i=>{i?Object.assign(o.value,L(E({},i),{items:i.items||[{productId:"",productName:"",quantity:1,unitPrice:0,totalPrice:0,notes:""}]})):(U(),n())},{immediate:!0}),pe(()=>o.value.type,i=>{i==="rental"&&(Q.rentalStartDate=[{required:!0,message:"请选择租赁开始日期",trigger:"change"}],Q.rentalEndDate=[{required:!0,message:"请选择租赁结束日期",trigger:"change"}])});const a=()=>C(null,null,function*(){try{const i=yield Ye.getProducts({pageSize:100});V.value=i.data.list}catch(i){console.error("加载产品列表失败:",i)}}),q=i=>C(null,null,function*(){if(!i){k.value=[];return}A.value=!0;try{const s=yield Me.getCustomers({keyword:i,pageSize:20});k.value=s.data.list}catch(s){console.error("搜索客户失败:",s)}finally{A.value=!1}}),Z=i=>{const s=k.value.find(c=>c.id===i);s&&(o.value.customerName=s.name,o.value.customerPhone=s.phone,o.value.customerEmail=s.email,o.value.deliveryAddress=s.address)},z=(i,s)=>{const c=V.value.find(B=>B.id===i);c&&(o.value.items[s].productName=c.name,o.value.items[s].unitPrice=c.price,g(s))},re=()=>{o.value.items.push({productId:"",productName:"",quantity:1,unitPrice:0,totalPrice:0,notes:""})},de=i=>{o.value.items.length>1&&(o.value.items.splice(i,1),Y())},g=i=>{const s=o.value.items[i];s.totalPrice=(s.quantity||0)*(s.unitPrice||0),Y()},Y=()=>{const i=te.value,s=o.value.shippingFee||0,c=o.value.discount||0;o.value.totalAmount=Math.max(0,i+s-c)},$=()=>{if(o.value.rentalStartDate&&o.value.rentalEndDate){const i=new Date(o.value.rentalStartDate),c=new Date(o.value.rentalEndDate).getTime()-i.getTime(),B=Math.ceil(c/(1e3*60*60*24));o.value.rentalDays=Math.max(0,B)}},R=()=>C(null,null,function*(){try{yield _.value.validate(),h.value=!0,H.value?(yield me.updateOrder(r.order.id,o.value),K.success("订单更新成功")):(yield me.createOrder(o.value),K.success("订单创建成功")),f("success"),W()}catch(i){console.error("提交失败:",i),i!==!1&&K.error("操作失败，请重试")}finally{h.value=!1}}),W=()=>{j.value=!1,Te(()=>{var i;(i=_.value)==null||i.resetFields()})},ie=()=>C(null,null,function*(){yield a(),H.value||n()});return pe(j,i=>{i&&ie()}),(i,s)=>{const c=v("el-option"),B=v("el-select"),w=v("el-form-item"),y=v("el-col"),N=v("el-input"),T=v("el-row"),ce=v("el-icon"),le=v("el-button"),ae=v("el-input-number"),ue=v("el-date-picker"),be=v("el-form"),he=v("el-dialog");return b(),M(he,{modelValue:j.value,"onUpdate:modelValue":s[15]||(s[15]=d=>j.value=d),title:H.value?"编辑订单":"创建销售订单",width:"900px","close-on-click-modal":!1,onClose:W},{footer:t(()=>[l("div",et,[e(le,{onClick:W},{default:t(()=>s[27]||(s[27]=[D("取消",-1)])),_:1,__:[27]}),e(le,{type:"primary",onClick:R,loading:h.value},{default:t(()=>[D(m(H.value?"更新订单":"创建订单"),1)]),_:1},8,["loading"])])]),default:t(()=>[e(be,{ref_key:"formRef",ref:_,model:o.value,rules:Q,"label-width":"120px","label-position":"left"},{default:t(()=>[l("div",qe,[s[16]||(s[16]=l("h4",{class:"section-title"},"基本信息",-1)),e(T,{gutter:24},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(w,{label:"订单类型",prop:"type"},{default:t(()=>[e(B,{modelValue:o.value.type,"onUpdate:modelValue":s[0]||(s[0]=d=>o.value.type=d),placeholder:"请选择订单类型",style:{width:"100%"}},{default:t(()=>[e(c,{label:"销售订单",value:"sales"}),e(c,{label:"租赁订单",value:"rental"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(w,{label:"订单号",prop:"orderNumber"},{default:t(()=>[e(N,{modelValue:o.value.orderNumber,"onUpdate:modelValue":s[1]||(s[1]=d=>o.value.orderNumber=d),placeholder:"系统自动生成",disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),l("div",ze,[s[17]||(s[17]=l("h4",{class:"section-title"},"客户信息",-1)),e(T,{gutter:24},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(w,{label:"客户选择",prop:"customerId"},{default:t(()=>[e(B,{modelValue:o.value.customerId,"onUpdate:modelValue":s[2]||(s[2]=d=>o.value.customerId=d),placeholder:"请选择客户",filterable:"",remote:"","remote-method":q,loading:A.value,style:{width:"100%"},onChange:Z},{default:t(()=>[(b(!0),I(oe,null,ne(k.value,d=>(b(),M(c,{key:d.id,label:`${d.name} (${d.phone})`,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(w,{label:"客户姓名",prop:"customerName"},{default:t(()=>[e(N,{modelValue:o.value.customerName,"onUpdate:modelValue":s[3]||(s[3]=d=>o.value.customerName=d),placeholder:"请输入客户姓名",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:24},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(w,{label:"联系电话",prop:"customerPhone"},{default:t(()=>[e(N,{modelValue:o.value.customerPhone,"onUpdate:modelValue":s[4]||(s[4]=d=>o.value.customerPhone=d),placeholder:"请输入联系电话",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(w,{label:"客户邮箱",prop:"customerEmail"},{default:t(()=>[e(N,{modelValue:o.value.customerEmail,"onUpdate:modelValue":s[5]||(s[5]=d=>o.value.customerEmail=d),placeholder:"请输入客户邮箱",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:24},{default:t(()=>[e(y,{span:24},{default:t(()=>[e(w,{label:"收货地址",prop:"deliveryAddress"},{default:t(()=>[e(N,{modelValue:o.value.deliveryAddress,"onUpdate:modelValue":s[6]||(s[6]=d=>o.value.deliveryAddress=d),type:"textarea",rows:2,placeholder:"请输入详细的收货地址",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),l("div",Re,[l("h4",Be,[s[19]||(s[19]=D(" 商品信息 ",-1)),e(le,{type:"primary",size:"small",onClick:re},{default:t(()=>[e(ce,null,{default:t(()=>[e(x(Se))]),_:1}),s[18]||(s[18]=D(" 添加商品 ",-1))]),_:1,__:[18]})]),l("div",Le,[(b(!0),I(oe,null,ne(o.value.items,(d,O)=>(b(),I("div",{key:O,class:"order-item"},[e(T,{gutter:16,align:"middle"},{default:t(()=>[e(y,{span:6},{default:t(()=>[e(w,{prop:`items.${O}.productId`,rules:[{required:!0,message:"请选择产品",trigger:"change"}],label:"产品型号"},{default:t(()=>[e(B,{modelValue:d.productId,"onUpdate:modelValue":P=>d.productId=P,placeholder:"请选择产品",filterable:"",style:{width:"100%"},onChange:P=>z(P,O)},{default:t(()=>[(b(!0),I(oe,null,ne(V.value,P=>(b(),M(c,{key:P.id,label:P.name,value:P.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["prop"])]),_:2},1024),e(y,{span:3},{default:t(()=>[e(w,{prop:`items.${O}.quantity`,rules:[{required:!0,message:"请输入数量",trigger:"blur"}],label:"数量"},{default:t(()=>[e(ae,{modelValue:d.quantity,"onUpdate:modelValue":P=>d.quantity=P,min:1,max:999,style:{width:"100%"},onChange:()=>g(O)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["prop"])]),_:2},1024),e(y,{span:4},{default:t(()=>[e(w,{prop:`items.${O}.unitPrice`,rules:[{required:!0,message:"请输入单价",trigger:"blur"}],label:"单价"},{default:t(()=>[e(ae,{modelValue:d.unitPrice,"onUpdate:modelValue":P=>d.unitPrice=P,min:0,precision:2,style:{width:"100%"},onChange:()=>g(O)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["prop"])]),_:2},1024),e(y,{span:4},{default:t(()=>[e(w,{label:"小计"},{default:t(()=>{var P;return[e(N,{value:`¥${((P=d.totalPrice)==null?void 0:P.toFixed(2))||"0.00"}`,disabled:"",style:{width:"100%"}},null,8,["value"])]}),_:2},1024)]),_:2},1024),e(y,{span:5},{default:t(()=>[e(w,{label:"备注"},{default:t(()=>[e(N,{modelValue:d.notes,"onUpdate:modelValue":P=>d.notes=P,placeholder:"商品备注",maxlength:"100",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(y,{span:2},{default:t(()=>[e(w,{label:" "},{default:t(()=>[e(le,{type:"danger",size:"small",text:"",onClick:P=>de(O),disabled:o.value.items.length<=1},{default:t(()=>[e(ce,null,{default:t(()=>[e(x(Ae))]),_:1})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])]),o.value.type==="rental"?(b(),I("div",Xe,[s[20]||(s[20]=l("h4",{class:"section-title"},"租赁信息",-1)),e(T,{gutter:24},{default:t(()=>[e(y,{span:8},{default:t(()=>[e(w,{label:"租赁开始日期",prop:"rentalStartDate"},{default:t(()=>[e(ue,{modelValue:o.value.rentalStartDate,"onUpdate:modelValue":s[7]||(s[7]=d=>o.value.rentalStartDate=d),type:"date",placeholder:"选择开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"},onChange:$},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:8},{default:t(()=>[e(w,{label:"租赁结束日期",prop:"rentalEndDate"},{default:t(()=>[e(ue,{modelValue:o.value.rentalEndDate,"onUpdate:modelValue":s[8]||(s[8]=d=>o.value.rentalEndDate=d),type:"date",placeholder:"选择结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"},onChange:$},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:8},{default:t(()=>[e(w,{label:"租赁天数"},{default:t(()=>[e(N,{value:`${o.value.rentalDays||0} 天`,disabled:"",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:24},{default:t(()=>[e(y,{span:24},{default:t(()=>[e(w,{label:"租赁备注"},{default:t(()=>[e(N,{modelValue:o.value.rentalNotes,"onUpdate:modelValue":s[9]||(s[9]=d=>o.value.rentalNotes=d),type:"textarea",rows:2,placeholder:"租赁相关备注信息",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])):S("",!0),l("div",je,[s[25]||(s[25]=l("h4",{class:"section-title"},"订单金额",-1)),l("div",He,[e(T,{gutter:24},{default:t(()=>[e(y,{span:6},{default:t(()=>[l("div",Ze,[s[21]||(s[21]=l("span",{class:"label"},"商品小计:",-1)),l("span",Ge,"¥"+m(te.value.toFixed(2)),1)])]),_:1}),e(y,{span:6},{default:t(()=>[l("div",Ke,[s[22]||(s[22]=l("span",{class:"label"},"运费:",-1)),e(ae,{modelValue:o.value.shippingFee,"onUpdate:modelValue":s[10]||(s[10]=d=>o.value.shippingFee=d),min:0,precision:2,size:"small",onChange:Y},null,8,["modelValue"])])]),_:1}),e(y,{span:6},{default:t(()=>[l("div",Qe,[s[23]||(s[23]=l("span",{class:"label"},"折扣:",-1)),e(ae,{modelValue:o.value.discount,"onUpdate:modelValue":s[11]||(s[11]=d=>o.value.discount=d),min:0,precision:2,size:"small",onChange:Y},null,8,["modelValue"])])]),_:1}),e(y,{span:6},{default:t(()=>[l("div",We,[s[24]||(s[24]=l("span",{class:"label"},"订单总额:",-1)),l("span",Je,"¥"+m(o.value.totalAmount.toFixed(2)),1)])]),_:1})]),_:1})])]),l("div",xe,[s[26]||(s[26]=l("h4",{class:"section-title"},"其他信息",-1)),e(T,{gutter:24},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(w,{label:"预计交付日期",prop:"expectedDeliveryDate"},{default:t(()=>[e(ue,{modelValue:o.value.expectedDeliveryDate,"onUpdate:modelValue":s[12]||(s[12]=d=>o.value.expectedDeliveryDate=d),type:"date",placeholder:"选择预计交付日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(w,{label:"销售人员",prop:"salesPerson"},{default:t(()=>[e(N,{modelValue:o.value.salesPerson,"onUpdate:modelValue":s[13]||(s[13]=d=>o.value.salesPerson=d),placeholder:"请输入销售人员姓名",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:24},{default:t(()=>[e(y,{span:24},{default:t(()=>[e(w,{label:"订单备注"},{default:t(()=>[e(N,{modelValue:o.value.notes,"onUpdate:modelValue":s[14]||(s[14]=d=>o.value.notes=d),type:"textarea",rows:3,placeholder:"订单相关备注信息",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),yl=ye(tt,[["__scopeId","data-v-ad90e68d"]]),lt={key:0,class:"order-detail"},at={class:"detail-section"},st={class:"section-header"},ot={class:"order-actions"},nt={class:"info-item"},rt={class:"value"},dt={class:"info-item"},it={class:"info-item"},ut={class:"info-item"},pt={class:"value"},mt={class:"info-item"},ct={class:"value"},ft={class:"info-item"},gt={class:"value"},_t={class:"detail-section"},vt={class:"info-item"},yt={class:"value"},bt={class:"info-item"},ht={class:"value"},wt={class:"info-item"},Dt={class:"value"},Vt={class:"info-item"},Pt={class:"value"},kt={class:"detail-section"},St={key:0,class:"detail-section"},At={class:"info-item"},Ct={class:"value"},It={class:"info-item"},$t={class:"value"},Nt={class:"info-item"},Mt={class:"value"},Tt={class:"info-item"},Ut={class:"value"},Et={class:"detail-section"},Yt={class:"amount-summary"},Ot={class:"amount-item"},Ft={class:"value"},qt={class:"amount-item"},zt={class:"value"},Rt={class:"amount-item"},Bt={class:"value"},Lt={class:"amount-item total"},Xt={class:"value"},jt={key:1,class:"detail-section"},Ht={class:"info-item"},Zt={class:"info-item"},Gt={class:"value"},Kt={class:"info-item"},Qt={class:"value"},Wt={key:2,class:"detail-section"},Jt={class:"info-item"},xt={class:"value"},el={class:"info-item"},tl={class:"value"},ll={class:"info-item"},al={class:"value"},sl={key:3,class:"detail-section"},ol={class:"notes-content"},nl={key:4,class:"detail-section"},rl={class:"log-content"},dl={class:"log-action"},il={class:"log-operator"},ul={key:0,class:"log-notes"},pl={class:"dialog-footer"},ml=ve({__name:"OrderDetailDialog",props:{modelValue:{type:Boolean},order:{}},emits:["update:modelValue","edit","status-change"],setup(p,{emit:u}){const r=p,f=u,_=J({get:()=>r.modelValue,set:n=>f("update:modelValue",n)}),h=J(()=>{var n;return(n=r.order)!=null&&n.items?r.order.items.reduce((a,q)=>a+(q.totalPrice||0),0):0}),A=()=>{r.order&&f("edit",r.order)},k=n=>C(null,null,function*(){if(r.order)try{let a="";switch(n){case"confirm":a="确定要确认这个订单吗？";break;case"ship":a="确定要标记为已发货吗？";break;case"deliver":a="确定要标记为已送达吗？";break;case"complete":a="确定要完成这个订单吗？";break;case"cancel":a="确定要取消这个订单吗？";break}yield Ne.confirm(a,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield me.updateOrderStatus(r.order.id,n),K.success("操作成功"),f("status-change")}catch(a){a!=="cancel"&&(console.error("状态更新失败:",a),K.error("操作失败"))}}),V=()=>{K.info("打印功能开发中...")},o=n=>({pending:"warning",confirmed:"primary",processing:"primary",shipped:"info",delivered:"success",completed:"success",cancelled:"danger"})[n]||"info",Q=n=>Oe[n]||n,j=n=>({pending:"warning",paid:"success",failed:"danger",refunded:"info"})[n||""]||"info",H=n=>Fe[n]||n||"未知",te=n=>({创建订单:"primary",确认订单:"success",发货:"info",送达:"success",完成:"success",取消:"danger"})[n]||"primary",U=n=>n?new Date(n).toLocaleString("zh-CN"):"-";return(n,a)=>{const q=v("el-icon"),Z=v("el-button"),z=v("el-dropdown-item"),re=v("el-dropdown-menu"),de=v("el-dropdown"),g=v("el-col"),Y=v("el-tag"),$=v("el-row"),R=v("el-table-column"),W=v("el-table"),ie=v("el-timeline-item"),i=v("el-timeline"),s=v("el-dialog");return b(),M(s,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=c=>_.value=c),title:"订单详情",width:"1000px","close-on-click-modal":!1},{footer:t(()=>[l("div",pl,[e(Z,{onClick:a[0]||(a[0]=c=>_.value=!1)},{default:t(()=>a[42]||(a[42]=[D("关闭",-1)])),_:1,__:[42]}),e(Z,{type:"primary",onClick:V},{default:t(()=>[e(q,null,{default:t(()=>[e(x($e))]),_:1}),a[43]||(a[43]=D(" 打印订单 ",-1))]),_:1,__:[43]})])]),default:t(()=>[n.order?(b(),I("div",lt,[l("div",at,[l("div",st,[a[9]||(a[9]=l("h3",null,"订单信息",-1)),l("div",ot,[e(Z,{type:"primary",size:"small",onClick:A},{default:t(()=>[e(q,null,{default:t(()=>[e(x(Ce))]),_:1}),a[2]||(a[2]=D(" 编辑订单 ",-1))]),_:1,__:[2]}),e(de,{onCommand:k,trigger:"click"},{dropdown:t(()=>[e(re,null,{default:t(()=>[n.order.status==="pending"?(b(),M(z,{key:0,command:"confirm"},{default:t(()=>a[4]||(a[4]=[D(" 确认订单 ",-1)])),_:1,__:[4]})):S("",!0),n.order.status==="confirmed"?(b(),M(z,{key:1,command:"ship"},{default:t(()=>a[5]||(a[5]=[D(" 发货 ",-1)])),_:1,__:[5]})):S("",!0),n.order.status==="shipped"?(b(),M(z,{key:2,command:"deliver"},{default:t(()=>a[6]||(a[6]=[D(" 确认送达 ",-1)])),_:1,__:[6]})):S("",!0),n.order.status==="delivered"?(b(),M(z,{key:3,command:"complete"},{default:t(()=>a[7]||(a[7]=[D(" 完成订单 ",-1)])),_:1,__:[7]})):S("",!0),["pending","confirmed"].includes(n.order.status)?(b(),M(z,{key:4,command:"cancel"},{default:t(()=>a[8]||(a[8]=[D(" 取消订单 ",-1)])),_:1,__:[8]})):S("",!0)]),_:1})]),default:t(()=>[e(Z,{size:"small"},{default:t(()=>[a[3]||(a[3]=D(" 状态操作",-1)),e(q,{class:"el-icon--right"},{default:t(()=>[e(x(Ie))]),_:1})]),_:1,__:[3]})]),_:1})])]),e($,{gutter:24},{default:t(()=>[e(g,{span:8},{default:t(()=>[l("div",nt,[a[10]||(a[10]=l("span",{class:"label"},"订单号:",-1)),l("span",rt,m(n.order.orderNumber),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",dt,[a[11]||(a[11]=l("span",{class:"label"},"订单类型:",-1)),e(Y,{type:n.order.type==="sales"?"success":"primary",size:"small"},{default:t(()=>[D(m(n.order.type==="sales"?"销售订单":"租赁订单"),1)]),_:1},8,["type"])])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",it,[a[12]||(a[12]=l("span",{class:"label"},"订单状态:",-1)),e(Y,{type:o(n.order.status),size:"small"},{default:t(()=>[D(m(Q(n.order.status)),1)]),_:1},8,["type"])])]),_:1})]),_:1}),e($,{gutter:24},{default:t(()=>[e(g,{span:8},{default:t(()=>[l("div",ut,[a[13]||(a[13]=l("span",{class:"label"},"创建时间:",-1)),l("span",pt,m(U(n.order.createdAt)),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",mt,[a[14]||(a[14]=l("span",{class:"label"},"预计交付:",-1)),l("span",ct,m(U(n.order.expectedDeliveryDate)||"-"),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",ft,[a[15]||(a[15]=l("span",{class:"label"},"销售人员:",-1)),l("span",gt,m(n.order.salesPerson||"-"),1)])]),_:1})]),_:1})]),l("div",_t,[a[20]||(a[20]=l("h3",null,"客户信息",-1)),e($,{gutter:24},{default:t(()=>[e(g,{span:12},{default:t(()=>[l("div",vt,[a[16]||(a[16]=l("span",{class:"label"},"客户姓名:",-1)),l("span",yt,m(n.order.customerName),1)])]),_:1}),e(g,{span:12},{default:t(()=>[l("div",bt,[a[17]||(a[17]=l("span",{class:"label"},"联系电话:",-1)),l("span",ht,m(n.order.customerPhone),1)])]),_:1})]),_:1}),e($,{gutter:24},{default:t(()=>[e(g,{span:12},{default:t(()=>[l("div",wt,[a[18]||(a[18]=l("span",{class:"label"},"客户邮箱:",-1)),l("span",Dt,m(n.order.customerEmail||"-"),1)])]),_:1}),e(g,{span:12},{default:t(()=>[l("div",Vt,[a[19]||(a[19]=l("span",{class:"label"},"收货地址:",-1)),l("span",Pt,m(n.order.deliveryAddress),1)])]),_:1})]),_:1})]),l("div",kt,[a[21]||(a[21]=l("h3",null,"商品信息",-1)),e(W,{data:n.order.items,border:""},{default:t(()=>[e(R,{prop:"productName",label:"产品名称"}),e(R,{prop:"quantity",label:"数量",width:"100",align:"center"}),e(R,{prop:"unitPrice",label:"单价",width:"120",align:"right"},{default:t(({row:c})=>[D(" ¥"+m(c.unitPrice.toFixed(2)),1)]),_:1}),e(R,{prop:"totalPrice",label:"小计",width:"120",align:"right"},{default:t(({row:c})=>[D(" ¥"+m(c.totalPrice.toFixed(2)),1)]),_:1}),e(R,{prop:"notes",label:"备注"})]),_:1},8,["data"])]),n.order.type==="rental"?(b(),I("div",St,[a[26]||(a[26]=l("h3",null,"租赁信息",-1)),e($,{gutter:24},{default:t(()=>[e(g,{span:8},{default:t(()=>[l("div",At,[a[22]||(a[22]=l("span",{class:"label"},"租赁开始日期:",-1)),l("span",Ct,m(U(n.order.rentalStartDate)),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",It,[a[23]||(a[23]=l("span",{class:"label"},"租赁结束日期:",-1)),l("span",$t,m(U(n.order.rentalEndDate)),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",Nt,[a[24]||(a[24]=l("span",{class:"label"},"租赁天数:",-1)),l("span",Mt,m(n.order.rentalDays)+" 天",1)])]),_:1})]),_:1}),n.order.rentalNotes?(b(),M($,{key:0,gutter:24},{default:t(()=>[e(g,{span:24},{default:t(()=>[l("div",Tt,[a[25]||(a[25]=l("span",{class:"label"},"租赁备注:",-1)),l("span",Ut,m(n.order.rentalNotes),1)])]),_:1})]),_:1})):S("",!0)])):S("",!0),l("div",Et,[a[31]||(a[31]=l("h3",null,"金额信息",-1)),l("div",Yt,[e($,{gutter:24},{default:t(()=>[e(g,{span:6},{default:t(()=>[l("div",Ot,[a[27]||(a[27]=l("span",{class:"label"},"商品小计:",-1)),l("span",Ft,"¥"+m(h.value.toFixed(2)),1)])]),_:1}),e(g,{span:6},{default:t(()=>[l("div",qt,[a[28]||(a[28]=l("span",{class:"label"},"运费:",-1)),l("span",zt,"¥"+m((n.order.shippingFee||0).toFixed(2)),1)])]),_:1}),e(g,{span:6},{default:t(()=>[l("div",Rt,[a[29]||(a[29]=l("span",{class:"label"},"折扣:",-1)),l("span",Bt,"-¥"+m((n.order.discount||0).toFixed(2)),1)])]),_:1}),e(g,{span:6},{default:t(()=>[l("div",Lt,[a[30]||(a[30]=l("span",{class:"label"},"订单总额:",-1)),l("span",Xt,"¥"+m(n.order.totalAmount.toFixed(2)),1)])]),_:1})]),_:1})])]),n.order.paymentStatus?(b(),I("div",jt,[a[35]||(a[35]=l("h3",null,"支付信息",-1)),e($,{gutter:24},{default:t(()=>[e(g,{span:8},{default:t(()=>[l("div",Ht,[a[32]||(a[32]=l("span",{class:"label"},"支付状态:",-1)),e(Y,{type:j(n.order.paymentStatus),size:"small"},{default:t(()=>[D(m(H(n.order.paymentStatus)),1)]),_:1},8,["type"])])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",Zt,[a[33]||(a[33]=l("span",{class:"label"},"支付方式:",-1)),l("span",Gt,m(n.order.paymentMethod||"-"),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",Kt,[a[34]||(a[34]=l("span",{class:"label"},"支付时间:",-1)),l("span",Qt,m(U(n.order.paymentTime)||"-"),1)])]),_:1})]),_:1})])):S("",!0),n.order.shippingInfo?(b(),I("div",Wt,[a[39]||(a[39]=l("h3",null,"物流信息",-1)),e($,{gutter:24},{default:t(()=>[e(g,{span:8},{default:t(()=>[l("div",Jt,[a[36]||(a[36]=l("span",{class:"label"},"物流公司:",-1)),l("span",xt,m(n.order.shippingInfo.company||"-"),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",el,[a[37]||(a[37]=l("span",{class:"label"},"运单号:",-1)),l("span",tl,m(n.order.shippingInfo.trackingNumber||"-"),1)])]),_:1}),e(g,{span:8},{default:t(()=>[l("div",ll,[a[38]||(a[38]=l("span",{class:"label"},"发货时间:",-1)),l("span",al,m(U(n.order.shippingInfo.shippedAt)||"-"),1)])]),_:1})]),_:1})])):S("",!0),n.order.notes?(b(),I("div",sl,[a[40]||(a[40]=l("h3",null,"订单备注",-1)),l("div",ol,[l("p",null,m(n.order.notes),1)])])):S("",!0),n.order.logs&&n.order.logs.length>0?(b(),I("div",nl,[a[41]||(a[41]=l("h3",null,"操作日志",-1)),e(i,null,{default:t(()=>[(b(!0),I(oe,null,ne(n.order.logs,c=>(b(),M(ie,{key:c.id,timestamp:U(c.createdAt),type:te(c.action)},{default:t(()=>[l("div",rl,[l("div",dl,m(c.action),1),l("div",il,"操作人: "+m(c.operator),1),c.notes?(b(),I("div",ul,m(c.notes),1)):S("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):S("",!0)])):S("",!0)]),_:1},8,["modelValue"])}}}),bl=ye(ml,[["__scopeId","data-v-2ebf6966"]]);export{yl as O,Fe as P,bl as a,Oe as b};
