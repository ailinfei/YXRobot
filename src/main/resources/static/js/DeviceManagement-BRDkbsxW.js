var Ge=Object.defineProperty;var Le=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var Re=(i,o,n)=>o in i?Ge(i,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[o]=n,ue=(i,o)=>{for(var n in o||(o={}))We.call(o,n)&&Re(i,n,o[n]);if(Le)for(var n of Le(o))Je.call(o,n)&&Re(i,n,o[n]);return i};var D=(i,o,n)=>new Promise((_,C)=>{var Y=M=>{try{U(n.next(M))}catch(L){C(L)}},F=M=>{try{U(n.throw(M))}catch(L){C(L)}},U=M=>M.done?_(M.value):Promise.resolve(M.value).then(Y,F);U((n=n.apply(i,o)).next())});import{a1 as De,aa as $e,ab as Ce,t as Be,k as ke,b as z,r as Xe,a5 as Ke,ac as Qe,x as Ae,m as Fe,j as Ze,n as Ye}from"./element-plus-B_LfhBgj.js";import O from"./request-mSVS5ma3.js";import{x as ce,c as ge,al as w,H as E,z as m,I as a,y as S,K as I,A as e,O as c,Q as t,M as g,D as Ue,u as N,P as le,a6 as oe,r as V,j as Se,n as xe,ar as Pe,J as Ee,L as et,B as tt,h as lt}from"./vue-C2NPAEWw.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-T70AYnHr.js";const A={getDevices(){return D(this,arguments,function*(i={}){var o,n;try{const _=yield O.get("/api/admin/devices",{params:{page:i.page||1,pageSize:i.pageSize||20,keyword:i.keyword||"",status:i.status||"",model:i.model||"",customerId:i.customerId||"",sortBy:i.sortBy||"createdAt",sortOrder:i.sortOrder||"desc",startDate:((o=i.dateRange)==null?void 0:o[0])||"",endDate:((n=i.dateRange)==null?void 0:n[1])||""}});if(_.code===200)return _.data;throw new Error(_.message||"获取设备列表失败")}catch(_){throw console.error("获取设备列表失败:",_),_}})},getDeviceById(i){return D(this,null,function*(){try{const o=yield O.get(`/api/admin/devices/${i}`);if(o.code===200)return o.data;throw new Error(o.message||"获取设备详情失败")}catch(o){throw console.error("获取设备详情失败:",o),o}})},getDeviceBySerialNumber(i){return D(this,null,function*(){try{const o=yield O.get(`/api/admin/devices/serial/${i}`);if(o.code===200)return o.data;throw new Error(o.message||"获取设备信息失败")}catch(o){throw console.error("根据序列号获取设备失败:",o),o}})},createDevice(i){return D(this,null,function*(){try{const o=yield O.post("/api/admin/devices",{serialNumber:i.serialNumber,model:i.model,customerId:i.customerId,firmwareVersion:i.firmwareVersion||"1.0.0",specifications:i.specifications,configuration:i.configuration,location:i.location,notes:i.notes});if(o.code===200)return o.data;throw new Error(o.message||"创建设备失败")}catch(o){throw console.error("创建设备失败:",o),o}})},updateDevice(i,o){return D(this,null,function*(){try{const n=yield O.put(`/api/admin/devices/${i}`,o);if(n.code===200)return n.data;throw new Error(n.message||"更新设备失败")}catch(n){throw console.error("更新设备失败:",n),n}})},deleteDevice(i){return D(this,null,function*(){try{const o=yield O.delete(`/api/admin/devices/${i}`);if(o.code!==200)throw new Error(o.message||"删除设备失败")}catch(o){throw console.error("删除设备失败:",o),o}})},updateDeviceStatus(i,o){return D(this,null,function*(){try{const n=yield O.patch(`/api/admin/devices/${i}/status`,{status:o});if(n.code===200)return n.data;throw new Error(n.message||"更新设备状态失败")}catch(n){throw console.error("更新设备状态失败:",n),n}})},rebootDevice(i){return D(this,null,function*(){try{const o=yield O.post(`/api/admin/devices/${i}/reboot`);if(o.code===200)return o.data;throw new Error(o.message||"重启设备失败")}catch(o){throw console.error("重启设备失败:",o),o}})},activateDevice(i){return D(this,null,function*(){try{const o=yield O.post(`/api/admin/devices/${i}/activate`);if(o.code===200)return o.data;throw new Error(o.message||"激活设备失败")}catch(o){throw console.error("激活设备失败:",o),o}})},pushFirmware(i,o){return D(this,null,function*(){try{const n=yield O.post(`/api/admin/devices/${i}/firmware`,{version:o});if(n.code===200)return n.data;throw new Error(n.message||"推送固件失败")}catch(n){throw console.error("推送固件失败:",n),n}})},getDeviceLogs(i,o){return D(this,null,function*(){var n,_;try{const C=yield O.get(`/api/admin/devices/${i}/logs`,{params:{page:(o==null?void 0:o.page)||1,pageSize:(o==null?void 0:o.pageSize)||20,level:(o==null?void 0:o.level)||"",category:(o==null?void 0:o.category)||"",startDate:((n=o==null?void 0:o.dateRange)==null?void 0:n[0])||"",endDate:((_=o==null?void 0:o.dateRange)==null?void 0:_[1])||""}});if(C.code===200)return C.data;throw new Error(C.message||"获取设备日志失败")}catch(C){throw console.error("获取设备日志失败:",C),C}})},getDeviceStats(i){return D(this,null,function*(){try{const o=yield O.get("/api/admin/devices/stats",{params:{startDate:(i==null?void 0:i.startDate)||"",endDate:(i==null?void 0:i.endDate)||""}});if(o.code===200)return o.data;throw new Error(o.message||"获取设备统计失败")}catch(o){throw console.error("获取设备统计失败:",o),o}})},getCustomerOptions(){return D(this,null,function*(){try{const i=yield O.get("/api/admin/customers/options");if(i.code===200)return i.data;throw new Error(i.message||"获取客户选项失败")}catch(i){throw console.error("获取客户选项失败:",i),i}})},batchPushFirmware(i,o){return D(this,null,function*(){try{const n=yield O.post("/api/admin/devices/batch/firmware",{deviceIds:i.map(_=>String(_)),version:o});if(n.code===200)return n.data;throw new Error(n.message||"批量推送固件失败")}catch(n){throw console.error("批量推送固件失败:",n),n}})},batchRebootDevices(i){return D(this,null,function*(){try{const o=yield O.post("/api/admin/devices/batch/reboot",{deviceIds:i.map(n=>String(n))});if(o.code===200)return o.data;throw new Error(o.message||"批量重启设备失败")}catch(o){throw console.error("批量重启设备失败:",o),o}})},batchDeleteDevices(i){return D(this,null,function*(){try{const o=yield O.delete("/api/admin/devices/batch",{data:{deviceIds:i.map(n=>String(n))}});if(o.code===200)return o.data;throw new Error(o.message||"批量删除设备失败")}catch(o){throw console.error("批量删除设备失败:",o),o}})},exportDevices(i){return D(this,null,function*(){var o,n;try{const _=yield O.get("/api/admin/devices/export",{params:{keyword:i.keyword||"",status:i.status||"",model:i.model||"",customerId:i.customerId||"",startDate:((o=i.dateRange)==null?void 0:o[0])||"",endDate:((n=i.dateRange)==null?void 0:n[1])||""}});if(_.code===200)return _.data;throw new Error(_.message||"导出设备数据失败")}catch(_){throw console.error("导出设备数据失败:",_),_}})},addMaintenanceRecord(i,o){return D(this,null,function*(){try{const n=yield O.post(`/api/admin/devices/${i}/maintenance`,o);if(n.code===200)return n.data;throw new Error(n.message||"添加维护记录失败")}catch(n){throw console.error("添加维护记录失败:",n),n}})},updateMaintenanceRecord(i,o,n){return D(this,null,function*(){try{const _=yield O.put(`/api/admin/devices/${i}/maintenance/${o}`,n);if(_.code===200)return _.data;throw new Error(_.message||"更新维护记录失败")}catch(_){throw console.error("更新维护记录失败:",_),_}})},getMaintenanceRecords(i,o){return D(this,null,function*(){try{const n=yield O.get(`/api/admin/devices/${i}/maintenance`,{params:{page:(o==null?void 0:o.page)||1,pageSize:(o==null?void 0:o.pageSize)||20,type:(o==null?void 0:o.type)||"",status:(o==null?void 0:o.status)||""}});if(n.code===200)return n.data;throw new Error(n.message||"获取维护记录失败")}catch(n){throw console.error("获取维护记录失败:",n),n}})}},ot={key:0,class:"device-detail"},st={class:"detail-section"},at={class:"info-grid"},nt={class:"info-item"},it={class:"info-item"},rt={class:"info-item"},dt={class:"status-display"},ut={class:"info-item"},ct={class:"info-item"},vt={class:"customer-name"},mt={class:"customer-phone"},pt={class:"info-item"},ft={class:"info-item"},gt={class:"info-item"},_t={key:0,class:"detail-section"},yt={class:"info-grid"},bt={class:"info-item"},wt={class:"info-item"},ht={class:"info-item"},Vt={class:"info-item"},Dt={class:"info-item"},$t={class:"info-item"},Ct={class:"connectivity-tags"},kt={key:1,class:"detail-section"},St={class:"info-grid"},Et={class:"info-item"},Ut={class:"info-item"},zt={class:"info-item"},Tt={class:"info-item"},Mt={key:2,class:"detail-section"},Nt={class:"maintenance-list"},It={class:"maintenance-header"},Ot={class:"maintenance-time"},Lt={class:"maintenance-content"},Rt={class:"maintenance-desc"},At={class:"maintenance-details"},Ft={class:"technician"},Yt={key:0,class:"cost"},Bt={key:0,class:"parts"},Xt={key:3,class:"detail-section"},Pt={class:"info-grid"},qt={class:"info-item"},Ht={class:"info-item"},jt={class:"info-item"},Gt={class:"info-item"},Wt={key:4,class:"detail-section"},Jt={class:"info-grid"},Kt={class:"info-item"},Qt={class:"info-item"},Zt={class:"info-item"},xt={key:5,class:"detail-section"},el={class:"notes-content"},tl={class:"dialog-footer"},ll=ce({__name:"DeviceDetailDialog",props:{modelValue:{type:Boolean},device:{}},emits:["update:modelValue","edit","status-change"],setup(i,{emit:o}){const n=i,_=o,C=ge({get:()=>n.modelValue,set:l=>_("update:modelValue",l)}),Y=()=>{C.value=!1},F=()=>{n.device&&_("edit",n.device)},U=l=>D(null,null,function*(){if(n.device)try{switch(l){case"reboot":yield A.rebootDevice(n.device.id),z.success("设备重启指令已发送");break;case"maintenance":yield A.updateDeviceStatus(n.device.id,"maintenance"),z.success("设备已进入维护模式"),_("status-change");break;case"activate":yield A.activateDevice(n.device.id),z.success("设备激活指令已发送"),_("status-change");break;case"firmware":yield A.pushFirmware(n.device.id),z.success("固件推送已启动");break}}catch(s){console.error("设备操作失败:",s),z.error((s==null?void 0:s.message)||"操作失败")}}),M=l=>({"YX-EDU-2024":"primary","YX-HOME-2024":"success","YX-PRO-2024":"warning"})[l]||"info",L=l=>({"YX-EDU-2024":"教育版","YX-HOME-2024":"家庭版","YX-PRO-2024":"专业版"})[l]||l,P=l=>({online:"online",offline:"offline",error:"error",maintenance:"maintenance"})[l]||"offline",p=l=>({online:"在线",offline:"离线",error:"故障",maintenance:"维护中"})[l]||l,j=l=>({repair:"danger",upgrade:"success",inspection:"info",replacement:"warning"})[l]||"info",q=l=>({repair:"维修",upgrade:"升级",inspection:"检查",replacement:"更换"})[l]||l,K=l=>({pending:"info",in_progress:"warning",completed:"success",cancelled:"danger"})[l]||"info",R=l=>({pending:"待处理",in_progress:"进行中",completed:"已完成",cancelled:"已取消"})[l]||l,X=l=>l?new Date(l).toLocaleString("zh-CN"):"无",h=l=>{if(!l)return"0分钟";const s=Math.floor(l/60),y=l%60;return s>0?`${s}小时${y}分钟`:`${y}分钟`};return(l,s)=>{var B;const y=w("el-tag"),b=w("el-icon"),H=w("el-button"),G=w("el-dropdown-item"),ee=w("el-dropdown-menu"),se=w("el-dropdown"),te=w("el-dialog");return m(),E(te,{modelValue:C.value,"onUpdate:modelValue":s[0]||(s[0]=d=>C.value=d),title:`设备详情 - ${((B=l.device)==null?void 0:B.serialNumber)||""}`,width:"900px","before-close":Y},{footer:a(()=>[e("div",tl,[t(H,{onClick:Y},{default:a(()=>s[34]||(s[34]=[g("关闭",-1)])),_:1,__:[34]}),t(H,{type:"primary",onClick:F},{default:a(()=>s[35]||(s[35]=[g("编辑设备",-1)])),_:1,__:[35]}),t(se,{onCommand:U,trigger:"click"},{dropdown:a(()=>[t(ee,null,{default:a(()=>{var d,x,f;return[((d=l.device)==null?void 0:d.status)==="online"?(m(),E(G,{key:0,command:"reboot"},{default:a(()=>s[37]||(s[37]=[g(" 重启设备 ",-1)])),_:1,__:[37]})):I("",!0),((x=l.device)==null?void 0:x.status)!=="maintenance"?(m(),E(G,{key:1,command:"maintenance"},{default:a(()=>s[38]||(s[38]=[g(" 进入维护 ",-1)])),_:1,__:[38]})):I("",!0),((f=l.device)==null?void 0:f.status)==="offline"?(m(),E(G,{key:2,command:"activate"},{default:a(()=>s[39]||(s[39]=[g(" 激活设备 ",-1)])),_:1,__:[39]})):I("",!0),t(G,{command:"firmware"},{default:a(()=>s[40]||(s[40]=[g(" 推送固件 ",-1)])),_:1,__:[40]})]}),_:1})]),default:a(()=>[t(H,{type:"primary"},{default:a(()=>[s[36]||(s[36]=g(" 设备操作",-1)),t(b,{class:"el-icon--right"},{default:a(()=>[t(N(ke))]),_:1})]),_:1,__:[36]})]),_:1})])]),default:a(()=>[l.device?(m(),S("div",ot,[e("div",st,[s[9]||(s[9]=e("h3",{class:"section-title"},"基本信息",-1)),e("div",at,[e("div",nt,[s[1]||(s[1]=e("label",null,"设备序列号",-1)),e("span",null,c(l.device.serialNumber),1)]),e("div",it,[s[2]||(s[2]=e("label",null,"设备型号",-1)),t(y,{type:M(l.device.model),size:"small"},{default:a(()=>[g(c(L(l.device.model)),1)]),_:1},8,["type"])]),e("div",rt,[s[3]||(s[3]=e("label",null,"设备状态",-1)),e("div",dt,[t(b,{class:Ue(P(l.device.status))},{default:a(()=>[l.device.status==="online"?(m(),E(N(De),{key:0})):l.device.status==="offline"?(m(),E(N($e),{key:1})):l.device.status==="error"?(m(),E(N(Ce),{key:2})):(m(),E(N(Be),{key:3}))]),_:1},8,["class"]),e("span",null,c(p(l.device.status)),1)])]),e("div",ut,[s[4]||(s[4]=e("label",null,"固件版本",-1)),e("span",null,c(l.device.firmwareVersion),1)]),e("div",ct,[s[5]||(s[5]=e("label",null,"所属客户",-1)),e("div",null,[e("div",vt,c(l.device.customerName),1),e("div",mt,c(l.device.customerPhone),1)])]),e("div",pt,[s[6]||(s[6]=e("label",null,"激活时间",-1)),e("span",null,c(X(l.device.activatedAt)),1)]),e("div",ft,[s[7]||(s[7]=e("label",null,"最后在线",-1)),e("span",null,c(X(l.device.lastOnlineAt)),1)]),e("div",gt,[s[8]||(s[8]=e("label",null,"创建时间",-1)),e("span",null,c(X(l.device.createdAt)),1)])])]),l.device.specifications?(m(),S("div",_t,[s[16]||(s[16]=e("h3",{class:"section-title"},"技术参数",-1)),e("div",yt,[e("div",bt,[s[10]||(s[10]=e("label",null,"处理器",-1)),e("span",null,c(l.device.specifications.cpu),1)]),e("div",wt,[s[11]||(s[11]=e("label",null,"内存",-1)),e("span",null,c(l.device.specifications.memory),1)]),e("div",ht,[s[12]||(s[12]=e("label",null,"存储",-1)),e("span",null,c(l.device.specifications.storage),1)]),e("div",Vt,[s[13]||(s[13]=e("label",null,"显示屏",-1)),e("span",null,c(l.device.specifications.display),1)]),e("div",Dt,[s[14]||(s[14]=e("label",null,"电池",-1)),e("span",null,c(l.device.specifications.battery),1)]),e("div",$t,[s[15]||(s[15]=e("label",null,"连接性",-1)),e("div",Ct,[(m(!0),S(le,null,oe(l.device.specifications.connectivity,d=>(m(),E(y,{key:d,size:"small",class:"connectivity-tag"},{default:a(()=>[g(c(d),1)]),_:2},1024))),128))])])])])):I("",!0),l.device.usageStats?(m(),S("div",kt,[s[21]||(s[21]=e("h3",{class:"section-title"},"使用统计",-1)),e("div",St,[e("div",Et,[s[17]||(s[17]=e("label",null,"总运行时长",-1)),e("span",null,c(h(l.device.usageStats.totalRuntime)),1)]),e("div",Ut,[s[18]||(s[18]=e("label",null,"使用次数",-1)),e("span",null,c(l.device.usageStats.usageCount)+"次",1)]),e("div",zt,[s[19]||(s[19]=e("label",null,"平均使用时长",-1)),e("span",null,c(h(l.device.usageStats.averageSessionTime)),1)]),e("div",Tt,[s[20]||(s[20]=e("label",null,"最后使用时间",-1)),e("span",null,c(X(l.device.usageStats.lastUsedAt)),1)])])])):I("",!0),l.device.maintenanceRecords&&l.device.maintenanceRecords.length>0?(m(),S("div",Mt,[s[23]||(s[23]=e("h3",{class:"section-title"},"维护记录",-1)),e("div",Nt,[(m(!0),S(le,null,oe(l.device.maintenanceRecords,d=>(m(),S("div",{key:d.id,class:"maintenance-item"},[e("div",It,[t(y,{type:j(d.type),size:"small"},{default:a(()=>[g(c(q(d.type)),1)]),_:2},1032,["type"]),e("span",Ot,c(X(d.startTime)),1),t(y,{type:K(d.status),size:"small"},{default:a(()=>[g(c(R(d.status)),1)]),_:2},1032,["type"])]),e("div",Lt,[e("p",Rt,c(d.description),1),e("div",At,[e("span",Ft,"技术员："+c(d.technician),1),d.cost?(m(),S("span",Yt,"费用：¥"+c(d.cost),1)):I("",!0)]),d.parts&&d.parts.length>0?(m(),S("div",Bt,[s[22]||(s[22]=e("span",{class:"parts-label"},"更换部件：",-1)),(m(!0),S(le,null,oe(d.parts,x=>(m(),E(y,{key:x,size:"small",class:"part-tag"},{default:a(()=>[g(c(x),1)]),_:2},1024))),128))])):I("",!0)])]))),128))])])):I("",!0),l.device.configuration?(m(),S("div",Xt,[s[28]||(s[28]=e("h3",{class:"section-title"},"设备配置",-1)),e("div",Pt,[e("div",qt,[s[24]||(s[24]=e("label",null,"语言",-1)),e("span",null,c(l.device.configuration.language),1)]),e("div",Ht,[s[25]||(s[25]=e("label",null,"时区",-1)),e("span",null,c(l.device.configuration.timezone),1)]),e("div",jt,[s[26]||(s[26]=e("label",null,"自动更新",-1)),t(y,{type:l.device.configuration.autoUpdate?"success":"info",size:"small"},{default:a(()=>[g(c(l.device.configuration.autoUpdate?"已启用":"已禁用"),1)]),_:1},8,["type"])]),e("div",Gt,[s[27]||(s[27]=e("label",null,"调试模式",-1)),t(y,{type:l.device.configuration.debugMode?"warning":"info",size:"small"},{default:a(()=>[g(c(l.device.configuration.debugMode?"已启用":"已禁用"),1)]),_:1},8,["type"])])])])):I("",!0),l.device.location?(m(),S("div",Wt,[s[32]||(s[32]=e("h3",{class:"section-title"},"位置信息",-1)),e("div",Jt,[e("div",Kt,[s[29]||(s[29]=e("label",null,"地址",-1)),e("span",null,c(l.device.location.address),1)]),e("div",Qt,[s[30]||(s[30]=e("label",null,"坐标",-1)),e("span",null,c(l.device.location.latitude)+", "+c(l.device.location.longitude),1)]),e("div",Zt,[s[31]||(s[31]=e("label",null,"最后更新",-1)),e("span",null,c(X(l.device.location.lastUpdated)),1)])])])):I("",!0),l.device.notes?(m(),S("div",xt,[s[33]||(s[33]=e("h3",{class:"section-title"},"备注信息",-1)),e("div",el,c(l.device.notes),1)])):I("",!0)])):I("",!0)]),_:1},8,["modelValue","title"])}}}),ol=ve(ll,[["__scopeId","data-v-784fd75f"]]),sl={class:"form-section"},al={class:"form-grid"},nl={class:"form-section"},il={class:"form-grid"},rl={class:"form-section"},dl={class:"form-grid"},ul={class:"form-section"},cl={class:"form-grid"},vl={class:"form-section"},ml={class:"dialog-footer"},pl=ce({__name:"DeviceFormDialog",props:{modelValue:{type:Boolean},device:{}},emits:["update:modelValue","success"],setup(i,{emit:o}){const n=i,_=o,C=V(),Y=V(!1),F=V(!1),U=V([]),M=ge({get:()=>n.modelValue,set:h=>_("update:modelValue",h)}),L=ge(()=>!!n.device),P=()=>({serialNumber:"",model:DeviceModel.YX_EDU_2024,customerId:"",firmwareVersion:"1.0.0",specifications:{cpu:"",memory:"",storage:"",display:"",battery:"",connectivity:[]},configuration:{language:"zh-CN",timezone:"Asia/Shanghai",autoUpdate:!0,debugMode:!1,customSettings:{}},location:{address:"",latitude:0,longitude:0,lastUpdated:new Date().toISOString()},notes:""}),p=V(P()),j={serialNumber:[{required:!0,message:"请输入设备序列号",trigger:"blur"},{min:6,max:50,message:"序列号长度应在6-50个字符之间",trigger:"blur"},{pattern:/^[A-Z0-9-]+$/,message:"序列号只能包含大写字母、数字和连字符",trigger:"blur"}],model:[{required:!0,message:"请选择设备型号",trigger:"change"}],customerId:[{required:!0,message:"请选择所属客户",trigger:"change"}],firmwareVersion:[{required:!0,message:"请输入固件版本",trigger:"blur"},{pattern:/^\d+\.\d+\.\d+$/,message:"固件版本格式应为 x.y.z",trigger:"blur"}],"specifications.cpu":[{required:!0,message:"请输入处理器信息",trigger:"blur"}],"specifications.memory":[{required:!0,message:"请输入内存信息",trigger:"blur"}],"specifications.storage":[{required:!0,message:"请输入存储信息",trigger:"blur"}],"specifications.display":[{required:!0,message:"请输入显示屏信息",trigger:"blur"}],"specifications.battery":[{required:!0,message:"请输入电池信息",trigger:"blur"}],"configuration.language":[{required:!0,message:"请选择语言",trigger:"change"}],"configuration.timezone":[{required:!0,message:"请选择时区",trigger:"change"}]};Se(()=>n.device,h=>{h?p.value={serialNumber:h.serialNumber,model:h.model,customerId:h.customerId,firmwareVersion:h.firmwareVersion||"1.0.0",specifications:h.specifications?ue({},h.specifications):{cpu:"",memory:"",storage:"",display:"",battery:"",connectivity:[]},configuration:h.configuration?ue({},h.configuration):{language:"zh-CN",timezone:"Asia/Shanghai",autoUpdate:!0,debugMode:!1,customSettings:{}},location:h.location?ue({},h.location):{address:"",latitude:0,longitude:0,lastUpdated:new Date().toISOString()},notes:h.notes||""}:p.value=P()},{immediate:!0}),Se(M,h=>{h&&(q(),xe(()=>{var l;(l=C.value)==null||l.clearValidate()}))});const q=()=>D(null,null,function*(){try{F.value=!0;const h=yield A.getCustomerOptions();U.value=h}catch(h){console.error("加载客户选项失败:",h)}finally{F.value=!1}}),K=h=>D(null,null,function*(){if(h){const l=U.value.filter(s=>s.name.toLowerCase().includes(h.toLowerCase()));U.value=l}else q()}),R=()=>{M.value=!1,p.value=P()},X=()=>D(null,null,function*(){var h,l,s;if(C.value)try{if(!(yield C.value.validate()))return;Y.value=!0;const b=ue({},p.value);!((h=b.location)!=null&&h.address)&&!((l=b.location)!=null&&l.latitude)&&!((s=b.location)!=null&&s.longitude)&&delete b.location,L.value&&n.device?(yield A.updateDevice(n.device.id,b),z.success("设备更新成功")):(yield A.createDevice(b),z.success("设备创建成功")),_("success"),R()}catch(y){console.error("提交失败:",y),z.error(y.message||"操作失败")}finally{Y.value=!1}});return(h,l)=>{const s=w("el-input"),y=w("el-form-item"),b=w("el-option"),H=w("el-select"),G=w("el-switch"),ee=w("el-input-number"),se=w("el-form"),te=w("el-button"),B=w("el-dialog");return m(),E(B,{modelValue:M.value,"onUpdate:modelValue":l[18]||(l[18]=d=>M.value=d),title:L.value?"编辑设备":"添加设备",width:"800px","before-close":R},{footer:a(()=>[e("div",ml,[t(te,{onClick:R},{default:a(()=>l[24]||(l[24]=[g("取消",-1)])),_:1,__:[24]}),t(te,{type:"primary",onClick:X,loading:Y.value},{default:a(()=>[g(c(L.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:a(()=>[t(se,{ref_key:"formRef",ref:C,model:p.value,rules:j,"label-width":"120px","label-position":"left"},{default:a(()=>[e("div",sl,[l[19]||(l[19]=e("h3",{class:"section-title"},"基本信息",-1)),e("div",al,[t(y,{label:"设备序列号",prop:"serialNumber"},{default:a(()=>[t(s,{modelValue:p.value.serialNumber,"onUpdate:modelValue":l[0]||(l[0]=d=>p.value.serialNumber=d),placeholder:"请输入设备序列号",disabled:L.value},null,8,["modelValue","disabled"])]),_:1}),t(y,{label:"设备型号",prop:"model"},{default:a(()=>[t(H,{modelValue:p.value.model,"onUpdate:modelValue":l[1]||(l[1]=d=>p.value.model=d),placeholder:"请选择设备型号"},{default:a(()=>[t(b,{label:"教育版 (YX-EDU-2024)",value:"YX-EDU-2024"}),t(b,{label:"家庭版 (YX-HOME-2024)",value:"YX-HOME-2024"}),t(b,{label:"专业版 (YX-PRO-2024)",value:"YX-PRO-2024"})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"所属客户",prop:"customerId"},{default:a(()=>[t(H,{modelValue:p.value.customerId,"onUpdate:modelValue":l[2]||(l[2]=d=>p.value.customerId=d),placeholder:"请选择客户",filterable:"",remote:"","remote-method":K,loading:F.value},{default:a(()=>[(m(!0),S(le,null,oe(U.value,d=>(m(),E(b,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),t(y,{label:"固件版本",prop:"firmwareVersion"},{default:a(()=>[t(s,{modelValue:p.value.firmwareVersion,"onUpdate:modelValue":l[3]||(l[3]=d=>p.value.firmwareVersion=d),placeholder:"请输入固件版本，如：1.0.0"},null,8,["modelValue"])]),_:1})])]),e("div",nl,[l[20]||(l[20]=e("h3",{class:"section-title"},"技术参数",-1)),e("div",il,[t(y,{label:"处理器",prop:"specifications.cpu"},{default:a(()=>[t(s,{modelValue:p.value.specifications.cpu,"onUpdate:modelValue":l[4]||(l[4]=d=>p.value.specifications.cpu=d),placeholder:"请输入处理器信息"},null,8,["modelValue"])]),_:1}),t(y,{label:"内存",prop:"specifications.memory"},{default:a(()=>[t(s,{modelValue:p.value.specifications.memory,"onUpdate:modelValue":l[5]||(l[5]=d=>p.value.specifications.memory=d),placeholder:"请输入内存信息"},null,8,["modelValue"])]),_:1}),t(y,{label:"存储",prop:"specifications.storage"},{default:a(()=>[t(s,{modelValue:p.value.specifications.storage,"onUpdate:modelValue":l[6]||(l[6]=d=>p.value.specifications.storage=d),placeholder:"请输入存储信息"},null,8,["modelValue"])]),_:1}),t(y,{label:"显示屏",prop:"specifications.display"},{default:a(()=>[t(s,{modelValue:p.value.specifications.display,"onUpdate:modelValue":l[7]||(l[7]=d=>p.value.specifications.display=d),placeholder:"请输入显示屏信息"},null,8,["modelValue"])]),_:1}),t(y,{label:"电池",prop:"specifications.battery"},{default:a(()=>[t(s,{modelValue:p.value.specifications.battery,"onUpdate:modelValue":l[8]||(l[8]=d=>p.value.specifications.battery=d),placeholder:"请输入电池信息"},null,8,["modelValue"])]),_:1}),t(y,{label:"连接性",prop:"specifications.connectivity"},{default:a(()=>[t(H,{modelValue:p.value.specifications.connectivity,"onUpdate:modelValue":l[9]||(l[9]=d=>p.value.specifications.connectivity=d),multiple:"",placeholder:"请选择连接方式",style:{width:"100%"}},{default:a(()=>[t(b,{label:"WiFi 6",value:"WiFi 6"}),t(b,{label:"WiFi 5",value:"WiFi 5"}),t(b,{label:"Bluetooth 5.0",value:"Bluetooth 5.0"}),t(b,{label:"Bluetooth 4.2",value:"Bluetooth 4.2"}),t(b,{label:"4G LTE",value:"4G LTE"}),t(b,{label:"5G",value:"5G"}),t(b,{label:"以太网",value:"Ethernet"}),t(b,{label:"USB-C",value:"USB-C"})]),_:1},8,["modelValue"])]),_:1})])]),e("div",rl,[l[21]||(l[21]=e("h3",{class:"section-title"},"设备配置",-1)),e("div",dl,[t(y,{label:"语言",prop:"configuration.language"},{default:a(()=>[t(H,{modelValue:p.value.configuration.language,"onUpdate:modelValue":l[10]||(l[10]=d=>p.value.configuration.language=d),placeholder:"请选择语言"},{default:a(()=>[t(b,{label:"简体中文",value:"zh-CN"}),t(b,{label:"English",value:"en-US"}),t(b,{label:"日本語",value:"ja-JP"}),t(b,{label:"한국어",value:"ko-KR"}),t(b,{label:"Español",value:"es-ES"})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"时区",prop:"configuration.timezone"},{default:a(()=>[t(H,{modelValue:p.value.configuration.timezone,"onUpdate:modelValue":l[11]||(l[11]=d=>p.value.configuration.timezone=d),placeholder:"请选择时区"},{default:a(()=>[t(b,{label:"北京时间 (Asia/Shanghai)",value:"Asia/Shanghai"}),t(b,{label:"东京时间 (Asia/Tokyo)",value:"Asia/Tokyo"}),t(b,{label:"首尔时间 (Asia/Seoul)",value:"Asia/Seoul"}),t(b,{label:"纽约时间 (America/New_York)",value:"America/New_York"}),t(b,{label:"伦敦时间 (Europe/London)",value:"Europe/London"})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"自动更新"},{default:a(()=>[t(G,{modelValue:p.value.configuration.autoUpdate,"onUpdate:modelValue":l[12]||(l[12]=d=>p.value.configuration.autoUpdate=d)},null,8,["modelValue"])]),_:1}),t(y,{label:"调试模式"},{default:a(()=>[t(G,{modelValue:p.value.configuration.debugMode,"onUpdate:modelValue":l[13]||(l[13]=d=>p.value.configuration.debugMode=d)},null,8,["modelValue"])]),_:1})])]),e("div",ul,[l[22]||(l[22]=e("h3",{class:"section-title"},[g("位置信息 "),e("span",{class:"optional"},"(可选)")],-1)),e("div",cl,[t(y,{label:"地址",prop:"location.address"},{default:a(()=>[t(s,{modelValue:p.value.location.address,"onUpdate:modelValue":l[14]||(l[14]=d=>p.value.location.address=d),placeholder:"请输入设备地址",type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),t(y,{label:"纬度",prop:"location.latitude"},{default:a(()=>[t(ee,{modelValue:p.value.location.latitude,"onUpdate:modelValue":l[15]||(l[15]=d=>p.value.location.latitude=d),placeholder:"请输入纬度",precision:6,min:-90,max:90,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(y,{label:"经度",prop:"location.longitude"},{default:a(()=>[t(ee,{modelValue:p.value.location.longitude,"onUpdate:modelValue":l[16]||(l[16]=d=>p.value.location.longitude=d),placeholder:"请输入经度",precision:6,min:-180,max:180,style:{width:"100%"}},null,8,["modelValue"])]),_:1})])]),e("div",vl,[l[23]||(l[23]=e("h3",{class:"section-title"},[g("备注信息 "),e("span",{class:"optional"},"(可选)")],-1)),t(y,{prop:"notes"},{default:a(()=>[t(s,{modelValue:p.value.notes,"onUpdate:modelValue":l[17]||(l[17]=d=>p.value.notes=d),placeholder:"请输入设备备注信息",type:"textarea",rows:3},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),fl=ve(pl,[["__scopeId","data-v-4ef43e50"]]),gl={class:"log-filters"},_l={class:"log-content"},yl={class:"log-list"},bl={class:"log-header"},wl={class:"log-meta"},hl={class:"log-time"},Vl={class:"log-message"},Dl={key:0,class:"log-details"},$l={key:0,class:"empty-state"},Cl={key:0,class:"pagination-wrapper"},kl={class:"dialog-footer"},Sl=ce({__name:"DeviceLogsDialog",props:{modelValue:{type:Boolean},device:{}},emits:["update:modelValue"],setup(i,{emit:o}){const n=i,_=o,C=V(!1),Y=V([]),F=V(new Set),U=V(1),M=V(50),L=V(0),P=V(""),p=V(""),j=V(null),q=ge({get:()=>n.modelValue,set:f=>_("update:modelValue",f)});Se(q,f=>{f&&n.device&&(K(),R())});const K=()=>{P.value="",p.value="",j.value=null,U.value=1,F.value.clear()},R=()=>D(null,null,function*(){if(n.device){C.value=!0;try{const f={page:U.value,pageSize:M.value};P.value&&(f.level=P.value),p.value&&(f.category=p.value),j.value&&(f.dateRange=j.value);const k=yield A.getDeviceLogs(n.device.id,f);Y.value=k.list||[],L.value=k.total||0}catch(f){console.error("加载日志失败:",f),z.error((f==null?void 0:f.message)||"加载日志失败"),Y.value=[],L.value=0}finally{C.value=!1}}}),X=()=>{U.value=1,R()},h=f=>{M.value=f,U.value=1,R()},l=f=>{U.value=f,R()},s=()=>{R()},y=f=>{F.value.has(f)?F.value.delete(f):F.value.add(f)},b=()=>{z.info("日志导出功能开发中")},H=()=>{q.value=!1},G=f=>`log-level-${f}`,ee=f=>({info:"primary",warning:"warning",error:"danger",debug:"info"})[f]||"info",se=f=>({info:"信息",warning:"警告",error:"错误",debug:"调试"})[f]||f,te=f=>({system:"success",user:"primary",network:"warning",hardware:"danger",software:"info"})[f]||"info",B=f=>({system:"系统",user:"用户",network:"网络",hardware:"硬件",software:"软件"})[f]||f,d=f=>new Date(f).toLocaleString("zh-CN"),x=f=>JSON.stringify(f,null,2);return(f,k)=>{var fe;const W=w("el-option"),de=w("el-select"),_e=w("el-date-picker"),me=w("el-icon"),ae=w("el-button"),pe=w("el-tag"),ye=w("el-empty"),be=w("el-pagination"),we=w("el-dialog"),he=Pe("loading");return m(),E(we,{modelValue:q.value,"onUpdate:modelValue":k[5]||(k[5]=$=>q.value=$),title:`设备日志 - ${((fe=f.device)==null?void 0:fe.serialNumber)||""}`,width:"1000px","before-close":H},{footer:a(()=>[e("div",kl,[t(ae,{onClick:H},{default:a(()=>k[7]||(k[7]=[g("关闭",-1)])),_:1,__:[7]}),t(ae,{type:"primary",onClick:b},{default:a(()=>[t(me,null,{default:a(()=>[t(N(Ke))]),_:1}),k[8]||(k[8]=g(" 导出日志 ",-1))]),_:1,__:[8]})])]),default:a(()=>[e("div",gl,[t(de,{modelValue:P.value,"onUpdate:modelValue":k[0]||(k[0]=$=>P.value=$),placeholder:"日志级别",clearable:"",onChange:X},{default:a(()=>[t(W,{label:"全部级别",value:""}),t(W,{label:"信息",value:"info"}),t(W,{label:"警告",value:"warning"}),t(W,{label:"错误",value:"error"}),t(W,{label:"调试",value:"debug"})]),_:1},8,["modelValue"]),t(de,{modelValue:p.value,"onUpdate:modelValue":k[1]||(k[1]=$=>p.value=$),placeholder:"日志分类",clearable:"",onChange:X},{default:a(()=>[t(W,{label:"全部分类",value:""}),t(W,{label:"系统",value:"system"}),t(W,{label:"用户",value:"user"}),t(W,{label:"网络",value:"network"}),t(W,{label:"硬件",value:"hardware"}),t(W,{label:"软件",value:"software"})]),_:1},8,["modelValue"]),t(_e,{modelValue:j.value,"onUpdate:modelValue":k[2]||(k[2]=$=>j.value=$),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",onChange:X},null,8,["modelValue"]),t(ae,{onClick:s,loading:C.value},{default:a(()=>[t(me,null,{default:a(()=>[t(N(Xe))]),_:1}),k[6]||(k[6]=g(" 刷新 ",-1))]),_:1,__:[6]},8,["loading"])]),e("div",_l,[Ee((m(),S("div",yl,[(m(!0),S(le,null,oe(Y.value,$=>(m(),S("div",{key:$.id,class:Ue(["log-item",G($.level)])},[e("div",bl,[e("div",wl,[t(pe,{type:ee($.level),size:"small"},{default:a(()=>[g(c(se($.level)),1)]),_:2},1032,["type"]),t(pe,{type:te($.category),size:"small"},{default:a(()=>[g(c(B($.category)),1)]),_:2},1032,["type"]),e("span",hl,c(d($.timestamp)),1)]),$.details?(m(),E(ae,{key:0,text:"",size:"small",onClick:ze=>y($.id)},{default:a(()=>[g(c(F.value.has($.id)?"收起":"详情"),1)]),_:2},1032,["onClick"])):I("",!0)]),e("div",Vl,c($.message),1),$.details&&F.value.has($.id)?(m(),S("div",Dl,[e("pre",null,c(x($.details)),1)])):I("",!0)],2))),128)),!C.value&&Y.value.length===0?(m(),S("div",$l,[t(ye,{description:"暂无日志数据"})])):I("",!0)])),[[he,C.value]]),L.value>0?(m(),S("div",Cl,[t(be,{"current-page":U.value,"onUpdate:currentPage":k[3]||(k[3]=$=>U.value=$),"page-size":M.value,"onUpdate:pageSize":k[4]||(k[4]=$=>M.value=$),"page-sizes":[20,50,100],total:L.value,layout:"total, sizes, prev, pager, next",onSizeChange:h,onCurrentChange:l},null,8,["current-page","page-size","total"])])):I("",!0)])]),_:1},8,["modelValue","title"])}}}),El=ve(Sl,[["__scopeId","data-v-ba0dc942"]]),Ul={class:"empty-state"},zl={class:"empty-icon"},Tl={class:"empty-title"},Ml={key:0,class:"empty-description"},Nl={key:1,class:"empty-actions"},Il=ce({__name:"EmptyState",props:{icon:{default:Qe},title:{default:"暂无数据"},description:{default:""}},setup(i){return(o,n)=>{const _=w("el-icon");return m(),S("div",Ul,[e("div",zl,[t(_,{size:64},{default:a(()=>[(m(),E(et(o.icon)))]),_:1})]),e("div",Tl,c(o.title),1),o.description?(m(),S("div",Ml,c(o.description),1)):I("",!0),o.$slots.actions?(m(),S("div",Nl,[tt(o.$slots,"actions",{},void 0,!0)])):I("",!0)])}}}),Ol=ve(Il,[["__scopeId","data-v-5dd3ca26"]]),Ll={class:"device-management"},Rl={class:"page-header"},Al={class:"header-right"},Fl={class:"stats-cards"},Yl={class:"stat-card"},Bl={class:"stat-icon total"},Xl={class:"stat-content"},Pl={class:"stat-value"},ql={class:"stat-card"},Hl={class:"stat-icon online"},jl={class:"stat-content"},Gl={class:"stat-value"},Wl={class:"stat-card"},Jl={class:"stat-icon offline"},Kl={class:"stat-content"},Ql={class:"stat-value"},Zl={class:"stat-card"},xl={class:"stat-icon error"},eo={class:"stat-content"},to={class:"stat-value"},lo={class:"search-filters"},oo={class:"filters-left"},so={class:"filters-right"},ao={class:"table-section"},no={class:"customer-info"},io={class:"customer-name"},ro={class:"customer-phone"},uo={class:"status-cell"},co={class:"status-text"},vo={class:"usage-stats"},mo={class:"usage-item"},po={class:"value"},fo={class:"usage-item"},go={class:"value"},_o={class:"pagination-wrapper"},yo=ce({__name:"DeviceManagement",setup(i){const o=V(!1),n=V(!1),_=V(""),C=V(""),Y=V(""),F=V(""),U=V(1),M=V(20),L=V(0),P=V(!1),p=V(""),j=V([]),q=V([]),K=V(null),R=V({total:0,online:0,offline:0,error:0,maintenance:0}),X=V([]),h=V(!1),l=V(!1),s=V(!1),y=V(null);let b=null;const H=()=>{b&&clearTimeout(b),b=setTimeout(()=>{U.value=1,B()},300)},G=()=>{U.value=1,B()},ee=u=>{M.value=u,U.value=1,B()},se=u=>{U.value=u,B()},te=u=>{q.value=u},B=()=>D(null,null,function*(){o.value=!0,P.value=!1;try{const u={page:U.value,pageSize:M.value,keyword:_.value,status:C.value,model:Y.value,customerId:F.value},r=yield A.getDevices(u);j.value=r.list||[],L.value=r.total||0,r.stats&&(R.value=r.stats)}catch(u){console.error("加载设备数据失败:",u),P.value=!0,p.value=(u==null?void 0:u.message)||"加载设备数据失败",z.error(p.value),j.value=[],L.value=0}finally{o.value=!1}}),d=()=>D(null,null,function*(){n.value=!0;try{const u=yield A.getDeviceStats();R.value=u}catch(u){console.error("加载统计数据失败:",u),z.error("加载统计数据失败"),R.value={total:0,online:0,offline:0,error:0,maintenance:0}}finally{n.value=!1}}),x=()=>D(null,null,function*(){try{const u=yield A.getCustomerOptions();X.value=u}catch(u){console.error("加载客户选项失败:",u)}}),f=u=>{K.value=u,h.value=!0},k=u=>{y.value=u,l.value=!0},W=u=>{h.value=!1,k(u)},de=()=>{y.value=null,l.value=!0},_e=()=>{B(),y.value=null},me=(u,r)=>D(null,null,function*(){try{switch(u){case"reboot":yield A.rebootDevice(r.id),z.success("设备重启指令已发送");break;case"maintenance":yield A.updateDeviceStatus(r.id,DeviceStatus.MAINTENANCE),z.success("设备已进入维护模式");break;case"activate":yield A.activateDevice(r.id),z.success("设备激活指令已发送");break;case"firmware":yield A.pushFirmware(r.id),z.success("固件推送已启动");break;case"logs":K.value=r,s.value=!0;return;case"delete":yield Ye.confirm("确定要删除这个设备吗？此操作不可恢复。","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield A.deleteDevice(r.id),z.success("设备已删除");break}B()}catch(T){T!=="cancel"&&(console.error("设备操作失败:",T),z.error("操作失败"))}}),ae=u=>D(null,null,function*(){const r=q.value.map(T=>T.id);try{switch(u){case"updateStatus":z.info("批量状态更新功能开发中");break;case"pushFirmware":const T=yield A.batchPushFirmware(r);T.failureCount>0?z.warning(`固件推送完成：成功${T.successCount}个，失败${T.failureCount}个`):z.success(`已向 ${T.successCount} 个设备推送固件`);break;case"reboot":const J=yield A.batchRebootDevices(r);J.failureCount>0?z.warning(`重启指令发送完成：成功${J.successCount}个，失败${J.failureCount}个`):z.success(`已向 ${J.successCount} 个设备发送重启指令`);break;case"delete":yield Ye.confirm(`确定要删除选中的 ${r.length} 个设备吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const ne=yield A.batchDeleteDevices(r);ne.failureCount>0?z.warning(`删除完成：成功${ne.successCount}个，失败${ne.failureCount}个`):z.success(`已删除 ${ne.successCount} 个设备`);break}B()}catch(T){T!=="cancel"&&(console.error("批量操作失败:",T),z.error("操作失败"))}}),pe=()=>{B()},ye=()=>{Te()},be=u=>({[DeviceModel.YX_EDU_2024]:"primary",[DeviceModel.YX_HOME_2024]:"success",[DeviceModel.YX_PRO_2024]:"warning"})[u]||"info",we=u=>DEVICE_MODEL_TEXT[u]||u,he=u=>DEVICE_STATUS_COLOR[u]||"info",fe=u=>DEVICE_STATUS_TEXT[u]||u,$=u=>u?new Date(u).toLocaleString("zh-CN"):"无",ze=u=>{if(!u)return"0分钟";const r=Math.floor(u/60),T=u%60;return r>0?`${r}小时${T}分钟`:`${T}分钟`},Te=()=>D(null,null,function*(){yield Promise.all([B(),d(),x()])});return lt(()=>{Te()}),(u,r)=>{const T=w("el-icon"),J=w("el-button"),ne=w("el-input"),ie=w("el-option"),Ve=w("el-select"),Q=w("el-dropdown-item"),Me=w("el-dropdown-menu"),Ne=w("el-dropdown"),Z=w("el-table-column"),qe=w("el-tag"),He=w("el-table"),je=w("el-pagination"),Ie=Pe("loading");return m(),S("div",Ll,[e("div",Rl,[r[10]||(r[10]=e("div",{class:"header-left"},[e("h2",null,"设备管理"),e("p",{class:"header-subtitle"},"机器人设备监控与管理 · 练字机器人管理系统")],-1)),e("div",Al,[t(J,{type:"primary",onClick:de},{default:a(()=>[t(T,null,{default:a(()=>[t(N(Ae))]),_:1}),r[9]||(r[9]=g(" 添加设备 ",-1))]),_:1,__:[9]})])]),Ee((m(),S("div",Fl,[e("div",Yl,[e("div",Bl,[t(T,null,{default:a(()=>[t(N(Fe))]),_:1})]),e("div",Xl,[e("div",Pl,c(R.value.total),1),r[11]||(r[11]=e("div",{class:"stat-label"},"设备总数",-1))])]),e("div",ql,[e("div",Hl,[t(T,null,{default:a(()=>[t(N(De))]),_:1})]),e("div",jl,[e("div",Gl,c(R.value.online),1),r[12]||(r[12]=e("div",{class:"stat-label"},"在线设备",-1))])]),e("div",Wl,[e("div",Jl,[t(T,null,{default:a(()=>[t(N($e))]),_:1})]),e("div",Kl,[e("div",Ql,c(R.value.offline),1),r[13]||(r[13]=e("div",{class:"stat-label"},"离线设备",-1))])]),e("div",Zl,[e("div",xl,[t(T,null,{default:a(()=>[t(N(Ce))]),_:1})]),e("div",eo,[e("div",to,c(R.value.error),1),r[14]||(r[14]=e("div",{class:"stat-label"},"故障设备",-1))])])])),[[Ie,n.value]]),e("div",lo,[e("div",oo,[t(ne,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=v=>_.value=v),placeholder:"搜索设备序列号、客户姓名、设备型号","prefix-icon":N(Ze),clearable:"",onInput:H,style:{width:"350px"}},null,8,["modelValue","prefix-icon"]),t(Ve,{modelValue:C.value,"onUpdate:modelValue":r[1]||(r[1]=v=>C.value=v),placeholder:"设备状态",clearable:"",onChange:G},{default:a(()=>[t(ie,{label:"全部状态",value:""}),(m(!0),S(le,null,oe(Object.values(u.DeviceStatus),v=>(m(),E(ie,{key:v,label:u.DEVICE_STATUS_TEXT[v],value:v},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(Ve,{modelValue:Y.value,"onUpdate:modelValue":r[2]||(r[2]=v=>Y.value=v),placeholder:"设备型号",clearable:"",onChange:G},{default:a(()=>[t(ie,{label:"全部型号",value:""}),(m(!0),S(le,null,oe(Object.values(u.DeviceModel),v=>(m(),E(ie,{key:v,label:u.DEVICE_MODEL_TEXT[v],value:v},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(Ve,{modelValue:F.value,"onUpdate:modelValue":r[3]||(r[3]=v=>F.value=v),placeholder:"所属客户",clearable:"",onChange:G,filterable:""},{default:a(()=>[t(ie,{label:"全部客户",value:""}),(m(!0),S(le,null,oe(X.value,v=>(m(),E(ie,{key:v.id,label:v.name,value:v.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",so,[t(J,{icon:N(Xe),onClick:ye,loading:o.value||n.value},{default:a(()=>r[15]||(r[15]=[g(" 刷新 ",-1)])),_:1,__:[15]},8,["icon","loading"]),q.value.length>0?(m(),E(Ne,{key:0,onCommand:ae},{dropdown:a(()=>[t(Me,null,{default:a(()=>[t(Q,{command:"updateStatus"},{default:a(()=>r[16]||(r[16]=[g("更新状态",-1)])),_:1,__:[16]}),t(Q,{command:"pushFirmware"},{default:a(()=>r[17]||(r[17]=[g("推送固件",-1)])),_:1,__:[17]}),t(Q,{command:"reboot"},{default:a(()=>r[18]||(r[18]=[g("重启设备",-1)])),_:1,__:[18]}),t(Q,{command:"delete",divided:""},{default:a(()=>r[19]||(r[19]=[g("批量删除",-1)])),_:1,__:[19]})]),_:1})]),default:a(()=>[t(J,{type:"primary"},{default:a(()=>[g(" 批量操作 ("+c(q.value.length)+") ",1),t(T,{class:"el-icon--right"},{default:a(()=>[t(N(ke))]),_:1})]),_:1})]),_:1})):I("",!0)])]),e("div",ao,[Ee((m(),E(He,{data:j.value,stripe:"",onSelectionChange:te},{empty:a(()=>[t(Ol,{icon:N(Fe),title:"暂无设备数据",description:'还没有添加任何设备，点击右上角"添加设备"按钮开始添加'},{actions:a(()=>[t(J,{type:"primary",onClick:de},{default:a(()=>[t(T,null,{default:a(()=>[t(N(Ae))]),_:1}),r[20]||(r[20]=g(" 添加设备 ",-1))]),_:1,__:[20]})]),_:1},8,["icon"])]),default:a(()=>[t(Z,{type:"selection",width:"55"}),t(Z,{prop:"serialNumber",label:"设备序列号",width:"180"}),t(Z,{prop:"model",label:"设备型号",width:"150"},{default:a(({row:v})=>[t(qe,{type:be(v.model),size:"small"},{default:a(()=>[g(c(we(v.model)),1)]),_:2},1032,["type"])]),_:1}),t(Z,{label:"所属客户",width:"150"},{default:a(({row:v})=>[e("div",no,[e("div",io,c(v.customerName),1),e("div",ro,c(v.customerPhone),1)])]),_:1}),t(Z,{prop:"status",label:"设备状态",width:"120"},{default:a(({row:v})=>[e("div",uo,[t(T,{class:Ue([he(v.status),"status-icon"])},{default:a(()=>[v.status===u.DeviceStatus.ONLINE?(m(),E(N(De),{key:0})):v.status===u.DeviceStatus.OFFLINE?(m(),E(N($e),{key:1})):v.status===u.DeviceStatus.ERROR?(m(),E(N(Ce),{key:2})):(m(),E(N(Be),{key:3}))]),_:2},1032,["class"]),e("span",co,c(fe(v.status)),1)])]),_:1}),t(Z,{prop:"firmwareVersion",label:"固件版本",width:"120"}),t(Z,{prop:"lastOnlineAt",label:"最后在线时间",width:"180"},{default:a(({row:v})=>[g(c($(v.lastOnlineAt)),1)]),_:1}),t(Z,{prop:"activatedAt",label:"激活时间",width:"180"},{default:a(({row:v})=>[g(c($(v.activatedAt)),1)]),_:1}),t(Z,{label:"使用统计",width:"150"},{default:a(({row:v})=>{var re,Oe;return[e("div",vo,[e("div",mo,[r[21]||(r[21]=e("span",{class:"label"},"运行时长:",-1)),e("span",po,c(ze((re=v.usageStats)==null?void 0:re.totalRuntime)),1)]),e("div",fo,[r[22]||(r[22]=e("span",{class:"label"},"使用次数:",-1)),e("span",go,c(((Oe=v.usageStats)==null?void 0:Oe.usageCount)||0)+"次",1)])])]}),_:1}),t(Z,{label:"操作",width:"200",fixed:"right"},{default:a(({row:v})=>[t(J,{text:"",type:"primary",size:"small",onClick:re=>f(v)},{default:a(()=>r[23]||(r[23]=[g(" 查看详情 ",-1)])),_:2,__:[23]},1032,["onClick"]),t(J,{text:"",type:"primary",size:"small",onClick:re=>k(v)},{default:a(()=>r[24]||(r[24]=[g(" 编辑 ",-1)])),_:2,__:[24]},1032,["onClick"]),t(Ne,{onCommand:re=>me(re,v),trigger:"click"},{dropdown:a(()=>[t(Me,null,{default:a(()=>[v.status===u.DeviceStatus.ONLINE?(m(),E(Q,{key:0,command:"reboot"},{default:a(()=>r[26]||(r[26]=[g(" 重启设备 ",-1)])),_:1,__:[26]})):I("",!0),v.status!==u.DeviceStatus.MAINTENANCE?(m(),E(Q,{key:1,command:"maintenance"},{default:a(()=>r[27]||(r[27]=[g(" 进入维护 ",-1)])),_:1,__:[27]})):I("",!0),v.status===u.DeviceStatus.OFFLINE?(m(),E(Q,{key:2,command:"activate"},{default:a(()=>r[28]||(r[28]=[g(" 激活设备 ",-1)])),_:1,__:[28]})):I("",!0),t(Q,{command:"firmware"},{default:a(()=>r[29]||(r[29]=[g(" 推送固件 ",-1)])),_:1,__:[29]}),t(Q,{command:"logs"},{default:a(()=>r[30]||(r[30]=[g(" 查看日志 ",-1)])),_:1,__:[30]}),t(Q,{command:"delete",divided:""},{default:a(()=>r[31]||(r[31]=[g(" 删除设备 ",-1)])),_:1,__:[31]})]),_:2},1024)]),default:a(()=>[t(J,{text:"",type:"primary",size:"small"},{default:a(()=>[r[25]||(r[25]=g(" 更多",-1)),t(T,{class:"el-icon--right"},{default:a(()=>[t(N(ke))]),_:1})]),_:1,__:[25]})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[Ie,o.value]]),e("div",_o,[t(je,{"current-page":U.value,"onUpdate:currentPage":r[4]||(r[4]=v=>U.value=v),"page-size":M.value,"onUpdate:pageSize":r[5]||(r[5]=v=>M.value=v),"page-sizes":[10,20,50,100],total:L.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ee,onCurrentChange:se},null,8,["current-page","page-size","total"])])]),t(ol,{modelValue:h.value,"onUpdate:modelValue":r[6]||(r[6]=v=>h.value=v),device:K.value,onEdit:W,onStatusChange:pe},null,8,["modelValue","device"]),t(fl,{modelValue:l.value,"onUpdate:modelValue":r[7]||(r[7]=v=>l.value=v),device:y.value,onSuccess:_e},null,8,["modelValue","device"]),t(El,{modelValue:s.value,"onUpdate:modelValue":r[8]||(r[8]=v=>s.value=v),device:K.value},null,8,["modelValue","device"])])}}}),Co=ve(yo,[["__scopeId","data-v-32aae5e9"]]);export{Co as default};
