var $e=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ne=(o,c,s)=>c in o?$e(o,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[c]=s,se=(o,c)=>{for(var s in c||(c={}))Ue.call(c,s)&&ne(o,s,c[s]);if(le)for(var s of le(c))Ee.call(c,s)&&ne(o,s,c[s]);return o},re=(o,c)=>Te(o,De(c));var B=(o,c,s)=>new Promise((V,U)=>{var p=S=>{try{L(s.next(S))}catch(D){U(D)}},r=S=>{try{L(s.throw(S))}catch(D){U(D)}},L=S=>S.done?V(S.value):Promise.resolve(S.value).then(p,r);L((s=s.apply(o,c)).next())});import{i as J}from"./charts-4xgvsrqt.js";import{D as ie,o as Pe,k as Re,V as ze,W as Be,X as xe,p as Ae,q as Ie,b as W,n as Fe}from"./element-plus-B_LAMX2W.js";/* empty css                                                                     *//* empty css                                                                         */import{C as ce}from"./CommonDialog-C29ZBC5-.js";import{D as Ne}from"./DataTable-DvK2rlgw.js";import{C as Me}from"./CountUp-DhNxH7hh.js";import{x as te,c as N,al as _,y as k,z as i,D as Y,K as q,A as b,B as Z,O as x,Q as t,I as n,u as R,M as H,C as We,H as F,L as ue,P as X,a6 as j,r as E,X as qe,h as Oe,aB as He,n as Xe}from"./vue-C2NPAEWw.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as de}from"./StatusTag-CbYDBx1u.js";/* empty css                                                                       */import{a as je}from"./utils-T70AYnHr.js";import"./order-DgpU5ivT.js";/* empty css                                                                  *//* empty css                                                                  */const Ge={key:0,class:"card-header"},Ke={class:"header-left"},Qe={class:"card-title-section"},Je={class:"card-title"},Ye={key:0,class:"card-subtitle"},Ze={class:"header-right"},et={class:"card-content"},tt={key:0,class:"card-loading"},ot={key:1,class:"card-error"},at={key:2,class:"card-empty"},lt={key:3,class:"card-body"},nt={key:0,class:"number-display"},st={key:0,class:"card-title-inline"},rt={class:"main-value"},it={key:1,class:"value-change"},ct={key:1,class:"progress-display"},ut={class:"progress-info"},dt={class:"progress-label"},mt={class:"progress-value"},pt={key:2,class:"list-display"},vt={class:"item-label"},ft={class:"item-value"},gt={key:3,class:"custom-content"},ht={key:1,class:"card-footer"},yt={class:"footer-info"},kt={key:0,class:"update-time"},Ct=te({__name:"DataCard",props:{title:{default:""},subtitle:{default:""},type:{default:"custom"},value:{default:0},unit:{default:""},change:{default:void 0},changeType:{default:"percent"},icon:{default:void 0},iconClass:{default:""},valueColor:{default:""},progressLabel:{default:""},progressColor:{default:"#409eff"},progressStrokeWidth:{default:6},listData:{default:()=>[]},loading:{type:Boolean,default:!1},loadingText:{default:"加载中..."},error:{default:""},isEmpty:{type:Boolean,default:!1},emptyText:{default:"暂无数据"},showHeader:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},updateTime:{default:""},moreLink:{default:""},theme:{default:"default"},size:{default:"default"},clickable:{type:Boolean,default:!1},customClass:{default:""}},emits:["click","action","retry"],setup(o,{emit:c}){const s=o,V=c,U=N(()=>[`card-${s.theme}`,`card-${s.size}`,s.customClass,{clickable:s.clickable,"has-error":s.error,"is-loading":s.loading,"is-empty":s.isEmpty}]),p=N(()=>s.change===void 0?"":s.change>0?"change-positive":s.change<0?"change-negative":"change-neutral"),r=N(()=>s.change===void 0?ie:s.change>0?Pe:s.change<0?Re:ie),L=a=>{const g=Math.abs(a),d=a>0?"+":a<0?"-":"",u=s.changeType==="percent"?"%":"";return`${d}${g}${u}`},S=a=>a?new Date(a).toLocaleString("zh-CN"):"",D=a=>{V("action",a)},A=()=>{V("retry")};return(a,g)=>{const d=_("el-icon"),u=_("el-button"),P=_("el-dropdown-item"),$=_("el-dropdown-menu"),T=_("el-dropdown"),M=_("el-progress"),y=_("el-link");return i(),k("div",{class:Y(["data-card",U.value])},[a.showHeader?(i(),k("div",Ge,[b("div",Ke,[a.icon||a.$slots.icon?(i(),k("div",{key:0,class:Y(["card-icon",a.iconClass])},[Z(a.$slots,"icon",{},()=>[a.icon?(i(),F(d,{key:0},{default:n(()=>[(i(),F(ue(a.icon)))]),_:1})):q("",!0)],!0)],2)):q("",!0),b("div",Qe,[b("h3",Je,x(a.title),1),a.subtitle?(i(),k("p",Ye,x(a.subtitle),1)):q("",!0)])]),b("div",Ze,[Z(a.$slots,"header-actions",{},()=>[a.showActions?(i(),F(T,{key:0,onCommand:D},{dropdown:n(()=>[t($,null,{default:n(()=>[t(P,{command:"refresh"},{default:n(()=>g[0]||(g[0]=[H("刷新",-1)])),_:1,__:[0]}),t(P,{command:"export"},{default:n(()=>g[1]||(g[1]=[H("导出",-1)])),_:1,__:[1]}),t(P,{command:"settings"},{default:n(()=>g[2]||(g[2]=[H("设置",-1)])),_:1,__:[2]})]),_:1})]),default:n(()=>[t(u,{text:"",icon:R(Ae)},null,8,["icon"])]),_:1})):q("",!0)],!0)])])):q("",!0),b("div",et,[a.loading?(i(),k("div",tt,[t(d,{class:"is-loading"},{default:n(()=>[t(R(ze))]),_:1}),b("span",null,x(a.loadingText),1)])):a.error?(i(),k("div",ot,[t(d,null,{default:n(()=>[t(R(Be))]),_:1}),b("span",null,x(a.error),1),t(u,{type:"primary",size:"small",onClick:A},{default:n(()=>g[3]||(g[3]=[H("重试",-1)])),_:1,__:[3]})])):a.isEmpty?(i(),k("div",at,[t(d,null,{default:n(()=>[t(R(xe))]),_:1}),b("span",null,x(a.emptyText),1)])):(i(),k("div",lt,[a.type==="number"?(i(),k("div",nt,[a.title?(i(),k("div",st,x(a.title),1)):q("",!0),b("div",rt,[t(Me,{value:Number(a.value),duration:1500,decimals:0,suffix:a.unit,class:"value-number",style:We({color:a.valueColor})},null,8,["value","suffix","style"])]),a.change!==void 0?(i(),k("div",it,[t(d,{class:Y(p.value)},{default:n(()=>[(i(),F(ue(r.value)))]),_:1},8,["class"]),b("span",{class:Y(p.value)},x(L(a.change)),3)])):q("",!0)])):a.type==="progress"?(i(),k("div",ct,[b("div",ut,[b("span",dt,x(a.progressLabel),1),b("span",mt,x(a.value)+x(a.unit||"%"),1)]),t(M,{percentage:Number(a.value),color:a.progressColor,"stroke-width":a.progressStrokeWidth,"show-text":!1},null,8,["percentage","color","stroke-width"])])):a.type==="list"?(i(),k("div",pt,[(i(!0),k(X,null,j(a.listData,(I,h)=>(i(),k("div",{key:h,class:"list-item"},[b("div",vt,x(I.label),1),b("div",ft,x(I.value),1)]))),128))])):(i(),k("div",gt,[Z(a.$slots,"default",{},void 0,!0)]))]))]),a.showFooter||a.$slots.footer?(i(),k("div",ht,[Z(a.$slots,"footer",{},()=>[b("div",yt,[a.updateTime?(i(),k("span",kt," 更新时间: "+x(S(a.updateTime)),1)):q("",!0),a.moreLink?(i(),F(y,{key:1,type:"primary",href:a.moreLink,underline:!1},{default:n(()=>g[4]||(g[4]=[H(" 查看更多 ",-1)])),_:1,__:[4]},8,["href"])):q("",!0)])],!0)])):q("",!0)],2)}}}),ee=oe(Ct,[["__scopeId","data-v-42bdc7bd"]]),bt=o=>{{console.log("🔧 Mock拦截器已禁用");return}},_t={baseURL:"/",timeout:1e4,withCredentials:!0},O=je.create(_t);O.interceptors.request.use(o=>{var s;const c=localStorage.getItem("token");return c&&o.headers&&(o.headers.Authorization=`Bearer ${c}`),o.params?o.params._t=Date.now():o.params={_t:Date.now()},console.log("API请求:",(s=o.method)==null?void 0:s.toUpperCase(),o.url,o.data||o.params),o},o=>(console.error("请求拦截器错误:",o),Promise.reject(o)));O.interceptors.response.use(o=>(console.log("API响应:",o.config.url,o.status,o.data),o.data&&typeof o.data=="object"?o.data:o),o=>{var c,s,V,U,p;return console.error("API响应错误:",(c=o.response)==null?void 0:c.status,((s=o.response)==null?void 0:s.data)||o.message),((V=o.response)==null?void 0:V.status)===401?(localStorage.removeItem("token"),window.location.href="/login"):((U=o.response)==null?void 0:U.status)===403?console.error("权限不足"):((p=o.response)==null?void 0:p.status)>=500&&console.error("服务器错误"),Promise.reject(o)});bt();const wt=o=>O.get("/platform-links",{params:o}),Vt=o=>O.post("/platform-links",o),Lt=(o,c)=>O.put(`/platform-links/${o}`,c),St=o=>O.delete(`/platform-links/${o}`),$t=o=>O.put("/platform-links/batch",o),Tt=()=>O.get("/platform-stats"),Dt=()=>O.get("/platform-links/regions"),Ut=(o,c)=>O.patch(`/platform-links/${o}/toggle`,{isEnabled:c}),Et={class:"platform-link-form"},Pt=te({__name:"PlatformLinkForm",props:{modelValue:{},regions:{},editing:{type:Boolean}},emits:["update:modelValue"],setup(o,{expose:c,emit:s}){const V=o,U=s,p=E(),r=N({get:()=>V.modelValue,set:d=>U("update:modelValue",d)}),L=N(()=>V.regions.find(d=>d.region===r.value.region)),S=N(()=>{const d=new Set;return V.regions.forEach(u=>{u.country&&d.add(u.country)}),Array.from(d).map(u=>({name:u,code:u}))}),D=N(()=>{var d;return((d=L.value)==null?void 0:d.languages)||[]}),A={platformName:[{required:!0,message:"请输入平台名称",trigger:"blur"}],platformType:[{required:!0,message:"请选择平台类型",trigger:"change"}],linkUrl:[{required:!0,message:"请输入链接地址",trigger:"blur"},{type:"url",message:"请输入有效的URL地址",trigger:"blur"}],region:[{required:!0,message:"请选择地区",trigger:"change"}],country:[{required:!0,message:"请选择国家",trigger:"change"}],languageCode:[{required:!0,message:"请选择语言",trigger:"change"}]},a=()=>{r.value.country="",r.value.languageCode=""};return c({validate:()=>B(null,null,function*(){if(!p.value)return!1;try{return yield p.value.validate(),!0}catch(d){return!1}})}),(d,u)=>{const P=_("el-input"),$=_("el-form-item"),T=_("el-option"),M=_("el-select"),y=_("el-switch"),I=_("el-form");return i(),k("div",Et,[t(I,{ref_key:"formRef",ref:p,model:r.value,rules:A,"label-width":"120px"},{default:n(()=>[t($,{label:"平台名称",prop:"platformName"},{default:n(()=>[t(P,{modelValue:r.value.platformName,"onUpdate:modelValue":u[0]||(u[0]=h=>r.value.platformName=h),placeholder:"请输入平台名称"},null,8,["modelValue"])]),_:1}),t($,{label:"平台类型",prop:"platformType"},{default:n(()=>[t(M,{modelValue:r.value.platformType,"onUpdate:modelValue":u[1]||(u[1]=h=>r.value.platformType=h),placeholder:"请选择平台类型",style:{width:"100%"}},{default:n(()=>[t(T,{label:"电商平台",value:"ecommerce"}),t(T,{label:"租赁平台",value:"rental"})]),_:1},8,["modelValue"])]),_:1}),t($,{label:"链接地址",prop:"linkUrl"},{default:n(()=>[t(P,{modelValue:r.value.linkUrl,"onUpdate:modelValue":u[2]||(u[2]=h=>r.value.linkUrl=h),placeholder:"请输入链接地址",type:"url"},null,8,["modelValue"])]),_:1}),t($,{label:"地区",prop:"region"},{default:n(()=>[t(M,{modelValue:r.value.region,"onUpdate:modelValue":u[3]||(u[3]=h=>r.value.region=h),placeholder:"请选择地区",style:{width:"100%"},onChange:a},{default:n(()=>[(i(!0),k(X,null,j(d.regions,h=>(i(),F(T,{key:h.region,label:h.region,value:h.region},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"国家",prop:"country"},{default:n(()=>[t(M,{modelValue:r.value.country,"onUpdate:modelValue":u[4]||(u[4]=h=>r.value.country=h),placeholder:"请选择国家",style:{width:"100%"}},{default:n(()=>[(i(!0),k(X,null,j(S.value,h=>(i(),F(T,{key:h.code,label:h.name,value:h.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"语言",prop:"languageCode"},{default:n(()=>[t(M,{modelValue:r.value.languageCode,"onUpdate:modelValue":u[5]||(u[5]=h=>r.value.languageCode=h),placeholder:"请选择语言",style:{width:"100%"}},{default:n(()=>[(i(!0),k(X,null,j(D.value,h=>(i(),F(T,{key:h.code,label:h.name,value:h.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"启用状态"},{default:n(()=>[t(y,{modelValue:r.value.isEnabled,"onUpdate:modelValue":u[6]||(u[6]=h=>r.value.isEnabled=h),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])}}}),Rt=oe(Pt,[["__scopeId","data-v-1e01c480"]]),zt={class:"batch-update-form"},Bt={class:"form-tip"},xt=te({__name:"BatchUpdateForm",props:{modelValue:{},regions:{}},emits:["update:modelValue"],setup(o,{expose:c,emit:s}){const V=o,U=s,p=E(),r=N({get:()=>V.modelValue,set:g=>U("update:modelValue",g)}),L=N(()=>V.regions.find(g=>g.region===r.value.region)),S=N(()=>{var g;return((g=L.value)==null?void 0:g.countries)||[]}),D=N(()=>{var g;return((g=L.value)==null?void 0:g.languages)||[]}),A=()=>{r.value.country=void 0,r.value.languageCode=void 0};return c({validate:()=>B(null,null,function*(){return!0})}),(g,d)=>{const u=_("el-option"),P=_("el-select"),$=_("el-form-item"),T=_("el-form"),M=_("el-alert");return i(),k("div",zt,[t(T,{ref_key:"formRef",ref:p,model:r.value,"label-width":"120px"},{default:n(()=>[t($,{label:"平台类型"},{default:n(()=>[t(P,{modelValue:r.value.platformType,"onUpdate:modelValue":d[0]||(d[0]=y=>r.value.platformType=y),placeholder:"请选择平台类型（可选）",style:{width:"100%"},clearable:""},{default:n(()=>[t(u,{label:"电商平台",value:"ecommerce"}),t(u,{label:"租赁平台",value:"rental"})]),_:1},8,["modelValue"])]),_:1}),t($,{label:"地区"},{default:n(()=>[t(P,{modelValue:r.value.region,"onUpdate:modelValue":d[1]||(d[1]=y=>r.value.region=y),placeholder:"请选择地区（可选）",style:{width:"100%"},clearable:"",onChange:A},{default:n(()=>[(i(!0),k(X,null,j(g.regions,y=>(i(),F(u,{key:y.region,label:y.region,value:y.region},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"国家"},{default:n(()=>[t(P,{modelValue:r.value.country,"onUpdate:modelValue":d[2]||(d[2]=y=>r.value.country=y),placeholder:"请选择国家（可选）",style:{width:"100%"},clearable:""},{default:n(()=>[(i(!0),k(X,null,j(S.value,y=>(i(),F(u,{key:y.code,label:y.name,value:y.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"语言"},{default:n(()=>[t(P,{modelValue:r.value.languageCode,"onUpdate:modelValue":d[3]||(d[3]=y=>r.value.languageCode=y),placeholder:"请选择语言（可选）",style:{width:"100%"},clearable:""},{default:n(()=>[(i(!0),k(X,null,j(D.value,y=>(i(),F(u,{key:y.code,label:y.name,value:y.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"启用状态"},{default:n(()=>[t(P,{modelValue:r.value.isEnabled,"onUpdate:modelValue":d[4]||(d[4]=y=>r.value.isEnabled=y),placeholder:"请选择启用状态（可选）",style:{width:"100%"},clearable:""},{default:n(()=>[t(u,{label:"启用",value:!0}),t(u,{label:"禁用",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("div",Bt,[t(M,{title:"批量更新说明",description:"只有选择了值的字段才会被更新，未选择的字段保持原值不变",type:"info",closable:!1,"show-icon":""})])])}}}),At=oe(xt,[["__scopeId","data-v-3a1e801e"]]),It={class:"platforms-management"},Ft={class:"page-header"},Nt={class:"header-right"},Mt={class:"stats-cards"},Wt=te({__name:"Platforms",setup(o){const c=E(!1),s=E([]),V=E([]),U=E([]),p=E({totalLinks:0,activeLinks:0,inactiveLinks:0,totalClicks:0,totalConversions:0,conversionRate:0,topPerformingLinks:[],regionStats:[],languageStats:[]}),r=qe({page:1,pageSize:20,total:0}),L=E(!1),S=E(!1),D=E(null),A=E({platformName:"",platformType:"ecommerce",linkUrl:"",region:"",country:"",languageCode:"",isEnabled:!0}),a=E({}),g=E(),d=E(),u=[{prop:"platformName",label:"平台名称",minWidth:120},{prop:"platformType",label:"平台类型",width:100,type:"tag"},{prop:"linkUrl",label:"链接地址",minWidth:200,showOverflowTooltip:!0},{prop:"region",label:"地区",width:100},{prop:"languageName",label:"语言",width:100},{prop:"linkStatus",label:"状态",width:100,type:"tag"},{prop:"isEnabled",label:"启用",width:80},{prop:"clickCount",label:"点击量",width:100,align:"right"},{prop:"conversionCount",label:"转化量",width:100,align:"right"},{prop:"lastCheckedAt",label:"最后检查",width:150,type:"date"},{prop:"actions",label:"操作",width:180,fixed:"right"}],P={ecommerce:{text:"电商平台",type:"success"},rental:{text:"租赁平台",type:"info"}},$={active:{text:"正常",type:"success"},inactive:{text:"异常",type:"danger"},checking:{text:"检查中",type:"warning"},error:{text:"错误",type:"danger"}},T=()=>B(null,null,function*(){try{c.value=!0;const e=yield wt({page:r.page,pageSize:r.pageSize});e.code===200&&(s.value=e.data.list,r.total=e.data.total)}catch(e){console.error("加载数据失败:",e),W.error("加载数据失败")}finally{c.value=!1}}),M=()=>({totalLinks:80,activeLinks:65,inactiveLinks:15,totalClicks:285420,totalConversions:18650,conversionRate:6.53,topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654},{name:"天猫",clicks:15420,conversions:1234},{name:"eBay",clicks:12340,conversions:987}],regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],languageStats:[{language:"简体中文",linkCount:28,clicks:145230,conversions:9876},{language:"英语",linkCount:22,clicks:98450,conversions:6234},{language:"日语",linkCount:12,clicks:41740,conversions:2540},{language:"韩语",linkCount:10,clicks:24430,conversions:1581},{language:"德语",linkCount:8,clicks:18650,conversions:1104}]}),y=e=>{if(!e)return!1;const C=["totalLinks","activeLinks","totalClicks","conversionRate"].every(m=>e[m]!==void 0),v=Array.isArray(e.regionStats)&&e.regionStats.length>0,w=Array.isArray(e.topPerformingLinks);return C&&v&&w},I=()=>B(null,null,function*(){try{console.log("📊 开始加载统计数据..."),c.value=!0;const e=yield Tt();if(console.log("📊 统计数据响应:",e),e.code===200&&y(e.data))p.value=e.data,console.log("📊 API统计数据已设置:",p.value);else throw new Error("API数据无效或不完整")}catch(e){console.warn("📊 API加载失败，使用默认数据:",e),p.value=M(),console.log("📊 默认统计数据已设置:",p.value)}finally{c.value=!1,yield Xe(),console.log("📊 数据加载完成，开始初始化图表..."),ae()}}),h=E({regionChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},platformTypeChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},clickTrendChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0},conversionChart:{isLoading:!0,hasError:!1,isInitialized:!1,retryCount:0}}),me=(e,l=10)=>new Promise((C,v)=>{let w=0;const m=()=>{const f=document.getElementById(e);f&&f.offsetWidth>0&&f.offsetHeight>0?(console.log(`✅ 容器 ${e} 已就绪:`,{width:f.offsetWidth,height:f.offsetHeight}),C(f)):w<l?(w++,console.log(`⏳ 等待容器 ${e} 就绪... (${w}/${l})`),setTimeout(m,200)):(console.error(`❌ 容器 ${e} 超时未就绪`),v(new Error(`Container ${e} not ready after ${l} retries`)))};m()}),G=(e,l,C=3)=>B(null,null,function*(){var w;const v=h.value[e];try{console.log(`📊 开始初始化图表: ${e}`),v.isLoading=!0,v.hasError=!1,yield me(e),(!p.value||!((w=p.value.regionStats)!=null&&w.length)&&e==="regionChart")&&console.log(`📊 ${e} 数据未就绪，使用默认数据`),l(),v.isInitialized=!0,v.isLoading=!1,console.log(`✅ 图表 ${e} 初始化成功`)}catch(m){console.error(`❌ 图表 ${e} 初始化失败:`,m),v.hasError=!0,v.isLoading=!1,v.retryCount++,v.retryCount<C?(console.log(`🔄 重试初始化图表 ${e} (${v.retryCount}/${C})`),setTimeout(()=>{G(e,l,C)},1e3*v.retryCount)):console.error(`💥 图表 ${e} 初始化最终失败，已达到最大重试次数`)}}),ae=()=>B(null,null,function*(){var l;console.log("🚀 开始初始化所有图表..."),(l=p.value.regionStats)!=null&&l.length||(console.log("📊 设置默认图表数据..."),p.value=re(se({},p.value),{regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654}]}));const e=[G("regionChart",pe),G("platformTypeChart",ve),G("clickTrendChart",fe),G("conversionChart",ge)];try{yield Promise.allSettled(e),console.log("🎉 所有图表初始化完成!")}catch(C){console.error("💥 图表初始化过程中出现错误:",C)}}),pe=()=>{const e=document.getElementById("regionChart");if(!e){console.error("地区分布图表容器未找到");return}console.log("📊 初始化地区分布图表，数据:",p.value.regionStats);const l=J(e),C=p.value.regionStats.length>0?p.value.regionStats.map(w=>({value:w.linkCount,name:w.region})):[{value:25,name:"中国大陆"},{value:18,name:"美国"},{value:12,name:"日本"},{value:10,name:"韩国"},{value:8,name:"德国"},{value:7,name:"其他地区"}],v={title:{text:"地区分布统计",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}个链接 ({d}%)"},legend:{orient:"vertical",left:"left",top:"middle"},series:[{name:"地区分布",type:"pie",radius:["40%","70%"],center:["60%","50%"],data:C,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,formatter:"{b}: {c}"},labelLine:{show:!0}}],color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452"]};l.setOption(v),console.log("✅ 地区分布图表初始化完成")},ve=()=>{const e=document.getElementById("platformTypeChart");if(!e){console.error("平台类型图表容器未找到");return}const l=J(e),C=s.value.filter(f=>f.platformType==="ecommerce").length,v=s.value.filter(f=>f.platformType==="rental").length;console.log("📊 平台类型统计:",{ecommerceCount:C,rentalCount:v});const m={title:{text:"平台类型分布",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c}个链接 ({d}%)"},legend:{orient:"horizontal",bottom:"10%",left:"center"},series:[{name:"平台类型",type:"pie",radius:["30%","60%"],center:["50%","45%"],data:[{value:C||52,name:"电商平台"},{value:v||28,name:"租赁平台"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!0,formatter:"{b}: {c}个\\n({d}%)"},labelLine:{show:!1}}],color:["#5470c6","#91cc75"]};l.setOption(m),console.log("📊 平台类型图表初始化完成")},fe=()=>{const e=document.getElementById("clickTrendChart");if(!e){console.error("点击量趋势图表容器未找到");return}const l=J(e),C=[],v=[],w=[],m=new Date;for(let z=29;z>=0;z--){const K=new Date(m);K.setDate(K.getDate()-z),C.push(K.toLocaleDateString("zh-CN",{month:"short",day:"numeric"}));const Q=3e3+Math.sin(z*.2)*1e3+Math.random()*800,Se=Q*(.05+Math.random()*.03);v.push(Math.floor(Q)),w.push(Math.floor(Se))}console.log("📊 点击量趋势数据:",{dates:C.slice(-7),clicks:v.slice(-7)});const f={title:{text:"点击量趋势（最近30天）",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["点击量","转化量"],top:"10%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},xAxis:{type:"category",data:C,axisLabel:{rotate:45}},yAxis:[{type:"value",name:"点击量",position:"left",axisLabel:{formatter:"{value}"}},{type:"value",name:"转化量",position:"right",axisLabel:{formatter:"{value}"}}],series:[{name:"点击量",type:"line",yAxisIndex:0,data:v,smooth:!0,itemStyle:{color:"#5470c6"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(84, 112, 198, 0.3)"},{offset:1,color:"rgba(84, 112, 198, 0.1)"}]}}},{name:"转化量",type:"line",yAxisIndex:1,data:w,smooth:!0,itemStyle:{color:"#91cc75"}}]};l.setOption(f),console.log("📊 点击量趋势图表初始化完成")},ge=()=>{var w,m;const e=document.getElementById("conversionChart");if(!e){console.error("转化率对比图表容器未找到");return}const l=J(e),C=((m=(w=p.value)==null?void 0:w.regionStats)==null?void 0:m.map(f=>({region:f.region,conversionRate:(f.conversions/f.clicks*100).toFixed(2),clicks:f.clicks,conversions:f.conversions})))||[{region:"中国大陆",conversionRate:"7.12",clicks:125680,conversions:8945},{region:"美国",conversionRate:"5.85",clicks:89420,conversions:5234},{region:"日本",conversionRate:"6.30",clicks:45890,conversions:2890},{region:"韩国",conversionRate:"6.47",clicks:24430,conversions:1581},{region:"德国",conversionRate:"5.92",clicks:18650,conversions:1104},{region:"法国",conversionRate:"6.18",clicks:15420,conversions:953}];console.log("📊 转化率对比数据:",C);const v={title:{text:"各地区转化率对比",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(f){const z=C[f[0].dataIndex];if(!z)return"";const K=z.clicks||0,Q=z.conversions||0;return`${z.region}<br/>转化率: ${z.conversionRate}%<br/>点击量: ${K.toLocaleString()}<br/>转化量: ${Q.toLocaleString()}`}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:C.map(f=>f.region),axisLabel:{rotate:45}},yAxis:{type:"value",axisLabel:{formatter:"{value}%"},min:0,max:10},series:[{name:"转化率",type:"bar",data:C.map(f=>parseFloat(f.conversionRate)),itemStyle:{color:function(f){const z=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272"];return z[f.dataIndex%z.length]}},label:{show:!0,position:"top",formatter:"{c}%"}}]};l.setOption(v),console.log("📊 转化率对比图表初始化完成")},he=()=>B(null,null,function*(){try{const e=yield Dt();e.code===200&&(U.value=e.data)}catch(e){console.error("加载区域配置失败:",e)}}),ye=e=>{r.page=e,T()},ke=e=>{r.pageSize=e,r.page=1,T()},Ce=e=>{V.value=e},be=e=>{D.value=e,A.value={platformName:e.platformName,platformType:e.platformType,linkUrl:e.linkUrl,region:e.region,country:e.country,languageCode:e.languageCode,isEnabled:e.isEnabled},L.value=!0},_e=()=>B(null,null,function*(){var e;try{if(!((e=g.value)!=null&&e.validate()))return;D.value?(yield Lt(D.value.id,A.value)).code===200&&(W.success("更新成功"),L.value=!1,D.value=null,T(),I()):(yield Vt(A.value)).code===200&&(W.success("创建成功"),L.value=!1,T(),I())}catch(l){console.error("保存失败:",l),W.error("保存失败")}}),we=e=>B(null,null,function*(){try{yield Fe.confirm("确定要删除这个链接吗？","确认删除",{type:"warning"}),(yield St(e)).code===200&&(W.success("删除成功"),T(),I())}catch(l){l!=="cancel"&&(console.error("删除失败:",l),W.error("删除失败"))}}),Ve=()=>B(null,null,function*(){var e;try{if(!((e=d.value)!=null&&e.validate()))return;const l=V.value.map(v=>v.id);(yield $t({linkIds:l,updates:a.value})).code===200&&(W.success("批量更新成功"),S.value=!1,a.value={},V.value=[],T(),I())}catch(l){console.error("批量更新失败:",l),W.error("批量更新失败")}}),Le=e=>B(null,null,function*(){try{(yield Ut(e.id,e.isEnabled)).code===200&&(W.success(e.isEnabled?"已启用":"已禁用"),I())}catch(l){console.error("切换状态失败:",l),W.error("切换状态失败"),e.isEnabled=!e.isEnabled}});return Oe(()=>B(null,null,function*(){console.log("🚀 平台链接管理页面加载中...");try{yield he(),yield T(),yield I(),setTimeout(()=>{console.log("🔄 强制重新初始化图表..."),ae()},1e3),console.log("✅ 平台链接管理页面数据加载完成")}catch(e){console.error("❌ 平台链接管理页面数据加载失败:",e),p.value={totalLinks:80,activeLinks:65,inactiveLinks:15,totalClicks:285420,totalConversions:18650,conversionRate:6.53,topPerformingLinks:[{name:"淘宝",clicks:45680,conversions:3245},{name:"京东",clicks:32450,conversions:2156},{name:"亚马逊",clicks:28900,conversions:1890},{name:"拼多多",clicks:18650,conversions:1654}],regionStats:[{region:"中国大陆",linkCount:25,clicks:125680,conversions:8945},{region:"美国",linkCount:18,clicks:89420,conversions:5234},{region:"日本",linkCount:12,clicks:45890,conversions:2890},{region:"韩国",linkCount:10,clicks:24430,conversions:1581},{region:"德国",linkCount:8,clicks:18650,conversions:1104},{region:"法国",linkCount:7,clicks:15420,conversions:953}],languageStats:[{language:"简体中文",linkCount:28,clicks:145230,conversions:9876},{language:"英语",linkCount:22,clicks:98450,conversions:6234},{language:"日语",linkCount:12,clicks:41740,conversions:2540},{language:"韩语",linkCount:10,clicks:24430,conversions:1581},{language:"德语",linkCount:8,clicks:18650,conversions:1104}]},setTimeout(()=>{console.log("🔄 加载失败后强制初始化图表..."),ae()},1e3)}})),(e,l)=>{const C=_("el-icon"),v=_("el-button"),w=_("el-switch");return i(),k("div",It,[b("div",Ft,[l[6]||(l[6]=b("div",{class:"header-left"},[b("h2",null,"平台链接管理"),b("p",{class:"page-description"},"管理电商平台和租赁平台的链接配置")],-1)),b("div",Nt,[t(v,{type:"primary",onClick:l[0]||(l[0]=m=>L.value=!0)},{default:n(()=>[t(C,null,{default:n(()=>[t(R(Ie))]),_:1}),l[5]||(l[5]=H(" 添加链接 ",-1))]),_:1,__:[5]})])]),b("div",Mt,[t(R(ee),{title:"总链接数",type:"number",value:p.value.totalLinks,theme:"primary","show-header":!1},null,8,["value"]),t(R(ee),{title:"活跃链接",type:"number",value:p.value.activeLinks,theme:"success","show-header":!1},null,8,["value"]),t(R(ee),{title:"总点击量",type:"number",value:p.value.totalClicks,theme:"warning","show-header":!1},null,8,["value"]),t(R(ee),{title:"转化率",type:"number",value:p.value.conversionRate,unit:"%",theme:"danger","show-header":!1},null,8,["value"])]),l[9]||(l[9]=He('<div class="charts-section" data-v-25f8251a><div class="chart-row" data-v-25f8251a><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📍 地区分布统计</h3></div><div class="chart-content" data-v-25f8251a><div id="regionChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>🏪 平台类型分布</h3></div><div class="chart-content" data-v-25f8251a><div id="platformTypeChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div></div><div class="chart-row" data-v-25f8251a><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📈 点击量趋势</h3></div><div class="chart-content" data-v-25f8251a><div id="clickTrendChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div><div class="chart-item" data-v-25f8251a><div class="chart-header" data-v-25f8251a><h3 class="chart-title" data-v-25f8251a>📊 转化率对比</h3></div><div class="chart-content" data-v-25f8251a><div id="conversionChart" class="chart-canvas" style="width:100%;height:300px;" data-v-25f8251a></div></div></div></div></div>',1)),t(R(Ne),{data:s.value,columns:u,loading:c.value,"show-toolbar":!1,"show-selection":!0,"show-actions":!0,"show-edit":!1,"show-delete":!1,onSelectionChange:Ce,onPageChange:ye,onSizeChange:ke},{platformType:n(({row:m})=>[t(R(de),{status:m.platformType,"status-map":P},null,8,["status"])]),linkStatus:n(({row:m})=>[t(R(de),{status:m.linkStatus,"status-map":$},null,8,["status"])]),isEnabled:n(({row:m})=>[t(w,{modelValue:m.isEnabled,"onUpdate:modelValue":f=>m.isEnabled=f,onChange:f=>Le(m)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),actions:n(({row:m})=>[t(v,{size:"small",type:"primary",onClick:f=>be(m)},{default:n(()=>l[7]||(l[7]=[H(" 编辑 ",-1)])),_:2,__:[7]},1032,["onClick"]),t(v,{size:"small",type:"danger",onClick:f=>we(m.id)},{default:n(()=>l[8]||(l[8]=[H(" 删除 ",-1)])),_:2,__:[8]},1032,["onClick"])]),_:1},8,["data","loading"]),t(R(ce),{modelValue:L.value,"onUpdate:modelValue":l[2]||(l[2]=m=>L.value=m),title:D.value?"编辑链接":"添加链接",width:"600px",onConfirm:_e},{default:n(()=>[t(Rt,{ref_key:"linkFormRef",ref:g,modelValue:A.value,"onUpdate:modelValue":l[1]||(l[1]=m=>A.value=m),regions:U.value,editing:!!D.value},null,8,["modelValue","regions","editing"])]),_:1},8,["modelValue","title"]),t(R(ce),{modelValue:S.value,"onUpdate:modelValue":l[4]||(l[4]=m=>S.value=m),title:"批量更新链接",width:"500px",onConfirm:Ve},{default:n(()=>[t(At,{ref_key:"batchFormRef",ref:d,modelValue:a.value,"onUpdate:modelValue":l[3]||(l[3]=m=>a.value=m),regions:U.value},null,8,["modelValue","regions"])]),_:1},8,["modelValue"])])}}}),no=oe(Wt,[["__scopeId","data-v-25f8251a"]]);export{no as default};
