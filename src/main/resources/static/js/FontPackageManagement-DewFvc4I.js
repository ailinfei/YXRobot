var $t=Object.defineProperty,Vt=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var Xe=Object.getOwnPropertySymbols;var St=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable;var Ye=(i,d,u)=>d in i?$t(i,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):i[d]=u,Ee=(i,d)=>{for(var u in d||(d={}))St.call(d,u)&&Ye(i,u,d[u]);if(Xe)for(var u of Xe(d))Ft.call(d,u)&&Ye(i,u,d[u]);return i},Re=(i,d)=>Vt(i,Pt(d));var U=(i,d,u)=>new Promise((P,$)=>{var K=S=>{try{E(u.next(S))}catch(O){$(O)}},m=S=>{try{E(u.throw(S))}catch(O){$(O)}},E=S=>S.done?P(S.value):Promise.resolve(S.value).then(K,m);E((u=u.apply(i,d)).next())});import{x as We,r as _,c as Me,j as lt,al as g,H as R,z as f,I as t,Q as e,A as a,y as C,K as j,M as p,O as c,P as de,a6 as ce,u as G,a4 as st,h as ot,C as It,n as Mt,D as zt,S as Ut,ar as At,J as Dt,V as Bt}from"./vue-C2NPAEWw.js";import{v as Et,b as T,w as nt,a7 as Rt,av as Ot,aw as Be,c as Oe,V as et,am as tt,aa as Wt,q as qt,R as Gt,n as Ie,E as at}from"./element-plus-BHn0tN3r.js";/* empty css                                                                     *//* empty css                                                                         *//* empty css                                                                  */import{D as Lt}from"./DataTable-D7dcJYrF.js";/* empty css                                                                  */import"./charts-4xgvsrqt.js";/* empty css                                                                       */import{_ as qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B=[{id:1,name:"经典楷书字体包",description:"传统楷书风格，适合初学者练习",version:"v1.0.0",fontType:"kaishu",difficulty:2,tags:["经典","教学","楷书"],status:"completed",createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-01-20T15:30:00Z",createdBy:"admin",targetCharacters:["一","二","三","四","五","六","七","八","九","十"]},{id:2,name:"现代行书字体包",description:"现代行书风格，流畅美观",version:"v1.2.0",fontType:"xingshu",difficulty:4,tags:["现代","美观","行书"],status:"training",createdAt:"2024-02-01T09:00:00Z",updatedAt:"2024-02-05T12:00:00Z",createdBy:"admin",targetCharacters:["春","夏","秋","冬","东","南","西","北"]},{id:3,name:"古典隶书字体包",description:"汉代隶书风格，庄重典雅",version:"v1.0.0",fontType:"lishu",difficulty:3,tags:["古典","隶书","庄重"],status:"draft",createdAt:"2024-02-10T14:00:00Z",updatedAt:"2024-02-10T14:00:00Z",createdBy:"user1",targetCharacters:["天","地","人","和","山","水","日","月"]},{id:4,name:"创意草书字体包",description:"现代创意草书，艺术感强",version:"v2.0.0",fontType:"caoshu",difficulty:5,tags:["创意","草书","艺术"],status:"failed",createdAt:"2024-01-25T11:00:00Z",updatedAt:"2024-01-30T16:00:00Z",createdBy:"user2",targetCharacters:["风","花","雪","月","诗","酒","茶","琴"]},{id:5,name:"标准篆书字体包",description:"小篆风格，适合印章制作",version:"v1.1.0",fontType:"zhuanshu",difficulty:4,tags:["篆书","印章","标准"],status:"completed",createdAt:"2024-01-20T08:00:00Z",updatedAt:"2024-01-28T10:00:00Z",createdBy:"admin",targetCharacters:["福","寿","康","宁","吉","祥","如","意"]}],J=i=>new Promise(d=>setTimeout(d,i)),ne={getFontPackages(i){return U(this,null,function*(){yield J(500);let d=[...B];if(i!=null&&i.keyword){const m=i.keyword.toLowerCase();d=d.filter(E=>E.name.toLowerCase().includes(m)||E.description.toLowerCase().includes(m)||E.tags.some(S=>S.toLowerCase().includes(m)))}i!=null&&i.status&&(d=d.filter(m=>m.status===i.status)),i!=null&&i.fontType&&(d=d.filter(m=>m.fontType===i.fontType)),i!=null&&i.difficulty&&(d=d.filter(m=>m.difficulty.toString()===i.difficulty)),i!=null&&i.creator&&(d=d.filter(m=>m.createdBy===i.creator)),i!=null&&i.sortBy&&d.sort((m,E)=>{const S=m[i.sortBy],O=E[i.sortBy];return S===void 0&&O===void 0?0:S===void 0?1:O===void 0?-1:i.sortOrder==="desc"?S>O?-1:1:S>O?1:-1});const u=(i==null?void 0:i.page)||1,P=(i==null?void 0:i.pageSize)||10,$=(u-1)*P,K=$+P;return{data:{list:d.slice($,K),total:d.length,page:u,pageSize:P}}})},getFontPackageById(i){return U(this,null,function*(){yield J(300);const d=B.find(u=>u.id===i);if(!d)throw new Error("字体包不存在");return d})},createFontPackage(i){return U(this,null,function*(){yield J(1e3);const d=Re(Ee({id:Date.now()},i),{status:"draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"current-user"});return B.push(d),d})},createFontPackageFromWizard(i){return U(this,null,function*(){yield J(1500);const d={id:Date.now(),name:i.basicInfo.name,description:i.basicInfo.description,version:i.basicInfo.version,fontType:i.basicInfo.fontType,difficulty:i.basicInfo.difficulty,tags:i.basicInfo.tags,targetCharacters:i.sampleUpload.targetCharacters,status:"training",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"current-user",trainingProgress:{percentage:0,currentPhase:{name:"初始化",description:"准备训练环境",status:"running",progress:0},estimatedTimeRemaining:3600,charactersCompleted:0,charactersTotal:i.sampleUpload.targetCharacters.length,currentCharacter:i.sampleUpload.targetCharacters[0]||"",startTime:new Date().toISOString(),logs:[{timestamp:new Date().toISOString(),level:"info",message:"开始训练字体包",details:{packageName:i.basicInfo.name}}]}};return B.push(d),d})},saveWizardDraft(i){return U(this,null,function*(){return yield J(500),console.log("保存向导草稿:",i),{success:!0}})},getTrainingProgress(i){return U(this,null,function*(){yield J(200);const d=B.find(P=>P.id===i);if(!d||!d.trainingProgress)throw new Error("训练进度不存在");const u=d.trainingProgress;return u.percentage<100&&(u.percentage=Math.min(u.percentage+Math.random()*5,100),u.charactersCompleted=Math.floor(u.percentage/100*u.charactersTotal),u.estimatedTimeRemaining=Math.max(u.estimatedTimeRemaining-30,0),u.charactersCompleted<d.targetCharacters.length&&(u.currentCharacter=d.targetCharacters[u.charactersCompleted]),u.percentage<20?u.currentPhase={name:"数据预处理",description:"处理样本数据",status:"running",progress:u.percentage*5}:u.percentage<80?u.currentPhase={name:"模型训练",description:"训练AI模型",status:"running",progress:(u.percentage-20)*1.67}:u.currentPhase={name:"质量评估",description:"评估生成质量",status:"running",progress:(u.percentage-80)*5},Math.random()<.3&&u.logs.push({timestamp:new Date().toISOString(),level:"info",message:`正在训练字符: ${u.currentCharacter}`,details:{progress:u.percentage,phase:u.currentPhase.name}})),u})},getQualityReport(i){return U(this,null,function*(){yield J(800);const d=B.find(P=>P.id===i);if(!d)throw new Error("字体包不存在");return{overallScore:Math.floor(Math.random()*20)+75,characterScores:d.targetCharacters.map(P=>({character:P,score:Math.floor(Math.random()*30)+70,issues:Math.random()>.7?["清晰度需要改进"]:[],sampleUrl:`/api/samples/${i}/${P}.png`})),metrics:{clarity:Math.floor(Math.random()*20)+75,consistency:Math.floor(Math.random()*20)+80,authenticity:Math.floor(Math.random()*20)+70,completeness:Math.floor(Math.random()*15)+85},recommendations:["建议增加更多样本以提高一致性","部分字符的笔画可以更加清晰","整体质量良好，可以考虑发布"],generatedAt:new Date().toISOString()}})},updateFontPackageStatus(i,d){return U(this,null,function*(){yield J(500);const u=B.find(P=>P.id===i);if(!u)throw new Error("字体包不存在");return u.status=d,u.updatedAt=new Date().toISOString(),u})},deleteFontPackage(i){return U(this,null,function*(){yield J(500);const d=B.findIndex(u=>u.id===i);if(d===-1)throw new Error("字体包不存在");return B.splice(d,1),{success:!0}})},uploadSampleFile(i,d){return U(this,null,function*(){return yield J(1e3+Math.random()*2e3),{url:`/api/uploads/samples/${Date.now()}_${i.name}`,filename:i.name,size:i.size}})},analyzeSampleFiles(i){return U(this,null,function*(){return yield J(2e3),{recognizedCharacters:Math.floor(i.length*.8),duplicates:i.slice(0,Math.floor(i.length*.1)).map((d,u)=>({file:d,original:i[u+1]||i[0]})),qualityScore:Math.floor(Math.random()*20)+75,qualityIssues:[{type:"clarity",message:"部分图片清晰度不足",severity:"medium",affectedFiles:i.slice(0,2)},{type:"size",message:"图片尺寸不统一",severity:"low",affectedFiles:i.slice(2,4)}].slice(0,Math.floor(Math.random()*3))}})},getFontPackageStats(){return U(this,null,function*(){yield J(300);const i=B.length,d=B.filter(m=>m.status==="completed").length,u=B.filter(m=>m.status==="training").length,P=B.filter(m=>m.status==="failed").length,$=B.filter(m=>m.status==="draft").length;return{data:{totalPackages:i,publishedPackages:d,generatingPackages:u,failedPackages:P,totalSamples:i*150,totalCharacters:B.reduce((m,E)=>{var S;return m+(((S=E.targetCharacters)==null?void 0:S.length)||0)},0),averageAccuracy:87.5,averageGenerationTime:45,statusDistribution:{draft:$,training:u,completed:d,published:d,failed:P},typeDistribution:{kaishu:B.filter(m=>m.fontType==="kaishu").length,xingshu:B.filter(m=>m.fontType==="xingshu").length,lishu:B.filter(m=>m.fontType==="lishu").length,zhuanshu:B.filter(m=>m.fontType==="zhuanshu").length,caoshu:B.filter(m=>m.fontType==="caoshu").length,other:B.filter(m=>!["kaishu","xingshu","lishu","zhuanshu","caoshu"].includes(m.fontType)).length},recentActivity:{newPackagesThisWeek:Math.floor(i*.1),completedThisWeek:Math.floor(d*.2),publishedThisWeek:Math.floor(d*.15),totalDownloadsThisWeek:Math.floor(Math.random()*1e3)+500}}}})},startGeneration(i){return U(this,null,function*(){var u,P;yield J(1e3);const d=B.find($=>$.id===i);if(!d)throw new Error("字体包不存在");return d.status="training",d.updatedAt=new Date().toISOString(),{data:{task:{id:`task_${Date.now()}`,estimatedTime:Math.ceil((((u=d.targetCharacters)==null?void 0:u.length)||10)*2),totalCharacters:((P=d.targetCharacters)==null?void 0:P.length)||0}}}})},publishFontPackage(i,d){return U(this,null,function*(){yield J(800);const u=B.find(P=>P.id===i);if(!u)throw new Error("字体包不存在");if(u.status!=="completed")throw new Error("只有已完成的字体包才能发布");return u.status="published",u.updatedAt=new Date().toISOString(),{data:{success:!0,publishUrl:`/fonts/${u.id}/download`}}})},getGenerationProgress(i){return U(this,null,function*(){yield J(300);const d=B.find(P=>P.id===i);if(!d)throw new Error("字体包不存在");const u=Math.min(d.progress||0+Math.random()*5,100);return{data:{progress:{percentage:u,currentPhase:u<50?"数据预处理":"模型训练",estimatedTimeRemaining:Math.max(60-Math.floor(u*.6),0),status:u>=100?"completed":"training"}}}})}},Nt={class:"form-section"},jt={class:"form-section"},Zt={key:0,class:"character-input-section"},Jt={class:"character-preview"},Kt={class:"preview-header"},Qt={class:"character-list"},Ht={key:1,class:"preset-section"},Xt={key:2,class:"file-import-section"},Yt={class:"form-section"},ea={class:"tags-editor"},ta={class:"current-tags"},aa={class:"add-tag"},la={class:"preset-tags"},sa={class:"dialog-footer"},oa=We({__name:"FontPackageCreateDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(i,{emit:d}){const u=i,P=d,$=_(),K=_(!1),m=_("manual"),E=_(""),S=_([]),O=_(""),me=["AI生成","高质量","专业","教学","练习","标准","美观","实用","推荐","热门"],ye={common100:["一","二","三","四","五","六","七","八","九","十","人","大","小","上","下","左","右","中","国","家"],common500:["一","二","三","四","五","六","七","八","九","十"],primary:["一","二","三","四","五","六","七","八","九","十"],numbers:["一","二","三","四","五","六","七","八","九","十","百","千","万"],colors:["红","黄","蓝","绿","白","黑","灰","紫","粉","橙"]},b=_({name:"",description:"",version:"v1.0.0",fontType:"kaishu",difficulty:3,targetCharacters:[],tags:[]}),k={name:[{required:!0,message:"请输入字体包名称",trigger:"blur"},{min:2,max:50,message:"字体包名称长度在2-50个字符",trigger:"blur"}],fontType:[{required:!0,message:"请选择字体类型",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度等级",trigger:"change"}],description:[{required:!0,message:"请输入字体包描述",trigger:"blur"},{min:10,max:500,message:"描述长度在10-500个字符",trigger:"blur"}],targetCharacters:[{validator:(o,r,M)=>{!r||r.length===0?M(new Error("请至少添加一个目标字符")):r.length>1e3?M(new Error("目标字符数量不能超过1000个")):M()},trigger:"change"}]},Z=Me({get:()=>u.modelValue,set:o=>P("update:modelValue",o)}),v=Me(()=>b.value.name&&b.value.description&&b.value.fontType&&b.value.targetCharacters.length>0);lt(Z,o=>{o&&_e()});const _e=()=>{b.value={name:"",description:"",version:"v1.0.0",fontType:"kaishu",difficulty:3,targetCharacters:[],tags:[]},m.value="manual",E.value="",S.value=[],O.value=""},ie=()=>{b.value.targetCharacters=[],E.value="",S.value=[]},Q=()=>{const o=E.value.split(/[\s\n,，]+/).filter(r=>r.trim()&&/[\u4e00-\u9fa5]/.test(r)).filter((r,M,F)=>F.indexOf(r)===M);b.value.targetCharacters=o},oe=()=>{const o=new Set;S.value.forEach(r=>{(ye[r]||[]).forEach(F=>o.add(F))}),b.value.targetCharacters=Array.from(o)},re=o=>{const r=b.value.targetCharacters.indexOf(o);r>-1&&b.value.targetCharacters.splice(r,1)},pe=()=>{b.value.targetCharacters=[],E.value=""},q=()=>{const o=O.value.trim();o&&!b.value.tags.includes(o)&&(b.value.tags.push(o),O.value="")},A=o=>{b.value.tags.includes(o)||b.value.tags.push(o)},H=o=>{const r=b.value.tags.indexOf(o);r>-1&&b.value.tags.splice(r,1)},ue=o=>{const r=o.type==="text/plain"||o.name.endsWith(".csv"),M=o.size/1024/1024<10;return r?M?!0:(T.error("文件大小不能超过 10MB!"),!1):(T.error("只能上传 .txt 或 .csv 格式的文件!"),!1)},ze=(o,r)=>{T.success("文件上传成功，正在解析字符...");const M=new FileReader;M.onload=F=>{var fe;const N=((fe=F.target)==null?void 0:fe.result).split(/[\s\n,，]+/).filter(le=>le.trim()&&/[\u4e00-\u9fa5]/.test(le)).filter((le,ee,he)=>he.indexOf(le)===ee);b.value.targetCharacters=N,T.success(`成功导入 ${N.length} 个汉字`)},M.readAsText(r.raw)},Y=()=>{T.error("文件上传失败")},ae=()=>U(null,null,function*(){try{yield $.value.validate(),K.value=!0,yield ne.createFontPackage(b.value),T.success("字体包创建成功"),P("success"),I()}catch(o){console.error("创建失败:",o),T.error("创建失败，请检查表单信息")}finally{K.value=!1}}),I=()=>{Z.value=!1};return(o,r)=>{const M=g("el-input"),F=g("el-form-item"),L=g("el-col"),N=g("el-option"),fe=g("el-select"),le=g("el-row"),ee=g("el-radio"),he=g("el-radio-group"),ge=g("el-button"),be=g("el-tag"),ve=g("el-checkbox"),ke=g("el-checkbox-group"),Ve=g("el-icon"),Ue=g("el-upload"),te=g("el-form"),Ce=g("el-dialog");return f(),R(Ce,{modelValue:Z.value,"onUpdate:modelValue":r[9]||(r[9]=x=>Z.value=x),title:"创建字体包",width:"70%","before-close":I,class:"font-package-create-dialog"},{footer:t(()=>[a("div",sa,[e(ge,{onClick:I},{default:t(()=>r[26]||(r[26]=[p("取消",-1)])),_:1,__:[26]}),e(ge,{type:"primary",onClick:ae,loading:K.value,disabled:!v.value},{default:t(()=>r[27]||(r[27]=[p(" 创建字体包 ",-1)])),_:1,__:[27]},8,["loading","disabled"])])]),default:t(()=>[e(te,{ref_key:"formRef",ref:$,model:b.value,rules:k,"label-width":"120px",class:"create-form"},{default:t(()=>[a("div",Nt,[r[10]||(r[10]=a("h3",{class:"section-title"},"基本信息",-1)),e(le,{gutter:24},{default:t(()=>[e(L,{span:12},{default:t(()=>[e(F,{label:"字体包名称",prop:"name"},{default:t(()=>[e(M,{modelValue:b.value.name,"onUpdate:modelValue":r[0]||(r[0]=x=>b.value.name=x),placeholder:"请输入字体包名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(L,{span:12},{default:t(()=>[e(F,{label:"字体类型",prop:"fontType"},{default:t(()=>[e(fe,{modelValue:b.value.fontType,"onUpdate:modelValue":r[1]||(r[1]=x=>b.value.fontType=x),placeholder:"选择字体类型",style:{width:"100%"}},{default:t(()=>[e(N,{label:"楷书",value:"kaishu"}),e(N,{label:"行书",value:"xingshu"}),e(N,{label:"隶书",value:"lishu"}),e(N,{label:"篆书",value:"zhuanshu"}),e(N,{label:"草书",value:"caoshu"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,{gutter:24},{default:t(()=>[e(L,{span:12},{default:t(()=>[e(F,{label:"难度等级",prop:"difficulty"},{default:t(()=>[e(fe,{modelValue:b.value.difficulty,"onUpdate:modelValue":r[2]||(r[2]=x=>b.value.difficulty=x),placeholder:"选择难度等级",style:{width:"100%"}},{default:t(()=>[e(N,{label:"简单 ★☆☆☆☆",value:1}),e(N,{label:"较易 ★★☆☆☆",value:2}),e(N,{label:"中等 ★★★☆☆",value:3}),e(N,{label:"较难 ★★★★☆",value:4}),e(N,{label:"困难 ★★★★★",value:5})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(L,{span:12},{default:t(()=>[e(F,{label:"版本号",prop:"version"},{default:t(()=>[e(M,{modelValue:b.value.version,"onUpdate:modelValue":r[3]||(r[3]=x=>b.value.version=x),placeholder:"如：v1.0.0",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(F,{label:"字体包描述",prop:"description"},{default:t(()=>[e(M,{modelValue:b.value.description,"onUpdate:modelValue":r[4]||(r[4]=x=>b.value.description=x),type:"textarea",rows:4,placeholder:"请输入字体包描述...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),a("div",jt,[r[22]||(r[22]=a("h3",{class:"section-title"},"目标字符设置",-1)),e(F,{label:"字符输入方式"},{default:t(()=>[e(he,{modelValue:m.value,"onUpdate:modelValue":r[5]||(r[5]=x=>m.value=x),onChange:ie},{default:t(()=>[e(ee,{value:"manual"},{default:t(()=>r[11]||(r[11]=[p("手动输入",-1)])),_:1,__:[11]}),e(ee,{value:"preset"},{default:t(()=>r[12]||(r[12]=[p("预设字符集",-1)])),_:1,__:[12]}),e(ee,{value:"file"},{default:t(()=>r[13]||(r[13]=[p("文件导入",-1)])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1}),m.value==="manual"?(f(),C("div",Zt,[e(F,{label:"目标字符",prop:"targetCharacters"},{default:t(()=>[e(M,{modelValue:E.value,"onUpdate:modelValue":r[6]||(r[6]=x=>E.value=x),type:"textarea",rows:6,placeholder:"请输入要生成的汉字，每个字符之间用空格或换行分隔...",onInput:Q},null,8,["modelValue"])]),_:1}),a("div",Jt,[a("div",Kt,[a("span",null,"字符预览 ("+c(b.value.targetCharacters.length)+"个)",1),e(ge,{size:"small",onClick:pe},{default:t(()=>r[14]||(r[14]=[p("清空",-1)])),_:1,__:[14]})]),a("div",Qt,[(f(!0),C(de,null,ce(b.value.targetCharacters,x=>(f(),R(be,{key:x,closable:"",onClose:xe=>re(x),class:"character-tag"},{default:t(()=>[p(c(x),1)]),_:2},1032,["onClose"]))),128))])])])):m.value==="preset"?(f(),C("div",Ht,[e(F,{label:"选择字符集"},{default:t(()=>[e(ke,{modelValue:S.value,"onUpdate:modelValue":r[7]||(r[7]=x=>S.value=x),onChange:oe},{default:t(()=>[e(ve,{value:"common100"},{default:t(()=>r[15]||(r[15]=[p("常用汉字100字",-1)])),_:1,__:[15]}),e(ve,{value:"common500"},{default:t(()=>r[16]||(r[16]=[p("常用汉字500字",-1)])),_:1,__:[16]}),e(ve,{value:"primary"},{default:t(()=>r[17]||(r[17]=[p("小学必学汉字",-1)])),_:1,__:[17]}),e(ve,{value:"numbers"},{default:t(()=>r[18]||(r[18]=[p("数字汉字",-1)])),_:1,__:[18]}),e(ve,{value:"colors"},{default:t(()=>r[19]||(r[19]=[p("颜色汉字",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1})])):m.value==="file"?(f(),C("div",Xt,[e(F,{label:"导入文件"},{default:t(()=>[e(Ue,{"before-upload":ue,"on-success":ze,"on-error":Y,accept:".txt,.csv",limit:1,"auto-upload":!0,drag:""},{tip:t(()=>r[20]||(r[20]=[a("div",{class:"el-upload__tip"}," 支持 .txt 和 .csv 格式，每行一个汉字 ",-1)])),default:t(()=>[e(Ve,{class:"el-icon--upload"},{default:t(()=>[e(G(Et))]),_:1}),r[21]||(r[21]=a("div",{class:"el-upload__text"},[p(" 将文件拖到此处，或"),a("em",null,"点击上传")],-1))]),_:1,__:[21]})]),_:1})])):j("",!0)]),a("div",Yt,[r[25]||(r[25]=a("h3",{class:"section-title"},"标签设置",-1)),e(F,{label:"字体包标签"},{default:t(()=>[a("div",ea,[a("div",ta,[(f(!0),C(de,null,ce(b.value.tags,x=>(f(),R(be,{key:x,closable:"",onClose:xe=>H(x),class:"tag-item"},{default:t(()=>[p(c(x),1)]),_:2},1032,["onClose"]))),128))]),a("div",aa,[e(M,{modelValue:O.value,"onUpdate:modelValue":r[8]||(r[8]=x=>O.value=x),placeholder:"输入标签名称",size:"small",style:{width:"150px","margin-right":"8px"},onKeyup:st(q,["enter"]),maxlength:"20"},null,8,["modelValue"]),e(ge,{size:"small",onClick:q,disabled:!O.value.trim()},{default:t(()=>r[23]||(r[23]=[p(" 添加标签 ",-1)])),_:1,__:[23]},8,["disabled"])]),a("div",la,[r[24]||(r[24]=a("span",{class:"preset-label"},"推荐标签：",-1)),(f(),C(de,null,ce(me,x=>e(be,{key:x,size:"small",type:"info",onClick:xe=>A(x),class:"preset-tag"},{default:t(()=>[p(c(x),1)]),_:2},1032,["onClick"])),64))])])]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),na=qe(oa,[["__scopeId","data-v-ff92801a"]]),ia={class:"font-package-wizard"},ra={class:"wizard-steps"},ua={class:"step-circle"},da={key:1,class:"step-number"},ca={class:"step-label"},pa={key:0,class:"step-connector"},fa={class:"wizard-header"},ga={class:"wizard-progress"},va={class:"progress-bar"},ma={class:"progress-text"},_a={class:"wizard-content"},ha={key:0,class:"step-content"},ya={class:"form-container"},ba={key:1,class:"step-content"},ka={class:"upload-container"},Ca={key:0,style:{"margin-top":"20px"}},xa={class:"file-preview"},wa={class:"file-name"},Ta={class:"file-char"},$a={key:0,class:"more-files"},Va={key:2,class:"step-content"},Pa={class:"config-container"},Sa={key:3,class:"step-content"},Fa={class:"review-container"},Ia={style:{"margin-top":"20px"}},Ma={style:{background:"#f8f9fa",padding:"12px","border-radius":"4px",margin:"0"}},za={style:{"margin-top":"20px"}},Ua={key:0,style:{color:"#999"}},Aa={style:{"margin-top":"20px"}},Da={key:4,class:"step-content"},Ba={class:"progress-container"},Ea={class:"wizard-footer"},Ra={class:"footer-left"},Oa={class:"footer-right"},Wa=We({__name:"FontPackageWizard",props:{modelValue:{type:Boolean,default:!1},initialData:{default:()=>({})}},emits:["update:modelValue","complete","cancel","save-draft"],setup(i,{emit:d}){const u=i,P=d,$=_(1),K=_(!1),m=_(""),E=_(),S=_(50),O=_("0.01"),me=_("high"),ye=_(3e3),b=[{key:"basicInfo",title:"基本信息",description:"设置字体包基本信息"},{key:"sampleUpload",title:"样本上传",description:"上传字符样本文件"},{key:"configuration",title:"参数配置",description:"配置训练参数"},{key:"review",title:"确认创建",description:"检查并确认信息"},{key:"progress",title:"训练监控",description:"监控训练进度"}],k=_({basicInfo:{name:"",description:"",fontType:"kaishu",difficulty:3,version:"v1.0.0",tags:[]},sampleUpload:{targetCharacters:[],uploadedFiles:[],analysisResult:null},configuration:{trainingSettings:{},qualitySettings:{}},review:{confirmed:!1},progress:{trainingStatus:"pending"}}),Z=Me(()=>b.length),v=Me(()=>{var I;return((I=b[$.value-1])==null?void 0:I.title)||""}),_e=Me(()=>Math.round($.value/Z.value*100)),ie=()=>{$.value<Z.value&&$.value++},Q=()=>{$.value>1&&$.value--},oe=I=>{const o=k.value.basicInfo.tags.indexOf(I);o>-1&&k.value.basicInfo.tags.splice(o,1)},re=()=>{K.value=!0,Mt(()=>{var I;(I=E.value)==null||I.focus()})},pe=()=>{m.value&&!k.value.basicInfo.tags.includes(m.value)&&k.value.basicInfo.tags.push(m.value),K.value=!1,m.value=""},q=(I,o)=>{k.value.sampleUpload.uploadedFiles=o,console.log("文件列表更新:",o.length,"个文件")},A=I=>{const o=I.match(/[\u4e00-\u9fa5]/g);return o?o[0]:"?"},H=I=>({kaishu:"楷书",xingshu:"行书",lishu:"隶书",zhuanshu:"篆书",caoshu:"草书"})[I]||I,ue=I=>["","入门","简单","中等","困难","专家"][I]||"未知",ze=I=>({standard:"标准质量",high:"高质量",ultra:"超高质量"})[I]||I,Y=()=>{const I=k.value.sampleUpload.uploadedFiles.length,o=S.value,r=Math.max(I*2,30),M=Math.round(r*(o/50));if(M<60)return`${M}分钟`;{const F=Math.floor(M/60),L=M%60;return`${F}小时${L>0?L+"分钟":""}`}},ae=()=>{console.log("完成向导"),k.value.configuration={trainingSettings:{epochs:S.value,learningRate:O.value,targetCharCount:ye.value},qualitySettings:{outputQuality:me.value}},T.success("字体包创建向导完成！"),P("complete",k.value)};return lt(()=>u.modelValue,I=>{I&&(console.log("向导打开"),$.value=1)}),ot(()=>{console.log("FontPackageWizard mounted")}),(I,o)=>{const r=g("el-icon"),M=g("el-input"),F=g("el-form-item"),L=g("el-option"),N=g("el-select"),fe=g("el-rate"),le=g("el-tag"),ee=g("el-button"),he=g("el-form"),ge=g("el-alert"),be=g("el-upload"),ve=g("el-slider"),ke=g("el-radio"),Ve=g("el-radio-group"),Ue=g("el-input-number"),te=g("el-descriptions-item"),Ce=g("el-descriptions"),x=g("el-checkbox"),xe=g("el-result");return f(),C("div",ia,[a("div",ra,[(f(),C(de,null,ce(b,(w,se)=>a("div",{key:w.key,class:zt(["step-indicator",{active:se+1===$.value,completed:se+1<$.value,upcoming:se+1>$.value}])},[a("div",ua,[se+1<$.value?(f(),R(r,{key:0,class:"step-check"},{default:t(()=>[e(G(Be))]),_:1})):(f(),C("span",da,c(se+1),1))]),a("div",ca,c(w.title),1),se<b.length-1?(f(),C("div",pa)):j("",!0)],2)),64))]),a("div",fa,[a("div",ga,[a("div",va,[a("div",{class:"progress-fill",style:It({width:`${_e.value}%`})},null,4)]),a("div",ma," 步骤 "+c($.value)+" / "+c(Z.value)+" - "+c(v.value),1)])]),a("div",_a,[$.value===1?(f(),C("div",ha,[a("h3",null,c(v.value),1),a("div",ya,[e(he,{model:k.value.basicInfo,"label-width":"120px",size:"large"},{default:t(()=>[e(F,{label:"字体包名称",required:""},{default:t(()=>[e(M,{modelValue:k.value.basicInfo.name,"onUpdate:modelValue":o[0]||(o[0]=w=>k.value.basicInfo.name=w),placeholder:"请输入字体包名称，如：优雅楷书",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(F,{label:"字体类型",required:""},{default:t(()=>[e(N,{modelValue:k.value.basicInfo.fontType,"onUpdate:modelValue":o[1]||(o[1]=w=>k.value.basicInfo.fontType=w),placeholder:"选择字体类型"},{default:t(()=>[e(L,{label:"楷书",value:"kaishu"}),e(L,{label:"行书",value:"xingshu"}),e(L,{label:"隶书",value:"lishu"}),e(L,{label:"篆书",value:"zhuanshu"}),e(L,{label:"草书",value:"caoshu"})]),_:1},8,["modelValue"])]),_:1}),e(F,{label:"难度等级"},{default:t(()=>[e(fe,{modelValue:k.value.basicInfo.difficulty,"onUpdate:modelValue":o[2]||(o[2]=w=>k.value.basicInfo.difficulty=w),max:5,"show-text":"",texts:["入门","简单","中等","困难","专家"]},null,8,["modelValue"])]),_:1}),e(F,{label:"版本号"},{default:t(()=>[e(M,{modelValue:k.value.basicInfo.version,"onUpdate:modelValue":o[3]||(o[3]=w=>k.value.basicInfo.version=w),placeholder:"如：v1.0.0",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(F,{label:"描述信息"},{default:t(()=>[e(M,{modelValue:k.value.basicInfo.description,"onUpdate:modelValue":o[4]||(o[4]=w=>k.value.basicInfo.description=w),type:"textarea",rows:4,placeholder:"请描述这个字体包的特点和用途...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(F,{label:"标签"},{default:t(()=>[(f(!0),C(de,null,ce(k.value.basicInfo.tags,w=>(f(),R(le,{key:w,closable:"",onClose:se=>oe(w),style:{"margin-right":"8px","margin-bottom":"8px"}},{default:t(()=>[p(c(w),1)]),_:2},1032,["onClose"]))),128)),K.value?(f(),R(M,{key:0,ref_key:"tagInputRef",ref:E,modelValue:m.value,"onUpdate:modelValue":o[5]||(o[5]=w=>m.value=w),size:"small",style:{width:"120px"},onKeyup:st(pe,["enter"]),onBlur:pe},null,8,["modelValue"])):(f(),R(ee,{key:1,size:"small",onClick:re},{default:t(()=>o[11]||(o[11]=[p(" + 添加标签 ",-1)])),_:1,__:[11]}))]),_:1})]),_:1},8,["model"])])])):$.value===2?(f(),C("div",ba,[a("h3",null,c(v.value),1),a("div",ka,[e(ge,{title:"上传说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:t(()=>o[12]||(o[12]=[a("ul",{style:{margin:"0","padding-left":"20px"}},[a("li",null,"支持PNG、JPG、JPEG格式的图片文件"),a("li",null,"建议图片尺寸：256x256像素"),a("li",null,"文件名应包含对应汉字，如：一.png、二.jpg"),a("li",null,"建议上传50-200个常用汉字样本")],-1)])),_:1}),e(be,{class:"upload-demo",drag:"","auto-upload":!1,multiple:"","file-list":k.value.sampleUpload.uploadedFiles,onChange:q,accept:".png,.jpg,.jpeg"},{tip:t(()=>o[13]||(o[13]=[a("div",{class:"el-upload__tip"}," 支持批量上传，建议每次上传50-200个字符样本 ",-1)])),default:t(()=>[e(r,{class:"el-icon--upload"},{default:t(()=>[e(G(nt))]),_:1}),o[14]||(o[14]=a("div",{class:"el-upload__text"},[p(" 将文件拖到此处，或"),a("em",null,"点击上传")],-1))]),_:1,__:[14]},8,["file-list"]),k.value.sampleUpload.uploadedFiles.length>0?(f(),C("div",Ca,[a("h4",null,"已上传文件 ("+c(k.value.sampleUpload.uploadedFiles.length)+"个)",1),a("div",xa,[(f(!0),C(de,null,ce(k.value.sampleUpload.uploadedFiles.slice(0,10),(w,se)=>(f(),C("div",{key:se,class:"file-item"},[a("div",wa,c(w.name),1),a("div",Ta,c(A(w.name)),1)]))),128)),k.value.sampleUpload.uploadedFiles.length>10?(f(),C("div",$a," 还有 "+c(k.value.sampleUpload.uploadedFiles.length-10)+" 个文件... ",1)):j("",!0)])])):j("",!0)])])):$.value===3?(f(),C("div",Va,[a("h3",null,c(v.value),1),a("div",Pa,[e(he,{"label-width":"150px",size:"large"},{default:t(()=>[o[22]||(o[22]=a("h4",null,"训练参数",-1)),e(F,{label:"训练轮数"},{default:t(()=>[e(ve,{modelValue:S.value,"onUpdate:modelValue":o[6]||(o[6]=w=>S.value=w),min:10,max:100,step:10,"show-stops":"","show-input":"",style:{width:"300px"}},null,8,["modelValue"]),o[15]||(o[15]=a("div",{class:"param-desc"},"建议：50-80轮，轮数越多质量越高但耗时更长",-1))]),_:1,__:[15]}),e(F,{label:"学习率"},{default:t(()=>[e(N,{modelValue:O.value,"onUpdate:modelValue":o[7]||(o[7]=w=>O.value=w),style:{width:"200px"}},{default:t(()=>[e(L,{label:"0.001 (保守)",value:"0.001"}),e(L,{label:"0.01 (推荐)",value:"0.01"}),e(L,{label:"0.1 (激进)",value:"0.1"})]),_:1},8,["modelValue"]),o[16]||(o[16]=a("div",{class:"param-desc"},"推荐使用0.01，适合大多数字体类型",-1))]),_:1,__:[16]}),o[23]||(o[23]=a("h4",{style:{"margin-top":"30px"}},"质量设置",-1)),e(F,{label:"输出质量"},{default:t(()=>[e(Ve,{modelValue:me.value,"onUpdate:modelValue":o[8]||(o[8]=w=>me.value=w)},{default:t(()=>[e(ke,{label:"standard"},{default:t(()=>o[17]||(o[17]=[p("标准质量",-1)])),_:1,__:[17]}),e(ke,{label:"high"},{default:t(()=>o[18]||(o[18]=[p("高质量",-1)])),_:1,__:[18]}),e(ke,{label:"ultra"},{default:t(()=>o[19]||(o[19]=[p("超高质量",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"]),o[20]||(o[20]=a("div",{class:"param-desc"},"质量越高生成时间越长，文件体积越大",-1))]),_:1,__:[20]}),e(F,{label:"生成字符数"},{default:t(()=>[e(Ue,{modelValue:ye.value,"onUpdate:modelValue":o[9]||(o[9]=w=>ye.value=w),min:100,max:1e4,step:100,style:{width:"200px"}},null,8,["modelValue"]),o[21]||(o[21]=a("div",{class:"param-desc"},"根据样本数量自动推荐，可手动调整",-1))]),_:1,__:[21]})]),_:1,__:[22,23]})])])):$.value===4?(f(),C("div",Sa,[a("h3",null,c(v.value),1),a("div",Fa,[e(Ce,{title:"字体包信息确认",column:2,border:""},{default:t(()=>[e(te,{label:"字体包名称"},{default:t(()=>[p(c(k.value.basicInfo.name||"未设置"),1)]),_:1}),e(te,{label:"字体类型"},{default:t(()=>[p(c(H(k.value.basicInfo.fontType)),1)]),_:1}),e(te,{label:"难度等级"},{default:t(()=>[p(c(ue(k.value.basicInfo.difficulty)),1)]),_:1}),e(te,{label:"版本号"},{default:t(()=>[p(c(k.value.basicInfo.version),1)]),_:1}),e(te,{label:"样本数量"},{default:t(()=>[p(c(k.value.sampleUpload.uploadedFiles.length)+"个",1)]),_:1}),e(te,{label:"预计生成时间"},{default:t(()=>[p(c(Y()),1)]),_:1}),e(te,{label:"训练轮数"},{default:t(()=>[p(c(S.value)+"轮",1)]),_:1}),e(te,{label:"输出质量"},{default:t(()=>[p(c(ze(me.value)),1)]),_:1})]),_:1}),a("div",Ia,[o[24]||(o[24]=a("h4",null,"描述信息",-1)),a("p",Ma,c(k.value.basicInfo.description||"无描述"),1)]),a("div",za,[o[25]||(o[25]=a("h4",null,"标签",-1)),a("div",null,[(f(!0),C(de,null,ce(k.value.basicInfo.tags,w=>(f(),R(le,{key:w,style:{"margin-right":"8px"}},{default:t(()=>[p(c(w),1)]),_:2},1024))),128)),k.value.basicInfo.tags.length===0?(f(),C("span",Ua,"无标签")):j("",!0)])]),e(ge,{title:"确认信息",type:"warning",closable:!1,"show-icon":"",style:{"margin-top":"20px"}},{default:t(()=>[o[26]||(o[26]=a("p",null,'请仔细检查以上信息，确认无误后点击"完成创建"开始AI训练。',-1)),a("p",null,"训练过程将消耗大量计算资源，预计需要 "+c(Y())+"，请耐心等待。",1)]),_:1}),a("div",Aa,[e(x,{modelValue:k.value.review.confirmed,"onUpdate:modelValue":o[10]||(o[10]=w=>k.value.review.confirmed=w)},{default:t(()=>o[27]||(o[27]=[p(" 我已确认以上信息无误，同意开始AI字体生成训练 ",-1)])),_:1,__:[27]},8,["modelValue"])])])])):$.value===5?(f(),C("div",Da,[a("h3",null,c(v.value),1),a("div",Ba,[e(xe,{icon:"success",title:"字体包创建成功！","sub-title":"AI训练任务已启动，您可以在字体包管理页面查看训练进度"},{extra:t(()=>[e(ee,{type:"primary",onClick:ae},{default:t(()=>o[28]||(o[28]=[p("返回管理页面",-1)])),_:1,__:[28]})]),_:1})])])):j("",!0)]),a("div",Ea,[a("div",Ra,[$.value>1?(f(),R(ee,{key:0,onClick:Q},{default:t(()=>[e(r,null,{default:t(()=>[e(G(Rt))]),_:1}),o[29]||(o[29]=p(" 上一步 ",-1))]),_:1,__:[29]})):j("",!0)]),a("div",Oa,[$.value<Z.value?(f(),R(ee,{key:0,type:"primary",onClick:ie},{default:t(()=>[o[30]||(o[30]=p(" 下一步 ",-1)),e(r,null,{default:t(()=>[e(G(Ot))]),_:1})]),_:1,__:[30]})):(f(),R(ee,{key:1,type:"primary",onClick:ae},{default:t(()=>[o[31]||(o[31]=p(" 完成创建 ",-1)),e(r,null,{default:t(()=>[e(G(Be))]),_:1})]),_:1,__:[31]}))])])])}}}),qa=qe(Wa,[["__scopeId","data-v-13ad364c"]]),Ga={class:"font-package-management"},La={class:"stats-section"},Na={class:"stat-card"},ja={class:"stat-icon",style:{background:"linear-gradient(135deg, #409EFF, #66B1FF)"}},Za={class:"stat-content"},Ja={class:"stat-value"},Ka={class:"stat-card"},Qa={class:"stat-icon",style:{background:"linear-gradient(135deg, #67C23A, #85CE61)"}},Ha={class:"stat-content"},Xa={class:"stat-value"},Ya={class:"stat-card"},el={class:"stat-icon",style:{background:"linear-gradient(135deg, #E6A23C, #EEBE77)"}},tl={class:"stat-content"},al={class:"stat-value"},ll={class:"stat-card"},sl={class:"stat-icon",style:{background:"linear-gradient(135deg, #F56C6C, #F78989)"}},ol={class:"stat-content"},nl={class:"stat-value"},il={class:"stat-card secondary"},rl={class:"stat-content"},ul={class:"stat-value"},dl={class:"stat-card secondary"},cl={class:"stat-content"},pl={class:"stat-value"},fl={class:"stat-card secondary"},gl={class:"stat-content"},vl={class:"stat-value"},ml={class:"table-section"},_l={class:"card-header"},hl={class:"header-actions"},yl={class:"font-type-cell"},bl={class:"difficulty-info"},kl={class:"difficulty-level"},Cl={class:"status-cell"},xl={class:"status-info"},wl={key:0,class:"quality-score"},Tl={key:1,class:"progress-placeholder"},$l={key:0,class:"generation-info"},Vl={class:"time-info"},Pl={key:0,class:"font-detail-content"},Sl={class:"basic-info"},Fl={class:"info-section"},Il={style:{"margin-left":"8px"}},Ml={class:"info-section"},zl={class:"info-section"},Ul={class:"description-text"},Al={class:"info-section"},Dl={class:"info-section"},Bl={class:"tags-container"},El={class:"stats-info"},Rl={class:"info-section"},Ol={class:"info-section"},Wl={class:"characters-info"},ql={class:"info-section"},Gl={class:"character-grid"},Ll={class:"info-section"},Nl={class:"character-grid"},jl={class:"maintenance-info"},Zl={class:"dialog-footer"},Jl={class:"wizard-container"},Kl={class:"wizard-header"},Ql={class:"wizard-content"},Hl={key:0,class:"upload-content"},Xl={class:"upload-area"},Yl={key:0,class:"upload-progress"},es={class:"progress-info"},ts={key:1,class:"upload-errors"},as={key:2,class:"file-list"},ls={class:"recognized-char"},ss={class:"dialog-footer"},os=We({__name:"FontPackageManagement",setup(i){const d=_(!1),u=_(null),P=_(""),$=_(""),K=_(""),m=_(""),E=_("");_(!1);const S=_([0,100]),O=_([0,1e3]),me=_(null),ye=_("createdAt"),b=_("desc"),k=_([]),Z=_(!1),v=_(null),_e=_("basic");_([]),_([]),_([]);const ie=_(!1),Q=_(!1),oe=_(!0),re=_(!1),pe=_(null),q=_([]),A=_({total:0,completed:0,failed:0,current:"",percentage:0,errors:[]}),H=_(!1),ue=_([]),ze=_([{prop:"id",label:"ID",width:80,sortable:!0},{prop:"name",label:"字体包名称",minWidth:200,sortable:!0},{prop:"fontType",label:"字体类型",width:120,sortable:!0},{prop:"status",label:"状态",width:150,sortable:!0},{prop:"sampleCount",label:"样本数量",width:100,sortable:!0,align:"center"},{prop:"qualityScore",label:"质量评分",width:100,sortable:!0,align:"center"},{prop:"createdBy",label:"创建者",width:120,sortable:!0},{prop:"createdAt",label:"创建时间",width:160,sortable:!0,type:"date"},{prop:"actions",label:"操作",width:300,fixed:"right"}]),Y=_({totalPackages:0,publishedPackages:0,generatingPackages:0,failedPackages:0,totalSamples:0,totalCharacters:0,averageAccuracy:0,averageGenerationTime:0,statusDistribution:{draft:0,training:0,completed:0,published:0,failed:0},typeDistribution:{kaishu:0,xingshu:0,lishu:0,zhuanshu:0,caoshu:0,other:0},recentActivity:{newPackagesThisWeek:0,completedThisWeek:0,publishedThisWeek:0,totalDownloadsThisWeek:0}}),ae=_({currentPage:1,pageSize:10,total:0}),I=Me(()=>s=>(s.status==="draft"||s.status==="failed")&&s.sampleCount>=50&&s.targetCharacters&&s.targetCharacters.length>0),o=()=>U(null,null,function*(){d.value=!0;try{yield Promise.all([r(),M(),F()]),console.log("数据刷新完成"),se()}catch(s){console.error("数据刷新失败:",s),T.error("数据刷新失败")}finally{d.value=!1}}),r=()=>U(null,null,function*(){try{const s=yield ne.getFontPackages({page:ae.value.currentPage,pageSize:ae.value.pageSize,keyword:P.value,status:$.value,fontType:K.value,difficulty:m.value,creator:E.value,qualityRange:S.value,sampleRange:O.value,dateRange:me.value,sortBy:ye.value,sortOrder:b.value});ue.value=s.data.list,ae.value.total=s.data.total}catch(s){console.error("加载字体包失败:",s),T.error("加载字体包失败")}}),M=()=>U(null,null,function*(){try{const s=yield ne.getFontPackageStats();s&&s.data?(Y.value=s.data,console.log("字体包统计数据加载成功:",s.data)):(console.warn("统计数据响应格式异常:",s),T.warning("统计数据加载异常"))}catch(s){console.error("加载统计数据失败:",s),T.error("加载统计数据失败")}}),F=()=>U(null,null,function*(){try{const s=yield ne.getFontPackages({pageSize:1e3});if(s&&s.data&&s.data.list){const l=[...new Set(s.data.list.map(y=>y.createdBy))];k.value=l.sort()}}catch(s){console.error("加载创建者列表失败:",s)}}),L=s=>{ae.value.currentPage=s,r()},N=s=>{ae.value.pageSize=s,ae.value.currentPage=1,r()},fe=()=>{console.log("showCreateDialog called, useWizard:",oe.value),console.log("wizardVisible before:",Q.value),console.log("createDialogVisible before:",ie.value),oe.value?(console.log("Opening wizard dialog"),Q.value=!0,console.log("wizardVisible after:",Q.value)):(console.log("Opening create dialog"),ie.value=!0,console.log("createDialogVisible after:",ie.value))},le=()=>{ie.value=!1,o(),T.success("字体包创建成功")},ee=s=>U(null,null,function*(){try{yield ne.createFontPackageFromWizard(s),Q.value=!1,T.success("字体包创建成功，AI训练已开始"),o()}catch(l){console.error("创建字体包失败:",l),T.error("创建字体包失败，请重试")}}),he=()=>{Q.value=!1},ge=s=>{ne.saveWizardDraft(s).then(()=>{T.success("草稿已保存")}).catch(l=>{console.error("保存草稿失败:",l),T.error("保存草稿失败")})},be=s=>U(null,null,function*(){try{d.value=!0;const l=yield ne.getFontPackageById(s.id);l?(v.value=l,_e.value="basic",Z.value=!0):T.error("获取字体包详情失败")}catch(l){console.error("获取字体包详情失败:",l),T.error("获取字体包详情失败")}finally{d.value=!1}}),ve=s=>{pe.value=s,q.value=[],A.value={total:0,completed:0,failed:0,current:"",percentage:0,errors:[]},H.value=!1,re.value=!0},ke=s=>U(null,null,function*(){var l,y;try{const h=`
      <div style="text-align: left;">
        <p><strong>字体包信息：</strong></p>
        <ul>
          <li>名称：${s.name}</li>
          <li>字体类型：${Ce(s.fontType)}</li>
          <li>样本数量：${s.sampleCount}个</li>
          <li>目标字符：${((l=s.targetCharacters)==null?void 0:l.length)||0}个</li>
          <li>预计生成时间：${Math.round((((y=s.targetCharacters)==null?void 0:y.length)||0)*60/60)}分钟</li>
        </ul>
        <p style="color: #E6A23C; margin-top: 10px;">
          <i class="el-icon-warning"></i> 
          生成过程将消耗大量计算资源，请确认所有样本已上传完毕。
        </p>
      </div>
    `;yield Ie.confirm(h,"确认开始生成",{confirmButtonText:"开始生成",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,customClass:"generation-confirm-dialog"});const W=at.service({lock:!0,text:"正在启动生成任务...",background:"rgba(0, 0, 0, 0.7)"});try{const V=yield ne.startGeneration(s.id);W.close(),T({type:"success",message:"生成任务已启动！",duration:3e3,showClose:!0}),Ie.alert(`<div style="text-align: left;">
          <p><strong>生成任务已创建：</strong></p>
          <ul>
            <li>任务ID：${V.data.task.id}</li>
            <li>预计完成时间：${V.data.task.estimatedTime}分钟</li>
            <li>目标字符数：${V.data.task.totalCharacters}个</li>
          </ul>
          <p style="color: #67C23A;">您可以在字体包详情中查看实时进度。</p>
        </div>`,"生成任务信息",{confirmButtonText:"知道了",dangerouslyUseHTMLString:!0}),o()}catch(V){throw W.close(),V}}catch(h){if(h!=="cancel"){console.error("开始生成失败:",h);let W="开始生成失败";h.message?W=h.message:typeof h=="string"&&(W=h),T({type:"error",message:W,duration:5e3,showClose:!0})}}}),Ve=s=>U(null,null,function*(){var l,y,h,W;try{const V=[];s.qualityScore<70&&V.push(`质量评分较低（${s.qualityScore}分），建议70分以上`),((l=s.generationStats)==null?void 0:l.successRate)<80&&V.push(`生成成功率较低（${s.generationStats.successRate}%），建议80%以上`);const D=(((y=s.actualCharacters)==null?void 0:y.length)||0)/(((h=s.targetCharacters)==null?void 0:h.length)||1)*100;D<80&&V.push(`字符完成度较低（${Math.round(D)}%），建议80%以上`);let Ae=`
      <div style="text-align: left;">
        <p><strong>发布信息确认：</strong></p>
        <ul>
          <li>字体包：${s.name}</li>
          <li>版本：${s.version}</li>
          <li>质量评分：${s.qualityScore}分</li>
          <li>生成成功率：${((W=s.generationStats)==null?void 0:W.successRate)||0}%</li>
          <li>字符完成度：${Math.round(D)}%</li>
          <li>文件大小：${s.fileSize}MB</li>
        </ul>
    `;V.length>0&&(Ae+=`
        <div style="color: #E6A23C; margin-top: 10px; padding: 10px; background: #FDF6EC; border-radius: 4px;">
          <p><strong>⚠️ 质量提醒：</strong></p>
          <ul>
            ${V.map(Te=>`<li>${Te}</li>`).join("")}
          </ul>
          <p>建议优化后再发布，或选择"强制发布"。</p>
        </div>
      `),Ae+=`
        <p style="color: #67C23A; margin-top: 10px;">
          发布后用户即可下载使用该字体包。
        </p>
      </div>
    `;const we=yield Ie.confirm(Ae,"确认发布字体包",{confirmButtonText:V.length>0?"强制发布":"确认发布",cancelButtonText:"取消",type:V.length>0?"warning":"info",dangerouslyUseHTMLString:!0,customClass:"publish-confirm-dialog"}),Se=at.service({lock:!0,text:"正在发布字体包...",background:"rgba(0, 0, 0, 0.7)"});try{const Te={skipQualityCheck:V.length>0,publishNotes:V.length>0?`管理员强制发布，质量提醒：${V.join("；")}`:"质量检查通过，正常发布"},z=yield ne.publishFontPackage(s.id,Te);Se.close(),T({type:"success",message:"字体包发布成功！",duration:3e3,showClose:!0}),Ie.alert(`<div style="text-align: left;">
          <p><strong>发布成功！</strong></p>
          <ul>
            <li>字体包：${s.name}</li>
            <li>发布时间：${new Date().toLocaleString()}</li>
            <li>下载地址：即将生效</li>
          </ul>
          <p style="color: #67C23A;">用户现在可以搜索并下载该字体包。</p>
        </div>`,"发布成功",{confirmButtonText:"知道了",dangerouslyUseHTMLString:!0}),o()}catch(Te){throw Se.close(),Te}}catch(V){if(V!=="cancel"){console.error("发布失败:",V);let D="发布失败";V.message?D=V.message:typeof V=="string"&&(D=V),T({type:"error",message:D,duration:5e3,showClose:!0})}}}),Ue=s=>U(null,null,function*(){try{yield Ie.confirm(`确定要删除字体包 "${s.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield ne.deleteFontPackage(s.id),T.success("删除成功"),o()}catch(l){l!=="cancel"&&(console.error("删除失败:",l),T.error("删除失败"))}}),te=s=>({kaishu:"primary",xingshu:"success",lishu:"warning",zhuanshu:"info",caoshu:"danger"})[s]||"info",Ce=s=>({kaishu:"楷书",xingshu:"行书",lishu:"隶书",zhuanshu:"篆书",caoshu:"草书"})[s]||s,x=s=>({draft:"info",training:"warning",completed:"primary",published:"success",failed:"danger"})[s]||"info",xe=s=>({draft:"草稿",training:"生成中",completed:"已完成",published:"已发布",failed:"生成失败"})[s]||s,w=s=>{if(!s.generationStats||s.status!=="training")return"计算中...";const{totalTime:l,averageTimePerChar:y}=s.generationStats,h=s.sampleCount-(s.generatedCount||0),W=Math.round(h*y/60);if(W<60)return`${W}分钟`;{const V=Math.floor(W/60),D=W%60;return`${V}小时${D>0?D+"分钟":""}`}},se=()=>{u.value&&clearInterval(u.value),u.value=setInterval(()=>U(null,null,function*(){const s=ue.value.filter(l=>l.status==="training");if(s.length===0){u.value&&(clearInterval(u.value),u.value=null);return}for(const l of s)try{const y=yield ne.getGenerationProgress(l.id);if(y.data&&y.data.progress){const h=ue.value.findIndex(W=>W.id===l.id);h!==-1&&(ue.value[h]=Re(Ee({},ue.value[h]),{progress:y.data.progress.percentage,generatedCount:y.data.progress.percentage||0}))}}catch(y){console.warn(`获取字体包 ${l.id} 进度失败:`,y)}}),5e3)},it=()=>{u.value&&(clearInterval(u.value),u.value=null)},Ge=s=>({1:"★☆☆☆☆",2:"★★☆☆☆",3:"★★★☆☆",4:"★★★★☆",5:"★★★★★"})[s]||"未知",Pe=s=>s?new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"未知",rt=s=>{if(!s||s===0)return"0分钟";if(s<60)return`${s}分钟`;{const l=Math.floor(s/60),y=s%60;return`${l}小时${y>0?y+"分钟":""}`}},ut=s=>s<30?"#f56c6c":s<70?"#e6a23c":"#67c23a",dt=()=>{Z.value=!1,v.value=null,_e.value="basic"},ct=()=>{H.value?Ie.confirm("正在上传中，确定要关闭吗？","确认关闭",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{re.value=!1,Le()}).catch(()=>{}):(re.value=!1,Le())},Le=()=>{pe.value=null,q.value=[],A.value={total:0,completed:0,failed:0,current:"",percentage:0,errors:[]},H.value=!1},pt=s=>["image/png","image/jpeg","image/jpg"].includes(s.type)?s.size/1024/1024<5?(je(s.name)||T.warning(`文件 ${s.name} 无法识别汉字，请确保文件名包含对应的汉字`),!0):(T.error("文件大小不能超过 5MB"),!1):(T.error("只支持 PNG、JPG、JPEG 格式的图片文件"),!1),ft=(s,l)=>{T.warning(`最多只能上传 100 个文件，当前选择了 ${s.length+l.length} 个文件`)},gt=(s,l)=>{q.value=l},Ne=s=>s.url?s.url:s.raw?URL.createObjectURL(s.raw):"",vt=s=>s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`,je=s=>{const l=s.match(/[\u4e00-\u9fa5]/g);return l?l[0]:""},mt=s=>s.status==="success"?"success":s.status==="error"?"danger":s.status==="uploading"?"warning":"info",_t=s=>{switch(s.status){case"success":return"上传成功";case"error":return"上传失败";case"uploading":return"上传中";default:return"待上传"}},ht=()=>{q.value=[],A.value.errors=[]},yt=()=>U(null,null,function*(){if(q.value.length===0){T.warning("请先选择要上传的文件");return}H.value=!0,A.value={total:q.value.length,completed:0,failed:0,current:"",percentage:0,errors:[]};try{for(let y=0;y<q.value.length;y++){const h=q.value[y];A.value.current=h.name;try{yield bt(h),h.status="success",A.value.completed++,T.success(`${h.name} 上传成功`)}catch(W){h.status="error",A.value.failed++,A.value.errors.push({filename:h.name,error:W instanceof Error?W.message:"上传失败"}),T.error(`${h.name} 上传失败`)}A.value.percentage=Math.round((A.value.completed+A.value.failed)/A.value.total*100)}const s=A.value.completed,l=A.value.failed;l===0?T.success(`所有文件上传成功！共 ${s} 个文件`):T.warning(`上传完成！成功 ${s} 个，失败 ${l} 个`),o()}catch(s){console.error("批量上传失败:",s),T.error("批量上传失败")}finally{H.value=!1,A.value.current=""}}),bt=s=>new Promise((l,y)=>{const h=Math.random()*2e3+500;setTimeout(()=>{Math.random()>.1?l():y(new Error("网络错误或文件格式不正确"))},h)});return ot(()=>{o(),se()}),Ut(()=>{it()}),(s,l)=>{var Qe,He;const y=g("el-icon"),h=g("el-col"),W=g("Picture"),V=g("el-row"),D=g("el-button"),Ae=g("el-button-group"),we=g("el-tag"),Se=g("el-progress"),Te=g("el-card"),z=g("el-descriptions-item"),Ze=g("el-rate"),Fe=g("el-descriptions"),De=g("el-tab-pane"),kt=g("el-tabs"),Je=g("el-dialog"),Ct=g("el-alert"),xt=g("el-upload"),$e=g("el-table-column"),Ke=g("el-table"),wt=g("el-image"),Tt=At("loading");return f(),C("div",Ga,[l[46]||(l[46]=a("div",{class:"page-header"},[a("h1",null,"AI字体包管理"),a("p",null,"管理字体包、样本上传、AI生成和发布分发")],-1)),a("div",La,[Dt((f(),R(V,{gutter:24},{default:t(()=>[e(h,{xs:24,sm:12,md:6,lg:6},{default:t(()=>[a("div",Na,[a("div",ja,[e(y,{size:"24"},{default:t(()=>[e(G(Oe))]),_:1})]),a("div",Za,[a("div",Ja,c(Y.value.totalPackages),1),l[12]||(l[12]=a("div",{class:"stat-title"},"字体包总数",-1)),l[13]||(l[13]=a("div",{class:"stat-desc"},"包含所有状态的字体包",-1))])])]),_:1}),e(h,{xs:24,sm:12,md:6,lg:6},{default:t(()=>[a("div",Ka,[a("div",Qa,[e(y,{size:"24"},{default:t(()=>[e(G(Be))]),_:1})]),a("div",Ha,[a("div",Xa,c(Y.value.publishedPackages),1),l[14]||(l[14]=a("div",{class:"stat-title"},"已发布",-1)),l[15]||(l[15]=a("div",{class:"stat-desc"},"可供下载使用的字体包",-1))])])]),_:1}),e(h,{xs:24,sm:12,md:6,lg:6},{default:t(()=>[a("div",Ya,[a("div",el,[e(y,{size:"24"},{default:t(()=>[e(G(et))]),_:1})]),a("div",tl,[a("div",al,c(Y.value.generatingPackages),1),l[16]||(l[16]=a("div",{class:"stat-title"},"生成中",-1)),l[17]||(l[17]=a("div",{class:"stat-desc"},"AI正在训练生成的字体包",-1))])])]),_:1}),e(h,{xs:24,sm:12,md:6,lg:6},{default:t(()=>[a("div",ll,[a("div",sl,[e(y,{size:"24"},{default:t(()=>[e(W)]),_:1})]),a("div",ol,[a("div",nl,c(Y.value.totalSamples.toLocaleString()),1),l[18]||(l[18]=a("div",{class:"stat-title"},"样本总数",-1)),l[19]||(l[19]=a("div",{class:"stat-desc"},"用于训练的字符样本数量",-1))])])]),_:1})]),_:1})),[[Tt,d.value]]),e(V,{gutter:24,style:{"margin-top":"16px"}},{default:t(()=>[e(h,{xs:24,sm:8,md:8,lg:8},{default:t(()=>[a("div",il,[a("div",rl,[a("div",ul,c(Y.value.averageAccuracy.toFixed(1))+"%",1),l[20]||(l[20]=a("div",{class:"stat-title"},"平均准确率",-1))])])]),_:1}),e(h,{xs:24,sm:8,md:8,lg:8},{default:t(()=>[a("div",dl,[a("div",cl,[a("div",pl,c(Y.value.recentActivity.newPackagesThisWeek),1),l[21]||(l[21]=a("div",{class:"stat-title"},"本周新增",-1))])])]),_:1}),e(h,{xs:24,sm:8,md:8,lg:8},{default:t(()=>[a("div",fl,[a("div",gl,[a("div",vl,c(Y.value.recentActivity.totalDownloadsThisWeek.toLocaleString()),1),l[22]||(l[22]=a("div",{class:"stat-title"},"本周下载",-1))])])]),_:1})]),_:1})]),a("div",ml,[e(Te,null,{header:t(()=>[a("div",_l,[l[23]||(l[23]=a("span",null,"字体包列表",-1)),a("div",hl,[e(Ae,null,{default:t(()=>[e(D,{type:"primary",onClick:fe},{default:t(()=>[e(y,null,{default:t(()=>[e(G(qt))]),_:1}),p(" "+c(oe.value?"智能创建":"快速创建"),1)]),_:1}),e(D,{type:"primary",onClick:l[0]||(l[0]=n=>oe.value=!oe.value),title:oe.value?"切换到传统模式":"切换到智能向导"},{default:t(()=>[oe.value?(f(),R(y,{key:0},{default:t(()=>[e(G(Gt))]),_:1})):(f(),R(y,{key:1},{default:t(()=>[e(G(Oe))]),_:1}))]),_:1},8,["title"])]),_:1})])])]),default:t(()=>[e(G(Lt),{data:ue.value,columns:ze.value,loading:d.value,pagination:ae.value,onPageChange:L,onSizeChange:N},{font_type:t(({row:n})=>[a("div",yl,[e(we,{type:te(n.fontType||n.font_type),size:"small"},{default:t(()=>[p(c(Ce(n.fontType||n.font_type)),1)]),_:2},1032,["type"]),a("div",bl,[a("span",kl," 难度: "+c(Ge(n.difficulty)),1)])])]),status:t(({row:n})=>[a("div",Cl,[a("div",xl,[e(we,{type:x(n.status),effect:n.status==="training"?"light":"dark",size:"small"},{default:t(()=>[n.status==="training"?(f(),R(y,{key:0,class:"is-loading"},{default:t(()=>[e(G(et))]),_:1})):n.status==="published"?(f(),R(y,{key:1},{default:t(()=>[e(G(Be))]),_:1})):n.status==="failed"?(f(),R(y,{key:2},{default:t(()=>[e(G(tt))]),_:1})):n.status==="completed"?(f(),R(y,{key:3},{default:t(()=>[e(G(Wt))]),_:1})):(f(),R(y,{key:4},{default:t(()=>[e(G(Oe))]),_:1})),p(" "+c(xe(n.status)),1)]),_:2},1032,["type","effect"]),n.qualityScore>0?(f(),C("span",wl," 质量: "+c(n.qualityScore)+"分 ",1)):j("",!0)]),n.status==="training"&&n.progress>0?(f(),R(Se,{key:0,percentage:n.progress,"stroke-width":6,"show-text":!0,format:X=>`${X}%`,color:ut(n.progress),class:"progress-bar animated-progress"},null,8,["percentage","format","color"])):n.status==="training"&&n.progress===0?(f(),C("div",Tl,[n.status==="training"?(f(),C("div",$l,[a("span",Vl," 预计剩余: "+c(w(n)),1)])):j("",!0)])):j("",!0)])]),actions:t(({row:n})=>[e(D,{text:"",type:"primary",size:"small",onClick:X=>be(n)},{default:t(()=>l[24]||(l[24]=[p(" 查看详情 ",-1)])),_:2,__:[24]},1032,["onClick"]),e(D,{text:"",type:"primary",size:"small",onClick:X=>ve(n),disabled:n.status==="published"},{default:t(()=>l[25]||(l[25]=[p(" 上传样本 ",-1)])),_:2,__:[25]},1032,["onClick","disabled"]),e(D,{text:"",type:"success",size:"small",onClick:X=>ke(n),disabled:!I.value(n)},{default:t(()=>l[26]||(l[26]=[p(" 开始生成 ",-1)])),_:2,__:[26]},1032,["onClick","disabled"]),e(D,{text:"",type:"warning",size:"small",onClick:X=>Ve(n),disabled:n.status!=="completed"},{default:t(()=>l[27]||(l[27]=[p(" 发布 ",-1)])),_:2,__:[27]},1032,["onClick","disabled"]),e(D,{text:"",type:"danger",size:"small",onClick:X=>Ue(n)},{default:t(()=>l[28]||(l[28]=[p(" 删除 ",-1)])),_:2,__:[28]},1032,["onClick"])]),_:1},8,["data","columns","loading","pagination"])]),_:1})]),e(Je,{modelValue:Z.value,"onUpdate:modelValue":l[4]||(l[4]=n=>Z.value=n),title:`字体包详情 - ${((Qe=v.value)==null?void 0:Qe.name)||""}`,width:"80%","before-close":dt,class:"font-detail-dialog"},{footer:t(()=>{var n;return[a("div",Zl,[e(D,{onClick:l[2]||(l[2]=X=>Z.value=!1)},{default:t(()=>l[36]||(l[36]=[p("关闭",-1)])),_:1,__:[36]}),((n=v.value)==null?void 0:n.status)==="completed"?(f(),R(D,{key:0,type:"primary",onClick:l[3]||(l[3]=X=>Ve(v.value))},{default:t(()=>l[37]||(l[37]=[p(" 发布字体包 ",-1)])),_:1,__:[37]})):j("",!0)])]}),default:t(()=>[v.value?(f(),C("div",Pl,[e(kt,{modelValue:_e.value,"onUpdate:modelValue":l[1]||(l[1]=n=>_e.value=n),type:"border-card"},{default:t(()=>[e(De,{label:"基本信息",name:"basic"},{default:t(()=>[a("div",Sl,[e(V,{gutter:24},{default:t(()=>[e(h,{span:12},{default:t(()=>[a("div",Fl,[l[29]||(l[29]=a("h3",null,"基础信息",-1)),e(Fe,{column:1,border:""},{default:t(()=>[e(z,{label:"字体包名称"},{default:t(()=>[p(c(v.value.name),1)]),_:1}),e(z,{label:"字体类型"},{default:t(()=>[e(we,{type:te(v.value.fontType)},{default:t(()=>[p(c(Ce(v.value.fontType)),1)]),_:1},8,["type"])]),_:1}),e(z,{label:"版本号"},{default:t(()=>[p(c(v.value.version),1)]),_:1}),e(z,{label:"状态"},{default:t(()=>[e(we,{type:x(v.value.status)},{default:t(()=>[p(c(xe(v.value.status)),1)]),_:1},8,["type"])]),_:1}),e(z,{label:"难度等级"},{default:t(()=>[p(c(Ge(v.value.difficulty)),1)]),_:1}),e(z,{label:"质量评分"},{default:t(()=>[e(Ze,{"model-value":v.value.qualityScore/20,disabled:"","show-score":"","text-color":"#ff9900"},null,8,["model-value"]),a("span",Il,c(v.value.qualityScore)+"分",1)]),_:1})]),_:1})])]),_:1}),e(h,{span:12},{default:t(()=>[a("div",Ml,[l[30]||(l[30]=a("h3",null,"生成统计",-1)),e(Fe,{column:1,border:""},{default:t(()=>[e(z,{label:"样本数量"},{default:t(()=>[p(c(v.value.sampleCount)+"个 ",1)]),_:1}),e(z,{label:"生成数量"},{default:t(()=>[p(c(v.value.generatedCount)+"个 ",1)]),_:1}),e(z,{label:"生成进度"},{default:t(()=>[e(Se,{percentage:v.value.progress,"stroke-width":8,"show-text":!0},null,8,["percentage"])]),_:1}),e(z,{label:"准确率"},{default:t(()=>[p(c(v.value.accuracy)+"% ",1)]),_:1}),e(z,{label:"文件大小"},{default:t(()=>[p(c(v.value.fileSize)+"MB ",1)]),_:1}),e(z,{label:"下载次数"},{default:t(()=>[p(c(v.value.downloadCount)+"次 ",1)]),_:1})]),_:1})])]),_:1})]),_:1}),e(V,{gutter:24,style:{"margin-top":"20px"}},{default:t(()=>[e(h,{span:24},{default:t(()=>[a("div",zl,[l[31]||(l[31]=a("h3",null,"描述信息",-1)),a("p",Ul,c(v.value.description),1)])]),_:1})]),_:1}),e(V,{gutter:24,style:{"margin-top":"20px"}},{default:t(()=>[e(h,{span:12},{default:t(()=>[a("div",Al,[l[32]||(l[32]=a("h3",null,"时间信息",-1)),e(Fe,{column:1,border:""},{default:t(()=>[e(z,{label:"创建时间"},{default:t(()=>[p(c(Pe(v.value.createdAt)),1)]),_:1}),e(z,{label:"更新时间"},{default:t(()=>[p(c(Pe(v.value.updatedAt)),1)]),_:1}),e(z,{label:"发布时间"},{default:t(()=>[p(c(v.value.publishedAt?Pe(v.value.publishedAt):"未发布"),1)]),_:1}),e(z,{label:"创建者"},{default:t(()=>[p(c(v.value.createdBy),1)]),_:1})]),_:1})])]),_:1}),e(h,{span:12},{default:t(()=>[a("div",Dl,[l[33]||(l[33]=a("h3",null,"标签",-1)),a("div",Bl,[(f(!0),C(de,null,ce(v.value.tags,n=>(f(),R(we,{key:n,style:{margin:"4px"},type:"info"},{default:t(()=>[p(c(n),1)]),_:2},1024))),128))])])]),_:1})]),_:1})])]),_:1}),e(De,{label:"生成统计",name:"stats"},{default:t(()=>[a("div",El,[e(V,{gutter:24},{default:t(()=>[e(h,{span:12},{default:t(()=>[a("div",Rl,[l[34]||(l[34]=a("h3",null,"生成性能",-1)),e(Fe,{column:1,border:""},{default:t(()=>[e(z,{label:"总生成时间"},{default:t(()=>{var n;return[p(c(rt((n=v.value.generationStats)==null?void 0:n.totalTime)),1)]}),_:1}),e(z,{label:"平均每字符时间"},{default:t(()=>{var n;return[p(c((n=v.value.generationStats)==null?void 0:n.averageTimePerChar)+"秒 ",1)]}),_:1}),e(z,{label:"成功率"},{default:t(()=>{var n;return[p(c((n=v.value.generationStats)==null?void 0:n.successRate)+"% ",1)]}),_:1}),e(z,{label:"重试次数"},{default:t(()=>{var n;return[p(c((n=v.value.generationStats)==null?void 0:n.retryCount)+"次 ",1)]}),_:1})]),_:1})])]),_:1}),e(h,{span:12},{default:t(()=>[a("div",Ol,[l[35]||(l[35]=a("h3",null,"使用统计",-1)),e(Fe,{column:1,border:""},{default:t(()=>[e(z,{label:"活跃设备数"},{default:t(()=>{var n;return[p(c((n=v.value.usageStats)==null?void 0:n.activeDevices)+"台 ",1)]}),_:1}),e(z,{label:"用户评分"},{default:t(()=>{var n;return[e(Ze,{"model-value":(n=v.value.usageStats)==null?void 0:n.userRating,disabled:"","show-score":"","text-color":"#ff9900"},null,8,["model-value"])]}),_:1}),e(z,{label:"反馈数量"},{default:t(()=>{var n;return[p(c((n=v.value.usageStats)==null?void 0:n.feedbackCount)+"条 ",1)]}),_:1}),e(z,{label:"最后使用时间"},{default:t(()=>{var n;return[p(c((n=v.value.usageStats)!=null&&n.lastUsedAt?Pe(v.value.usageStats.lastUsedAt):"未使用"),1)]}),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}),e(De,{label:"字符集",name:"characters"},{default:t(()=>[a("div",Wl,[e(V,{gutter:24},{default:t(()=>[e(h,{span:12},{default:t(()=>{var n;return[a("div",ql,[a("h3",null,"目标字符集 ("+c(((n=v.value.targetCharacters)==null?void 0:n.length)||0)+"个)",1),a("div",Gl,[(f(!0),C(de,null,ce(v.value.targetCharacters,X=>(f(),C("span",{key:X,class:"character-item target"},c(X),1))),128))])])]}),_:1}),e(h,{span:12},{default:t(()=>{var n;return[a("div",Ll,[a("h3",null,"已生成字符集 ("+c(((n=v.value.actualCharacters)==null?void 0:n.length)||0)+"个)",1),a("div",Nl,[(f(!0),C(de,null,ce(v.value.actualCharacters,X=>(f(),C("span",{key:X,class:"character-item generated"},c(X),1))),128))])])]}),_:1})]),_:1})])]),_:1}),e(De,{label:"维护信息",name:"maintenance"},{default:t(()=>[a("div",jl,[e(Fe,{column:2,border:""},{default:t(()=>[e(z,{label:"最后更新时间"},{default:t(()=>{var n;return[p(c(Pe((n=v.value.maintenance)==null?void 0:n.lastUpdated)),1)]}),_:1}),e(z,{label:"下次审核时间"},{default:t(()=>{var n;return[p(c(Pe((n=v.value.maintenance)==null?void 0:n.nextReview)),1)]}),_:1}),e(z,{label:"维护者"},{default:t(()=>{var n;return[p(c((n=v.value.maintenance)==null?void 0:n.maintainer),1)]}),_:1}),e(z,{label:"维护备注",span:2},{default:t(()=>{var n;return[p(c((n=v.value.maintenance)==null?void 0:n.notes),1)]}),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])])):j("",!0)]),_:1},8,["modelValue","title"]),e(na,{modelValue:ie.value,"onUpdate:modelValue":l[5]||(l[5]=n=>ie.value=n),onSuccess:le},null,8,["modelValue"]),Q.value?(f(),C("div",{key:0,class:"wizard-overlay",onClick:l[8]||(l[8]=Bt(n=>Q.value=!1,["self"]))},[a("div",Jl,[a("div",Kl,[l[38]||(l[38]=a("h2",null,"创建字体包 - 智能向导",-1)),e(D,{type:"danger",onClick:l[6]||(l[6]=n=>Q.value=!1),circle:""},{default:t(()=>[e(y,null,{default:t(()=>[e(G(tt))]),_:1})]),_:1})]),a("div",Ql,[e(qa,{modelValue:Q.value,"onUpdate:modelValue":l[7]||(l[7]=n=>Q.value=n),onComplete:ee,onCancel:he,onSaveDraft:ge},null,8,["modelValue"])])])])):j("",!0),e(Je,{modelValue:re.value,"onUpdate:modelValue":l[11]||(l[11]=n=>re.value=n),title:`上传样本 - ${((He=pe.value)==null?void 0:He.name)||""}`,width:"70%","before-close":ct,class:"upload-dialog"},{footer:t(()=>[a("div",ss,[e(D,{onClick:l[10]||(l[10]=n=>re.value=!1),disabled:H.value},{default:t(()=>l[44]||(l[44]=[p(" 取消 ",-1)])),_:1,__:[44]},8,["disabled"]),e(D,{onClick:ht,disabled:H.value||q.value.length===0},{default:t(()=>l[45]||(l[45]=[p(" 清空列表 ",-1)])),_:1,__:[45]},8,["disabled"]),e(D,{type:"primary",onClick:yt,loading:H.value,disabled:q.value.length===0},{default:t(()=>[p(c(H.value?"上传中...":"开始上传"),1)]),_:1},8,["loading","disabled"])])]),default:t(()=>[pe.value?(f(),C("div",Hl,[e(Ct,{title:"上传说明",type:"info",closable:!1,"show-icon":"",class:"upload-tips"},{default:t(()=>l[39]||(l[39]=[a("ul",null,[a("li",null,"支持的文件格式：PNG, JPG, JPEG"),a("li",null,"单个文件大小不超过 5MB"),a("li",null,"建议图片尺寸：256x256 像素"),a("li",null,"文件名应包含对应的汉字，如：一.png, 二.jpg"),a("li",null,"支持批量上传，最多一次上传 100 个文件")],-1)])),_:1}),a("div",Xl,[e(xt,{ref:"uploadRef","file-list":q.value,"onUpdate:fileList":l[9]||(l[9]=n=>q.value=n),"auto-upload":!1,multiple:!0,limit:100,accept:".png,.jpg,.jpeg","before-upload":pt,"on-exceed":ft,"on-remove":gt,drag:"",class:"upload-dragger"},{tip:t(()=>l[40]||(l[40]=[a("div",{class:"el-upload__tip"}," 支持 PNG/JPG/JPEG 格式，单个文件不超过 5MB ",-1)])),default:t(()=>[e(y,{class:"el-icon--upload"},{default:t(()=>[e(G(nt))]),_:1}),l[41]||(l[41]=a("div",{class:"el-upload__text"},[p(" 将文件拖到此处，或"),a("em",null,"点击上传")],-1))]),_:1,__:[41]},8,["file-list"])]),H.value?(f(),C("div",Yl,[l[42]||(l[42]=a("h4",null,"上传进度",-1)),e(Se,{percentage:A.value.percentage,"stroke-width":8,"show-text":!0,format:n=>`${A.value.completed}/${A.value.total} (${n}%)`},null,8,["percentage","format"]),a("div",es,[a("p",null,"当前处理："+c(A.value.current),1),a("p",null,"已完成："+c(A.value.completed)+"个",1),a("p",null,"失败："+c(A.value.failed)+"个",1)])])):j("",!0),A.value.errors.length>0?(f(),C("div",ts,[l[43]||(l[43]=a("h4",null,"上传失败的文件",-1)),e(Ke,{data:A.value.errors,size:"small","max-height":"200"},{default:t(()=>[e($e,{prop:"filename",label:"文件名"}),e($e,{prop:"error",label:"错误信息"})]),_:1},8,["data"])])):j("",!0),q.value.length>0?(f(),C("div",as,[a("h4",null,"待上传文件列表 ("+c(q.value.length)+"个)",1),e(Ke,{data:q.value,size:"small","max-height":"300"},{default:t(()=>[e($e,{label:"预览",width:"80"},{default:t(({row:n})=>[e(wt,{src:Ne(n),"preview-src-list":[Ne(n)],fit:"cover",style:{width:"40px",height:"40px","border-radius":"4px"}},null,8,["src","preview-src-list"])]),_:1}),e($e,{prop:"name",label:"文件名"}),e($e,{label:"大小",width:"100"},{default:t(({row:n})=>[p(c(vt(n.size)),1)]),_:1}),e($e,{label:"识别字符",width:"100"},{default:t(({row:n})=>[a("span",ls,c(je(n.name)),1)]),_:1}),e($e,{label:"状态",width:"100"},{default:t(({row:n})=>[e(we,{type:mt(n),size:"small"},{default:t(()=>[p(c(_t(n)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])):j("",!0)])):j("",!0)]),_:1},8,["modelValue","title"])])}}}),_s=qe(os,[["__scopeId","data-v-98e9ee38"]]);export{_s as default};
