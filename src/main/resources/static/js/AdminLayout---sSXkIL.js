var ie=Object.defineProperty;var re=(p,n,e)=>n in p?ie(p,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[n]=e;var O=(p,n,e)=>re(p,typeof n!="symbol"?n+"":n,e);var z=(p,n,e)=>new Promise((c,y)=>{var h=l=>{try{P(e.next(l))}catch(S){y(S)}},C=l=>{try{P(e.throw(l))}catch(S){y(S)}},P=l=>l.done?c(l.value):Promise.resolve(l.value).then(h,C);P((e=e.apply(p,n)).next())});import{x as ce,aA as le,az as de,r as N,c as B,h as ue,al as m,y as w,z as u,A as s,Q as a,I as i,u as I,P as U,a6 as $,D as M,O as _,H as f,K as Q,M as A,J as me,L as V,R as pe}from"./vue-C2NPAEWw.js";import{d as L,s as j,u as q,m as D,c as x,t as F,f as H,g as he,b as J,e as _e,h as ge,j as fe,k as K,n as ve}from"./element-plus-BHn0tN3r.js";import{a as b}from"./authService-CnSN0M4T.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";class ye{constructor(){O(this,"PERMISSIONS",[{code:"dashboard:view",name:"查看数据看板",description:"查看系统数据看板和统计信息",category:"dashboard"},{code:"content:view",name:"查看内容",description:"查看内容管理相关页面",category:"content"},{code:"content:manage",name:"管理内容",description:"管理产品、公益项目、平台链接等内容",category:"content"},{code:"content:product:manage",name:"管理产品",description:"管理产品信息和媒体文件",category:"content"},{code:"content:charity:manage",name:"管理公益项目",description:"管理公益项目数据和内容",category:"content"},{code:"content:platform:manage",name:"管理平台链接",description:"管理电商和租赁平台链接",category:"content"},{code:"business:view",name:"查看业务数据",description:"查看销售、租赁、客户等业务数据",category:"business"},{code:"business:manage",name:"管理业务数据",description:"管理销售、租赁、客户等业务数据",category:"business"},{code:"business:sales:manage",name:"管理销售数据",description:"管理销售订单和数据分析",category:"business"},{code:"business:rental:manage",name:"管理租赁数据",description:"管理租赁订单和数据分析",category:"business"},{code:"business:customer:manage",name:"管理客户数据",description:"管理客户信息和设备关联",category:"business"},{code:"business:order:manage",name:"管理订单数据",description:"管理销售和租赁订单信息",category:"business"},{code:"system:view",name:"查看系统设置",description:"查看系统管理相关页面",category:"system"},{code:"system:manage",name:"管理系统设置",description:"管理系统配置和设置",category:"system"},{code:"system:course:manage",name:"管理课程",description:"管理课程内容和字库资源",category:"system"},{code:"system:font:manage",name:"管理字体包",description:"管理AI字体包生成和分发",category:"system"},{code:"admin:all",name:"超级管理员",description:"拥有系统所有权限",category:"admin"}]);O(this,"MENU_PERMISSIONS",[{path:"/admin/dashboard",permissions:["dashboard:view","admin:all"]},{path:"/admin/content/products",permissions:["content:product:manage","content:manage","admin:all"]},{path:"/admin/content/charity",permissions:["content:charity:manage","content:manage","admin:all"]},{path:"/admin/content/platforms",permissions:["content:platform:manage","content:manage","admin:all"]},{path:"/admin/business/sales",permissions:["business:sales:manage","business:manage","admin:all"]},{path:"/admin/business/rental-analytics",permissions:["business:rental:manage","business:manage","admin:all"]},{path:"/admin/business/customers",permissions:["business:customer:manage","business:manage","admin:all"]},{path:"/admin/business/orders",permissions:["business:order:manage","business:manage","admin:all"]},{path:"/admin/system/courses",permissions:["system:course:manage","system:manage","admin:all"]},{path:"/admin/system/fonts",permissions:["system:font:manage","system:manage","admin:all"]}])}hasPermission(n){return b.hasPermission(n)}hasAnyPermission(n){return n.some(e=>this.hasPermission(e))}hasAllPermissions(n){return n.every(e=>this.hasPermission(e))}canAccessPath(n){const e=this.MENU_PERMISSIONS.find(c=>c.path===n);return e?this.hasAnyPermission(e.permissions):!0}getAccessibleMenuItems(n){return n.filter(e=>e.path&&!this.canAccessPath(e.path)?!1:e.children?(e.children=e.children.filter(c=>this.canAccessPath(c.path)),e.children.length>0):!0)}getAllPermissions(){return[...this.PERMISSIONS]}getPermissionsByCategory(n){return this.PERMISSIONS.filter(e=>e.category===n)}getCurrentUserPermissions(){const n=b.getCurrentUser();return(n==null?void 0:n.permissions)||[]}isSuperAdmin(){return this.hasPermission("admin:all")}getPermissionDescription(n){const e=this.PERMISSIONS.find(c=>c.code===n);return(e==null?void 0:e.description)||"未知权限"}isValidPermission(n){return this.PERMISSIONS.some(e=>e.code===n)}getMenuPermissionRequirements(n){const e=this.MENU_PERMISSIONS.find(c=>c.path===n);return(e==null?void 0:e.permissions)||[]}}const Pe=new ye,Se={class:"admin-layout"},we={class:"sidebar-header"},Ie={class:"logo"},Me={class:"logo-icon"},Ae={class:"sidebar-menu"},ke={key:0,class:"menu-group"},Ne=["onClick"],xe={class:"menu-icon"},Ce={class:"submenu"},Ee={class:"menu-icon"},Re={class:"menu-icon"},Oe={class:"main-content"},Be={class:"header"},Ue={class:"header-left"},Ve={class:"breadcrumb-section"},Le={class:"header-title"},De={class:"header-actions"},Te={class:"user-avatar"},ze={class:"user-info"},$e={class:"user-name"},Qe={class:"user-role"},je={class:"page-content"},qe=ce({__name:"AdminLayout",setup(p){const n=le(),e=de(),c=N(!1),y=N(""),h=N([]),C=o=>{const t=h.value.indexOf(o);t>-1?h.value.splice(t,1):h.value.push(o)},P=o=>o.children?o.children.some(t=>n.path===t.path):!1,l=[{path:"/admin/dashboard",title:"数据看板",icon:L,category:"main"},{path:"/admin/content",title:"官网管理",icon:x,category:"main",children:[{path:"/admin/content/products",title:"产品管理",icon:j},{path:"/admin/content/charity",title:"公益项目管理",icon:q},{path:"/admin/content/platforms",title:"平台链接管理",icon:D},{path:"/admin/content/news",title:"新闻管理",icon:x}]},{path:"/admin/business",title:"业务管理",icon:j,category:"main",children:[{path:"/admin/business/sales",title:"销售数据",icon:L},{path:"/admin/business/rental-analytics",title:"租赁数据分析",icon:D},{path:"/admin/business/customers",title:"客户管理",icon:q},{path:"/admin/business/orders",title:"订单管理",icon:x}]},{path:"/admin/device",title:"设备管理",icon:D,category:"main",children:[{path:"/admin/device/management",title:"设备管理",icon:F},{path:"/admin/device/monitoring",title:"设备监控",icon:L},{path:"/admin/device/firmware",title:"固件管理",icon:H}]},{path:"/admin/system",title:"课程管理",icon:F,category:"main",children:[{path:"/admin/system/courses",title:"课程管理",icon:x},{path:"/admin/system/fonts",title:"AI字体包管理",icon:H},{path:"/admin/system/languages",title:"多语言管理",icon:he}]}],S=B(()=>Pe.getAccessibleMenuItems(l)),G=B(()=>{for(const t of l)if(t.children){const d=t.children.find(g=>g.path===n.path);if(d)return d.title}const o=l.find(t=>t.path===n.path);return(o==null?void 0:o.title)||"控制面板"}),k=B(()=>{for(const t of l)if(t.children){const d=t.children.find(g=>g.path===n.path);if(d)return{parent:t.title,current:d.title}}const o=l.find(t=>t.path===n.path);return o?{parent:null,current:o.title}:{parent:null,current:null}}),W=()=>{c.value=!c.value},E=N(b.getCurrentUser()||{name:"管理员",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",role:"系统管理员"}),X=o=>{switch(o){case"profile":console.log("打开个人设置");break;case"account":console.log("打开账户管理");break;case"logout":Y();break}},Y=()=>z(null,null,function*(){try{yield ve.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),b.logout(),J.success("已退出登录"),e.push("/admin/login")}catch(o){}});return ue(()=>{b.refreshLastActiveTime(),b.isAuthenticated()||(J.warning("登录状态已过期，请重新登录"),e.push("/admin/login"))}),(o,t)=>{const d=m("el-icon"),g=m("router-link"),Z=m("el-button"),R=m("el-breadcrumb-item"),ee=m("el-breadcrumb"),ne=m("el-input"),se=m("el-avatar"),T=m("el-dropdown-item"),te=m("el-dropdown-menu"),ae=m("el-dropdown"),oe=m("router-view");return u(),w("div",Se,[s("div",{class:M(["sidebar",{"mobile-open":c.value}])},[s("div",we,[s("div",Ie,[s("div",Me,[a(d,null,{default:i(()=>[a(I(_e))]),_:1})]),t[1]||(t[1]=s("span",null,"练字机器人",-1))])]),s("div",Ae,[(u(!0),w(U,null,$(S.value,r=>(u(),w(U,{key:r.path},[r.children?(u(),w("div",ke,[s("div",{class:M(["menu-item parent-item",{active:P(r),expanded:h.value.includes(r.path)}]),onClick:v=>C(r.path)},[s("div",xe,[a(d,null,{default:i(()=>[(u(),f(V(r.icon)))]),_:2},1024)]),s("span",null,_(r.title),1),a(d,{class:M(["expand-icon",{rotated:h.value.includes(r.path)}])},{default:i(()=>[a(I(K))]),_:2},1032,["class"])],10,Ne),me(s("div",Ce,[(u(!0),w(U,null,$(r.children,v=>(u(),f(g,{key:v.path,to:v.path,class:M(["menu-item submenu-item",{active:o.$route.path===v.path}])},{default:i(()=>[s("div",Ee,[a(d,null,{default:i(()=>[(u(),f(V(v.icon)))]),_:2},1024)]),s("span",null,_(v.title),1)]),_:2},1032,["to","class"]))),128))],512),[[pe,h.value.includes(r.path)]])])):(u(),f(g,{key:1,to:r.path,class:M(["menu-item",{active:o.$route.path===r.path}])},{default:i(()=>[s("div",Re,[a(d,null,{default:i(()=>[(u(),f(V(r.icon)))]),_:2},1024)]),s("span",null,_(r.title),1)]),_:2},1032,["to","class"]))],64))),128))]),t[2]||(t[2]=s("div",{class:"sidebar-footer"},[s("div",{class:"upgrade-card gradient-card"},[s("h4",null,"练字机器人Pro"),s("p",null,"让每个人写好汉字。")])],-1))],2),s("div",Oe,[s("div",Be,[s("div",Ue,[a(Z,{class:"mobile-menu-btn",onClick:W,icon:I(ge),circle:""},null,8,["icon"]),s("div",Ve,[s("h1",Le,_(G.value),1),a(ee,{separator:"/",class:"page-breadcrumb"},{default:i(()=>[a(R,null,{default:i(()=>[a(g,{to:"/admin/dashboard"},{default:i(()=>t[3]||(t[3]=[A("控制台",-1)])),_:1,__:[3]})]),_:1}),k.value.parent?(u(),f(R,{key:0},{default:i(()=>[A(_(k.value.parent),1)]),_:1})):Q("",!0),k.value.current?(u(),f(R,{key:1},{default:i(()=>[A(_(k.value.current),1)]),_:1})):Q("",!0)]),_:1})])]),s("div",De,[a(ne,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=r=>y.value=r),placeholder:"全局搜索",class:"search-input","prefix-icon":I(fe),clearable:""},null,8,["modelValue","prefix-icon"]),a(ae,{onCommand:X},{dropdown:i(()=>[a(te,null,{default:i(()=>[a(T,{command:"account"},{default:i(()=>t[4]||(t[4]=[A("账户管理",-1)])),_:1,__:[4]}),a(T,{command:"logout",divided:""},{default:i(()=>t[5]||(t[5]=[A("退出登录",-1)])),_:1,__:[5]})]),_:1})]),default:i(()=>[s("div",Te,[a(se,{src:E.value.avatar,size:"small"},null,8,["src"]),s("div",ze,[s("span",$e,_(E.value.name),1),s("span",Qe,_(E.value.role),1)]),a(d,null,{default:i(()=>[a(I(K))]),_:1})])]),_:1})])]),s("div",je,[a(oe)])])])}}}),We=be(qe,[["__scopeId","data-v-a09dce3a"]]);export{We as default};
